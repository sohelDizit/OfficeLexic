/*
    Copyright (c) Ascensio System SIA 2022. All rights reserved.
    http://www.onlyoffice.com
*/
var Authorize=new function(){jq(document).ready(function(){jq("#recaptchaHiddenContainer").is(":visible")&&RecaptchaController.InitRecaptcha(jq("#recaptchaHiddenContainer").attr("data-hl"));jq(jq("#login").val().length?"#pwd":"#login").trigger("focus");jq("#login,#pwd").on("keyup",function(n){var i,t;if(t||(t=n),t.keyCode?i=t.keyCode:t.which&&(i=t.which),i==13){if(jq(this).is("#login")&&!jq("#pwd").val().length)return jq("#pwd").trigger("focus"),!0;if(jq("body").hasClass("desktop")&&!!jq("#desktop_agree_to_terms").length&&!jq("#desktop_agree_to_terms").is(":checked"))return!0;Authorize.Submit()}else i==27&&jq(this).val("");return!0});try{var n=ASC.Controls.AnchorController.getAnchor();n.trim()=="passrecovery"&&PasswordTool.ShowPwdReminderDialog()}catch(t){}});this.Submit=function(){var t,i;jq("#authMessage").hide();jq(".pwdLoginTextbox").removeClass("error");t=jq("#ldapPassword");t.length&&t.prop("checked")==!0?(i=jq("#pwd").val(),jq("#passwordHash").val(i),window.submitForm()):n()};this.SubmitDocs=function(){n()};var n=function(){var n=jq("#pwd").val();window.hashPassword(n,function(n){jq("#passwordHash").val(n);window.submitForm()})}};
var PasswordTool=new function(){this.ShowPwdReminderDialog=function(n,t){n==1?(jq("#pswdRecoveryDialogPopupHeader").hide(),jq("#pswdRecoveryDialogText").hide(),jq("#pswdChangeDialogPopupHeader").show(),jq("#pswdChangeDialogText").show(),jq("#studio_emailPwdReminder").val(t),jq("#studio_pwdReminderDialog [name='userEmail']").attr("href","../../addons/mail/#composeto/email="+t).html(t)):(jq("#pswdRecoveryDialogPopupHeader").show(),jq("#pswdRecoveryDialogText").show(),jq("#pswdChangeDialogPopupHeader").hide(),jq("#pswdChangeDialogText").hide());jq("#"+jq("#studio_pwdReminderInfoID").val()).html("<div><\/div>");jq("#"+jq("#studio_pwdReminderInfoID").val()).hide();StudioBlockUIManager.blockUI("#studio_pwdReminderDialog",350);PopupKeyUpActionProvider.EnterAction="PasswordTool.RemindPwd();";var i=jq("#login").val();i!=null&&i!=undefined&&jq.isValidEmail(i)&&jq("#studio_emailPwdReminder").val(i)};this.RemindPwd=function(){Teamlab.remindPwd({},jq("#studio_emailPwdReminder").val().trim(),{before:function(){LoadingBanner.showLoaderBtn("#studio_pwdReminderDialog")},after:function(){LoadingBanner.hideLoaderBtn("#studio_pwdReminderDialog")},success:function(n,t){jq.unblockUI();typeof onSuccessRemindPwd=="function"&&onSuccessRemindPwd();toastr.success(t)},error:function(n,t){toastr.error(t[0])}});PopupKeyUpActionProvider.ClearActions()}};
var AuthCommunications=new function(){var l=!1,a=!1,h=jq("#GreetingBlock .help-block-signin .signUpBlock .mess"),n=jq("#studio_admMessDialog"),t=jq("#studio_admMessContent"),i=jq("#studio_yourEmail"),r=jq("#studio_yourSituation"),u=t.find(".middle-button-container .button"),c=jq("#GreetingBlock .help-block-signin .signUpBlock .join"),f=jq("#studio_invJoinDialog"),e=jq("#studio_invJoinContent"),o=jq("#studio_joinEmail"),s=e.find(".middle-button-container .button");this.ShowAdminMessageDialog=function(){function t(){function n(){var n=!0;r.val().trim()||(n=!1);jq.isValidEmail(i.val())||(n=!1);n?u.removeClass("disable"):u.addClass("disable")}r.on("input",n);i.on("input",n);l=!0}if(l||t(),n.is(":visible")){this.SendAdmMail1stState();return}c.removeClass("opened");f.hide();h.addClass("opened");n.show();r.val("");i.val("");u.addClass("disable")};this.SendAdminMessage=function(){u.hasClass("disable")||(AjaxPro.onLoading=function(n){n?LoadingBanner.showLoaderBtn(t):LoadingBanner.hideLoaderBtn(t)},window.AuthCommunicationsController.SendAdmMail(i.val().trim(),r.val().trim(),function(n){var i=n.value;LoadingBanner.showMesInfoBtn(t,i.Message,i.Status==1?"success":"error")}))};this.SendAdmMail1stState=function(){h.removeClass("opened");n.hide()};this.ShowInviteJoinDialog=function(){function t(){function n(){jq.isValidEmail(o.val())?s.removeClass("disable"):s.addClass("disable")}o.on("input",n);a=!0}if(a||t(),f.is(":visible")){this.ShowInviteJoin1stState();return}h.removeClass("opened");n.hide();c.addClass("opened");f.show();o.val("");s.addClass("disable")};this.SendInviteJoinMail=function(){s.hasClass("disable")||(AjaxPro.onLoading=function(n){n?LoadingBanner.showLoaderBtn(e):LoadingBanner.hideLoaderBtn(e)},window.AuthCommunicationsController.SendJoinInviteMail(o.val().trim(),function(n){var t=n.value;LoadingBanner.showMesInfoBtn(e,t.Message,t.Status==1?"success":"error")}))};this.ShowInviteJoin1stState=function(){c.removeClass("opened");f.hide()}};

