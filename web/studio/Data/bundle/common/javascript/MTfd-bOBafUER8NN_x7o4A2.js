jQuery.template("userProfileCardTmpl",'<div class="UserInfoBlock"><table cellspacing="0" cellpadding="0" style="width:100%;"><tr valign="top"><td style="width:90px;"><img alt="" class="userPhoto" src="${avatar}" /><\/td><td style="padding-left:10px;"><div><a class="link medium bold underline" href="${StudioManager.getLocationPathToModule("People")+"Profile.aspx?user=" + encodeURIComponent(userName)}"                       {{if (blank)}}target="_blank"{{/if}}>${displayName}<\/a><\/div>{{if (groups && groups.length)}}<div style="margin-top:0px;"><a class="link underline gray" href="${StudioManager.getLocationPathToModule("People")+"#group="+groups[0].id}"                           {{if (blank)}}target="_blank"{{/if}}>${groups[0].name}<\/a><\/div>{{/if}}<div style="margin-top:10px;">${title}<\/div><div style="margin-top:2px;"><span class="link underline gray" onclick="ASC.Controls.JabberClient.open(\'${userName}\')">${ASC.Resources.Master.ResourceJS.OpenTalk}<\/span><\/div><\/td><\/tr><\/table><\/div>');jQuery.template("tfaCodesPopup",'{{tmpl \'tfaCodesContentTmpl\'}}<div id="errorRequestNewCodes" class="errorBox display-none"><\/div><div class="middle-button-container"><a id="showBackupCodesPrint" class="button middle blue">${ASC.Resources.Master.TemplateResource.PrintButton}<\/a><span class="splitter-buttons"><\/span><a id="showBackupCodeRequestNew" class="button middle gray">${ASC.Resources.Master.TemplateResource.RequestNewButton}<\/a><span class="splitter-buttons"><\/span><a id="showBackupCodesClose" class="button middle gray">${ASC.Resources.Master.ResourceJS.CloseButton}<\/a><\/div>');jQuery.template("tfaCodesContentTmpl","<div>{{html jq.format(ASC.Resources.Master.TemplateResource.TfaAppShowBackupCodesDescription, '<br><br>', jq.format('<b class=\"codesremain\">{0}<\/b>', unused))}}<div id=\"showBackupCodes\" class=\"bold\">{{tmpl(items) 'tfaCodesTmpl'}}<\/div>${ASC.Resources.Master.TemplateResource.TfaAppShowBackupCodesNote}<\/div>");jQuery.template("tfaCodesTmpl",'<div {{if isUsed}} class="disabled" {{/if}}>${code}<\/div>');
jQuery.template("templateCheckingEmail",'<span style="color:${color}">${text}<\/span>');
jQuery.template("template-filter-combobox-options",'<option class="${classname}" value="${value}"{{if typeof def === "boolean" && def === true}} selected="selected"{{/if}}>${title}<\/option>');jQuery.template("template-filter-filtervalues",'<div class="advansed-item-list advansed-filter-list"><ul class="item-list filter-list"><\/ul><\/div>');jQuery.template("template-filter-sortervalues",'<div class="advansed-item-list advansed-sorter-list"><ul class="item-list sorter-list"><\/ul><\/div>');jQuery.template("template-filter-container",'<div class="advansed-filter empty-filter-list"><div class="advansed-filter-wrapper"><div class="advansed-filter-support"><label class="advansed-filter-label">${ASC.Resources.Master.UserControlsCommonResource.LblFilter}<\/label><label class="advansed-filter-hint"><\/label><div class="advansed-filter-hint-popup-helper"><div class="advansed-filter-hint-popup popup_helper"><\/div><\/div><\/div><label class="advansed-filter-state btn-start-filter" title="${ASC.Resources.Master.ResourceJS.StartFilter}"><\/label><div class="advansed-filter-sort-container"><span class="btn-toggle-sorter" title="${ASC.Resources.Master.ResourceJS.AscOrDesc}"><\/span><span class="title">${ASC.Resources.Master.UserControlsCommonResource.LblSort}:&nbsp;<span class="value"><\/span><\/span><\/div><div class="advansed-item-list advansed-sorter-list"><ul class="item-list sorter-list"><\/ul><\/div><div class="advansed-item-list advansed-filter-list"><ul class="item-list filter-list"><\/ul><\/div><div class="advansed-filter-control advansed-filter-groupselector"><div class="advansed-filter-control-container advansed-filter-groupselector-container"><\/div><\/div><div class="advansed-filter-control advansed-filter-userselector"><div class="advansed-filter-control-container advansed-filter-userselector-container"><\/div><\/div><div class="advansed-filter-container"><div class="advansed-filter-filters empty-list"><div class="btn-show-hidden-filters">${ASC.Resources.Master.UserControlsCommonResource.BtnHiddenFilter}<\/div><div class="hidden-filters-container"><\/div><\/div><div class="advansed-filter-button btn-show-filters"><div class="inner-text"><span class="text" title="${ASC.Resources.Master.ResourceJS.AddFilter}">+<\/span><\/div><\/div><div class="advansed-filter-input"><label class="advansed-filter-reset btn-reset-filter">&times;<\/label><input class="advansed-filter advansed-filter-input advansed-filter-complete" type="text" placeholder="${ASC.Resources.Master.UserControlsCommonResource.LblFilterPlaceholder}" maxlength="255"/><\/div><\/div>{{if filtervalues.length > 0}}            {{tmpl "template-filter-filtervalues"}}        {{/if}}        {{if sortervalues.length > 0}}            {{tmpl "template-filter-sortervalues"}}        {{/if}}<\/div><div class="advansed-filter-helper"><\/div><\/div>');jQuery.template("template-filter-item",'<div class="default-value"><span class="title">{{if filtertitle}}${filtertitle}{{else}}${title}{{/if}}<\/span><span class="selector-wrapper"><span class="daterange-selector from-daterange-selector"><span class="label">${ASC.Resources.Master.UserControlsCommonResource.LblFrom}<\/span><span class="advansed-filter-dateselector-date dateselector-from-date"><span class="btn-show-datepicker btn-show-datepicker-container"><span class="btn-show-datepicker btn-show-datepicker-title"><\/span><\/span><span class="advansed-filter-datepicker-container asc-datepicker"><span class="datepicker-container"><\/span><\/span><\/span><\/span><span class="daterange-selector to-daterange-selector"><span class="label">${ASC.Resources.Master.UserControlsCommonResource.LblTo}<\/span><span class="advansed-filter-dateselector-date dateselector-to-date"><span class="btn-show-datepicker btn-show-datepicker-container"><span class="btn-show-datepicker btn-show-datepicker-title"><\/span><\/span><span class="advansed-filter-datepicker-container asc-datepicker"><span class="datepicker-container"><\/span><\/span><\/span><\/span>{{if options}}<span class="combobox-selector"><select class="advansed-filter-combobox"{{if $data.multiple === true}} multiple="multiple"{{/if}}>{{tmpl(options) "template-filter-combobox-options"}}<\/select><\/span>{{/if}}<span class="group-selector"><span class="custom-value"><span class="inner-text"><span class="value"><\/span><\/span><\/span><span class="default-value"><span class="inner-text"><span class="value">${ASC.Resources.Master.UserControlsCommonResource.LblSelect}<\/span><\/span><\/span><\/span><span class="person-selector"><span class="custom-value"><span class="inner-text"><span class="value"><\/span><\/span><\/span><span class="default-value"><span class="inner-text"><span class="value">${ASC.Resources.Master.UserControlsCommonResource.LblSelect}<\/span><\/span><\/span><\/span><\/span><span class="btn-delete">&times;<\/span><\/div>');
jQuery.template("feed-inner-comment-tmpl",'<div class="comment"><a href="${author.profileUrl}" target="_blank"><img class="comment-avatar" src="${author.avatarBig}"/><\/a><div class="comment-content-box"><div class="comment-author"><a href="${author.profileUrl}" class="title" target="_blank">${author.displayName}<\/a>,                {{if author.title}}<span>${author.title},<\/span>{{/if}}<span>${formattedDate}<\/span><\/div><div class="comment-body">{{html description}}<\/div><div class="reply-comment-btn" data-commentid="${id}">${ASC.Resources.Master.FeedResource.ReplyCommentBtn}<\/div><\/div><\/div>');jQuery.template("feedTmpl",'<div id="feed_${id}" class="item clearFix"><div class="avatar">{{if !isGuest}}<a href="${author.profileUrl}" target="_blank"><img src="${author.avatarBig}"/><\/a>{{else}}<img src="${ASC.Resources.Master.UserDefaultBigPhotoURL}"/>{{/if}}<\/div><div class="content-box"><div class="feed-item"><div class="header"><span class="action">${actionText}<\/span><a href="${itemUrl}" class="title" target="_blank"                       data-extra="${additionalInfo}" data-hintName="${hintName}"                       data-extra2="${additionalInfo2}" data-hintName2="${hintName2}"                       data-extra3="${additionalInfo3}" data-hintName3="${hintName3}"                       data-extra4="${additionalInfo4}" data-hintName4="${hintName4}">${title}<\/a>{{if groupedFeeds.length}}<span class="grouped-feeds-count">${ASC.Resources.Master.FeedResource.OtherFeedsCountMsg.format(groupedFeeds.length)}<\/span>{{/if}}{{if isNew}}<span class="new-indicator" title="${ASC.Resources.Master.FeedResource.NewFeedIndicator}">${ASC.Resources.Master.FeedResource.NewFeedIndicator}<\/span>{{/if}}<\/div><div class="description"><span class="menu-item-icon ${itemClass}"><svg class="menu-item-svg"><use href="/skins/default/images/svg/feed-icons.svg#feedIcons${itemClass}"><\/use><\/svg><\/span><span class="product">${productText}.<\/span>{{if location}}<span class="location">${location}.<\/span>{{/if}}{{if extraLocation}}<span class="extra-location"><a href="${extraLocationUrl}" class="title" title="${extraLocation}" target="_blank">${extraLocation}<\/a>.<\/span>{{/if}}<\/div><div class="date">{{if isTomorrow}}<span>${tomorrow} ${displayCreatedTime}<\/span>{{else isToday}}<span>${today} ${displayCreatedTime}<\/span>{{else isYesterday}}<span>${yesterday} ${displayCreatedTime}<\/span>{{else}}<span>${displayCreatedDate}<\/span>{{if displayCreatedTime}}<span class="time">${displayCreatedTime}<\/span>{{/if}}                    {{/if}}<\/div>{{if isAllDayEvent}}<div><span class="baseLinkAction" onclick="${linkOnClickAttr}">${linkInnerText}<\/span><\/div>{{else author && !excludeAuthorBox}}<div class="author"><span class="label">${ASC.Resources.Master.FeedResource.Author}:<\/span>{{if !isGuest}}<a href="${author.profileUrl}" class="title" target="_blank">${author.displayName}<\/a>{{if author.title}},<span class="author-title">${author.title}<\/span>{{/if}}                    {{/if}}<\/div>{{else isGuest}}<div class="author"><span class="label">${ASC.Resources.Master.FeedResource.Author}:<\/span><span class="author-title">${ASC.Resources.Master.FeedResource.Anonymous}<\/span><\/div>{{/if}}<div class="body">{{html description}}                    {{if hasPreview}}<div class="show-all-btn control-btn">${ASC.Resources.Master.FeedResource.ShowAll}<\/div>{{/if}}<\/div>{{if groupedFeeds.length}}<div class="control-btn show-grouped-feeds-btn">${ASC.Resources.Master.FeedResource.ShowGroupedFeedsBtn}<\/div><div class="control-btn hide-grouped-feeds-btn">${ASC.Resources.Master.FeedResource.HideGroupedFeedsBtn}<\/div><div class="grouped-feeds-box">{{each groupedFeeds}}<div><a href="${ItemUrl}" class="title" target="_blank"                           data-extra="${AdditionalInfo}" data-hintName="${hintName}"                           data-extra2="${AdditionalInfo2}" data-hintName2="${hintName2}"                           data-extra3="${AdditionalInfo3}" data-hintName3="${hintName3}"                           data-extra4="${AdditionalInfo4}" data-hintName4="${hintName4}">${Title}<\/a><\/div>{{/each}}<\/div>{{/if}}                {{if canComment}}<div id="write-comment-btn-${id}" class="control-btn write-comment-btn">${ASC.Resources.Master.FeedResource.WriteComment}<\/div>{{if comments && comments.length}}<div style="margin-top: 5px;"><\/div>{{/if}}<\/div><div class="comments-box">{{if comments && comments.length > 3}}<div class="comments-show-panel"><span class="control-btn" data-show-text="${ASC.Resources.Master.FeedResource.ShowOthersCommentsBtn}" data-hide-text="${ASC.Resources.Master.FeedResource.HideAdditionalCommentsBtn}" data-state="0">${ASC.Resources.Master.FeedResource.ShowOthersCommentsBtn}<\/span><\/div>{{/if}}<div id="comment-form-${id}" class="comment-form"><textarea><\/textarea><div class="comment-error-msg-box"><span class="red-text">${ASC.Resources.Master.FeedResource.CommentErrorMsg}<\/span><\/div><a id="publish-comment-btn-${id}" class="publish-comment-btn button" href="#"                        data-id="${id}"                        data-entity="${item}"                        data-entityid="${itemId}"                        data-commentapiurl="${commentApiUrl}">${ASC.Resources.Master.FeedResource.PublishCommentBtn}<\/a><span class="splitter-buttons"><\/span><a id="cancel-comment-btn-${id}" class="cancel-comment-btn button gray" href="#" data-id="${id}">${ASC.Resources.Master.FeedResource.CancelCommentBtn}<\/a><\/div><div class="main-comments-box">{{each comments.slice(0, 3)}}                    {{tmpl($value) \'feed-inner-comment-tmpl\'}}                    {{/each}}<\/div><div class="extra-comments-box">{{each comments.slice(3)}}                    {{tmpl($value) \'feed-inner-comment-tmpl\'}}                    {{/each}}<\/div><\/div>{{/if}}<\/div><\/div>');jQuery.template("feedCommentTmpl",'<div class="comment"><a href="${author.profileUrl}" target="_blank"><img class="comment-avatar" src="${author.avatarBig}"/><\/a><div class="comment-content-box"><div class="comment-author"><a href="${author.profileUrl}" class="title" target="_blank">${author.displayName}<\/a>,                {{if author.title}}<span>${author.title},<\/span>{{/if}}<span>${date}<\/span><\/div><div class="comment-body">{{html description}}<\/div><div class="reply-comment-btn" data-commentid="${id}">${ASC.Resources.Master.FeedResource.ReplyCommentBtn}<\/div><\/div><\/div>');
jQuery.template("dropFeedTmpl",'<div class="item"><div class="avatar">{{if !isGuest}}<a href="${author.profileUrl}" title="${author.displayName}" target="_blank"><img src="${author.avatarBig}"/><\/a>{{else}}<img src="${ASC.Resources.Master.UserDefaultBigPhotoURL}"/>{{/if}}<\/div><div class="content-box"><div class="description"><span class="menu-item-icon ${itemClass}"><svg class="menu-item-svg"><use href="/skins/default/images/svg/feed-icons.svg#feedIcons${itemClass}"><\/use><\/svg><\/span><span class="product">${productText}.<\/span>{{if location}}<span class="location">${location}.<\/span>{{/if}}                {{if actionText}}<span class="action">${actionText}<\/span>{{/if}}                {{if groupedFeeds.length}}<span class="grouped-feeds-count">${ASC.Resources.Master.FeedResource.OtherFeedsCountMsg.format(groupedFeeds.length)}<\/span>{{/if}}<\/div><div class="header">{{if isAllDayEvent}}<span class="title-all-day-event" onclick="${linkOnClickAttr}">${linkInnerText}<\/span>{{else}}<a class="title" href="${itemUrl}" title="${title}" target="_blank">${title}<\/a>{{/if}}<\/div><div class="date">{{if comments && comments.length}}<span>${comments[comments.length - 1].formattedDate}<\/span>{{else}}                {{if isTomorrow}}<span>${tomorrow} ${displayCreatedTime}<\/span>{{else isToday}}<span>${today} ${displayCreatedTime}<\/span>{{else isYesterday}}<span>${yesterday} ${displayCreatedTime}<\/span>{{else}}<span>${displayCreatedDate}<\/span>{{if displayCreatedTime}}<span class="time">${displayCreatedTime}<\/span>{{/if}}                {{/if}}                {{/if}}<\/div><\/div><\/div>');
jQuery.template("dropMailsTmpl",'{{tmpl($data, {}) "dropMailTmpl"}}');jQuery.template("dropMailTmpl",'<div class="item" data-id="${id}"><div class="content-box"><div class="description"><span>${from}<\/span><\/div><div class="header"><a class="title" href="${itemUrl}" title="${subject}" target="_blank">${subject}<\/a><\/div><div class="date">{{if isToday}}<span>${ASC.Resources.Master.FeedResource.TodayAt}, ${displayTime}<\/span>{{else isYesterday}}<span>${ASC.Resources.Master.FeedResource.YesterdayAt}, ${displayTime}<\/span>{{else}}<span>${displayDate}, ${displayTime}<\/span>{{/if}}<\/div><\/div><\/div>');
jQuery.template("groupSelectorTemplate",'<div class="groupSelectorBox">{{if jq.browser.mobile === true}}<select id="grpselector_mgroupList_${selectorID}" class="comboBox addUserLink mobileSelectList"><\/select>{{else}}<span id="groupSelectorBtn_${selectorID}" class="addUserLink"><a class="link dotline">${linkText}<\/a><span class="sort-down-black"><\/span><\/span><div id="groupSelectorContainer_${selectorID}" class="borderBase tintLight groupSelectorContainer{{if jq.browser.mobile === true}} groupSelectorContainerMobile{{/if}}"><div class="clearFix filterBox"><input type="text" id="grpselector_filter_${selectorID}" class="textEdit" autocomplete="off"/><a id="grpselector_clearFilterBtn_${selectorID}" class="baseLinkAction float-left">${ASC.Resources.Master.TemplateResource.ClearFilterButton}<\/a><\/div><div id="grpselector_groupList_${selectorID}" class="grpselector_groupList"><\/div><\/div>{{/if}}<\/div>');jQuery.template("groupSelectorListTemplate",'{{if jq.browser.mobile === true}}        {{each(i, gpr) Groups}}<option value="${gpr.Id}" style="max-width:300px;">${gpr.Name}<\/option>{{/each}}    {{else}}        {{each(i, gpr) Groups}}<div class="group" data="${gpr.Id}" title="${gpr.Name}">${gpr.Name}<\/div>{{/each}}    {{/if}}');
jQuery.template("sharingListTemplate",'{{each(i, item) items}}<div id="sharing_item_${item.id}" class="sharingItem borderBase clearFix {{if i%2 == 0}}tintMedium{{/if}}">{{if item.isGroup}}<div class="name" title="${item.name}">${item.name}<span class="sharing-group"><\/span><\/div>{{else}}<div class="name"><span class="userLink" id="sharing_item_user_${item.id}" data-uid="${item.id}">${item.name}<\/span><\/div>{{/if}}<div class="remove">{{if item.canEdit & !item.hideRemove}}<div class="removeItem reset-icon" data="${item.id}"><\/div>{{else}}                    &nbsp;                {{/if}}<\/div><div class="action">{{if item.canEdit}}<select data="${item.id}" id="select_${item.id}">{{each(j, action) actions}}                            {{if !action.disabled | action.id == item.selectedAction.id}}<option value="${action.id}"                                    {{if action.id == item.selectedAction.id}}selected="selected"{{/if}}                                     {{if action.disabled}}disabled="disabled"{{/if}} >${action.name}<\/option>{{/if}}                        {{/each}}<\/select>{{else}}<span class="action-clean">${item.selectedAction.name}<\/span>{{/if}}<\/div><\/div>{{/each}}');jQuery.template("sharingActionsTemplate",'<ul class="dropdown-content">{{each(i, action) actions}}            {{if !action.disabled & typeof action.defaultStyle != "undefined"}}<li><a                        class="dropdown-item share-def-action-${action.defaultStyle} {{if action.defaultAction}}active{{/if}}"                        data-id="${action.id}"><span>${action.name}<\/span><\/a><\/li>{{/if}}        {{/each}}<\/ul>');
jQuery.template("template-selector-container",'<div class="advanced-selector-container {{if (opts.onechosen === true)}}onechosen{{/if}}"><div class="advanced-selector-list-block"><div class="advanced-selector-block clearFix"><div class="advanced-selector-block-list">{{if (opts.showSearch ==true)}}<div class="advanced-selector-search"><input class="advanced-selector-search-field" type="text" /><div class="advanced-selector-search-btn"><\/div><div class="advanced-selector-reset-btn"><\/div><\/div>{{/if}}                        {{if (opts.canadd === true)}}<div class="advanced-selector-add-new"><span class="advanced-selector-add-new-link"><span class="advanced-selector-add-new-text">${opts.addtext}<\/span><\/span><\/div>{{/if}}                        {{if (opts.onechosen === false) && (opts.showGroups === false) && !(opts.isTempLoad)}}<div class="advanced-selector-all-select"><div><\/div><label>${ASC.Resources.Master.UserControlsCommonResource.SelectAll}<\/label><\/div>{{/if}}<div class="advanced-selector-list-items"><div class="advanced-selector-no-results">${opts.noresults}<\/div><div class="advanced-selector-no-items">${opts.noitems}<\/div><div class="advanced-selector-empty-list">${opts.emptylist}<\/div><ul class="advanced-selector-list webkit-scrollbar"><\/ul><\/div><\/div>{{if (opts.showGroups === true)}}<div class="advanced-selector-block-list"><div class="advanced-selector-all-select chosen">{{if (opts.onechosen == false)}}<div><\/div>{{/if}}<label>${ASC.Resources.Master.UserControlsCommonResource.SelectAll}<\/label><\/div><div class="advanced-selector-list-groups"><div class="advanced-selector-no-groups">${opts.nogroups}<\/div><ul class="advanced-selector-list webkit-scrollbar"><\/ul><\/div><\/div>{{/if}}                    {{if (opts.onechosen === false)}}<div class="advanced-selector-selected-count"><\/div>{{/if}}<\/div>{{if (opts.onechosen === false)}}<div class="advanced-selector-btn-cnt"><button type="button" class="advanced-selector-btn-action button blue">${ASC.Resources.Master.UserControlsCommonResource.SaveButton}<\/button><span class="splitter-buttons"><\/span><button type="button" class="advanced-selector-btn-cancel button gray">${ASC.Resources.Master.UserControlsCommonResource.CancelButton}<\/button><\/div>{{/if}}<\/div><\/div>');jQuery.template("template-selector-add-new-item",'<div class="advanced-selector-add-new-block"><div class="advanced-selector-add-new-fields">{{each(i, field) fields}}<div class="advanced-selector-field-wrapper ${field.tag}"><div class="advanced-selector-title">${field.title}<\/div>{{if field.type == "input"}}<input class="advanced-selector-field" type="text" />{{else field.type == "date"}}<input class="textEditCalendar" type="text" autocomplete="off"/>{{else field.type == "choice"}}<select class="advanced-selector-field">{{each(j, item) field.items}}}<option value="${item.type}">${item.title}<\/option>{{/each}}<\/select>{{else field.type == "select"}}<div class="advanced-selector-field-search"><input class="advanced-selector-field" type="text" /><div class="advanced-selector-search-btn"><\/div><div class="advanced-selector-reset-btn" ><\/div><ul class="advanced-selector-field-list"><\/ul><\/div>{{/if}}<span class="advanced-selector-field-error"><\/span><\/div>{{/each}}<\/div><div class="advanced-selector-btn-cnt"><button type="button" class="advanced-selector-btn-add button blue">${btnTitle}<\/button><span class="splitter-buttons"><\/span><button type="button" class="advanced-selector-btn-cancel button gray">${ASC.Resources.Master.UserControlsCommonResource.CancelButton}<\/button><\/div><\/div>');jQuery.template("template-selector-input",'<input class="advanced-selector-search" type="text" />');jQuery.template("template-selector-items-list",'{{each(i, item) Items}}<li title="${item.tooltip || item.title}" class="${item.status} ${item.type} {{if (item.isChecked==true)}} selected {{/if}}" data-id="${item.id}" {{if (item.data==true)}} data-cnt="${item.data}" {{/if}}>{{if (isJustList == false)}}<div {{if (item.isChecked==true)}}class="checked"{{/if}}><\/div>{{/if}}        {{if item.avatarSmall}}<img src="${item.avatarSmall}"/>{{/if}}<label>${item.title}<\/label><\/li>{{/each}}');jQuery.template("template-selector-groups-list",'{{each(i, item) Items}}<li data-id="${item.id}" title="${item.title}">{{if (isJustList == false)}}<div><\/div>{{/if}}<label>${item.title}<\/label><\/li>{{/each}}');jQuery.template("template-selector-add-new-list-items",'{{each(i, item) Items}}<li data-id="${item.id}">${item.title}<\/li>{{/each}}');jQuery.template("template-selector-add-new-select-items",'{{each(i, item) Items}}<option value="${item.type}">${item.title}<\/option>{{/each}}');jQuery.template("template-selector-selected-items",'{{each(i, item) Items}}<li data-id="${item.id}"><span class="result-name">${item.title}<\/span><span class="reset-icon"><\/span><\/li>{{/each}}');
jQuery.template("template-emailselector-item",'<div class="emailselector-item {{if isValid === false}}error{{/if}}" title="${email}"><span class="emailselector-item-text">{{if name && name !== email }}${name} (${email}){{else}}${email}{{/if}}<\/span><span class="emailselector-item-close">&times;<\/span><\/div>');jQuery.template("template-emailselector-autocomplete","<li><a>{{if name }}${name},&nbsp;{{/if}}{{if email }}${email}{{/if}}<\/a><\/li>");
jQuery.template("template-emptyScreen",'<div id="${ID}" class="noContentBlock emptyScrCtrl{{if typeof(CssClass)!="undefined"}} ${CssClass}{{/if}}">{{if typeof(ImgSrc)!="undefined" && ImgSrc != null && ImgSrc != ""}}<table><tr><td><img src="${ImgSrc}" alt="" class="emptyScrImage"/><\/td><td><div class="emptyScrTd">{{/if}}                        {{if typeof(Header)!="undefined" && Header != null && Header != ""}}<div class="header-base-big">${Header}<\/div>{{/if}}                        {{if typeof(HeaderDescribe)!="undefined" && HeaderDescribe != null && HeaderDescribe != ""}}<div class="emptyScrHeadDscr">${HeaderDescribe}<\/div>{{/if}}                        {{if typeof(Describe)!="undefined" && Describe != null && Describe != ""}}<div class="emptyScrDscr">{{html Describe}}<\/div>{{/if}}                        {{if typeof(ButtonHTML)!="undefined" && ButtonHTML != null && ButtonHTML != ""}}<div class="emptyScrBttnPnl">{{html ButtonHTML}}<\/div>{{/if}}                        {{if typeof(ImgSrc)!="undefined" && ImgSrc != null && ImgSrc != ""}}<\/div><\/td><\/tr><\/table>{{/if}}<\/div>');jQuery.template("template-blockUIPanel",'<div style="display: none;" id="${id}"><div class="popupContainerClass"><div class="containerHeaderBlock"><table cellspacing="0" cellpadding="0" border="0" style="width: 100%; height: 0px;"><tbody><tr valign="top"><td {{if typeof(headerClass) !="undefined" && headerClass !=""}}class="${headerClass}"{{/if}}>${headerTest}<\/td><td class="popupCancel"><div onclick="PopupKeyUpActionProvider.CloseDialog();" class="cancelButton" title="${ASC.Resources.Master.TemplateResource.CloseButton}">&times;<\/div><\/td><\/tr><\/tbody><\/table><\/div><div class="infoPanel{{if typeof(infoType) != "undefined" && infoType !=""}} ${infoType}{{/if}}"                 {{if typeof(infoMessageText) == "undefined" || infoMessageText== ""}}style="display: none;"{{/if}}><div>{{if typeof(infoMessageText) != "undefined" && infoMessageText != ""}}${infoMessageText}{{/if}}<\/div><\/div><div class="containerBodyBlock">{{if typeof(questionText) != "undefined" && questionText != ""}}<div><b>${questionText}<\/b><\/div>{{/if}}                {{html innerHtmlText}}                {{if typeof(OKBtn) != \'undefined\' && OKBtn != "" || typeof(OtherBtnHtml) != \'undefined\' || typeof(CancelBtn) != \'undefined\' && CancelBtn != ""}}<div class="middle-button-container">{{if typeof(OKBtn) != \'undefined\' && OKBtn != ""}}<a class="button blue middle{{if typeof(OKBtnClass) != \'undefined\'}} ${OKBtnClass}{{/if}}"                       {{if typeof(OKBtnID) !=\'undefined\'}}id="${OKBtnID}"{{/if}}                       {{if typeof(OKBtnHref) !=\'undefined\' && OKBtnHref !=""}} href="${OKBtnHref}"{{/if}}>${OKBtn}<\/a><span class="splitter-buttons"><\/span>{{/if}}                    {{if typeof(OtherBtnHtml) != \'undefined\'}}                    {{html OtherBtnHtml}}<span class="splitter-buttons"><\/span>{{/if}}                    {{if typeof(CancelBtn) != \'undefined\' && CancelBtn != ""}}<a class="button gray middle{{if typeof(CancelBtnClass) != \'undefined\'}} ${CancelBtnClass}{{/if}}"                       {{if typeof(CancelBtnID) !=\'undefined\'}}id="${CancelBtnID}"{{/if}}                       onclick="PopupKeyUpActionProvider.EnableEsc = true; jq.unblockUI();">${CancelBtn}<\/a>{{/if}}<\/div>{{/if}}<\/div><\/div><\/div>');jQuery.template("template-newFile",'<tr class="newDoc"><td class="${tdclass}" colspan="2"><input id="newDocTitle" type="text" class="textEdit" data="${ASC.Resources.Master.UserControlsCommonResource.NewDocument}" maxlength="165" value="${ASC.Resources.Master.UserControlsCommonResource.NewDocument}"/><span id="${type}" onclick="${onCreateFile}" class="button gray btn-action __apply createFile" title="${ASC.Resources.Master.TemplateResource.AddButton}"><\/span><span onclick="${onRemoveNewDocument}" title="${ASC.Resources.Master.UserControlsCommonResource.QuickLinksDeleteLink}" class="button gray btn-action __reset remove"><\/span><\/td><\/tr>');jQuery.template("template-fileAttach",'<tr><td id="af_${id}">{{if type=="image"}}<a href="${viewUrl}" rel="imageGalery" class="screenzoom ${exttype}" title="${title}"><div class="attachmentsTitle">${title}<\/div>{{if versionGroup > 1}}<span class="version">${ASC.Resources.Master.UserControlsCommonResource.Version}${versionGroup}<\/span>{{/if}}<\/a>{{else}}                {{if type=="media"}}<a href="${viewUrl}" class="mediafile ${exttype}" title="${title}"><div class="attachmentsTitle">${title}<\/div>{{if versionGroup > 1}}<span class="version">${ASC.Resources.Master.UserControlsCommonResource.Version}${versionGroup}<\/span>{{/if}}<\/a>{{else}}                    {{if type == "editedFile" || type == "viewedFile"}}<a href="${docEditUrl}" class="${exttype}" title="${title}" target="_blank"><div class="attachmentsTitle">${title}<\/div>{{if versionGroup > 1}}<span class="version">${ASC.Resources.Master.UserControlsCommonResource.Version}${versionGroup}<\/span>{{/if}}<\/a>{{else}}<a href="${viewUrl}" class="${exttype} noEdit" title="${title}" target="_blank"><div class="attachmentsTitle">${title}<\/div>{{if versionGroup > 1}}<span class="version">${ASC.Resources.Master.UserControlsCommonResource.Version}${versionGroup}<\/span>{{/if}}<\/a>{{/if}}                {{/if}}            {{/if}}<\/td><td class="editFile">{{if (access==0 || access==1)}}<a class="{{if trashAction == "delete"}}deleteDoc{{else}}unlinkDoc{{/if}}" title="{{if trashAction == "delete"}}${ASC.Resources.Master.UserControlsCommonResource.DeleteFile}{{else}}${ASC.Resources.Master.UserControlsCommonResource.RemoveFromList}{{/if}}" data-fileId="${id}"><\/a>{{/if}}            {{if (!jq.browser.mobile)}}<a class="downloadLink" title="${ASC.Resources.Master.UserControlsCommonResource.DownloadFile}" href="${viewUrl}"><\/a>{{/if}}            {{if (type == "editedFile")&&(access==0 || access==1)}}<a id="editDoc_${id}" title="${ASC.Resources.Master.UserControlsCommonResource.EditFile}" target="_blank" href="${editUrl}"><\/a>{{/if}}<\/td><\/tr>');jQuery.template("template-accountLinkCtrl",'<ul class="account-links tabs-content">{{each(i, acc) infos}}<li class="${acc.Provider}{{if acc.Linked == true}} connected{{/if}} ${lang}"><span class="icon {{if disable == true}}opacity{{/if}}"><\/span><span>{{if acc.Linked == true}}                    ${ASC.Resources.Master.TemplateResource.AssociateAccountConnected}                {{else}}                    ${ASC.Resources.Master.TemplateResource.AssociateAccountNotConnected}                {{/if}}<\/span><a {{if disable != true}}href="${acc.Url}"{{/if}}  class="popup{{if acc.Linked == true}} linked{{/if}} {{if disable == true}}disable{{/if}}" id="${acc.Provider}">{{if acc.Linked == true}}                    ${ASC.Resources.Master.TemplateResource.AssociateAccountDisconnect}                {{else}}                    ${ASC.Resources.Master.TemplateResource.AssociateAccountConnect}                {{/if}}<\/a><\/li>{{/each}}<\/ul>');jQuery.template("template-mailCalendar",'<div style="background-color: #fff; width: 600px; margin: 0 auto; text-align: left;"><table cellspacing="0" cellpadding="0" style="font-family: \'Open Sans\', Tahoma, Arial; font-size: 14px; color: #333; background: #fff; text-align: center; width: 600px; margin: 0; padding: 0; border: 0 none; border-collapse: collapse; empty-cells: show; border-spacing: 0;"><tbody><tr border="0" cellspacing="0" cellpadding="0"><td colspan="3" style="margin: 0; padding: 0; background-color: #fff; height: 65px; padding: 20px 0 0 30px;"><div style="text-align: left; height: 65px; width: 570px; margin: 0; padding: 0;"><a href="http://www.onlyoffice.com/"                           style="text-decoration: none; display: inline-block; width: 216px; height: 35px; margin: 0; padding: 0;"                           target="_blank"><img style="border: 0px none; width: 216px; height: 35px; margin: 0; padding: 0;"                                 src="${ASC.Resources.Master.LogoDarkUrl}"/><\/a><\/div><\/td><\/tr><tr border="0" cellspacing="0" cellpadding="0"><td colspan="3" style="margin: 0; padding: 15px 30px 15px; background-color: #f6f6f6; -moz-border-radius: 6px; -webkit-border-radius: 6px; border-radius: 6px;"><div style="font-family: \'Open Sans\', Tahoma, Arial; font-size: 14px; color: #333; margin: 0; padding: 0; width: 540px; height: auto; overflow: hidden; word-wrap: break-word; vertical-align: top; text-align: left; border: 0 none;"><div style="font-family: \'Open Sans\', Tahoma, Arial; font-size: 14px; color: #333; padding: 5px 0 10px 0; width: 540px; overflow: hidden; word-wrap: break-word;"><table cellpadding="0" cellspacing="0" style="font-family: \'Open Sans\', Tahoma, Arial; border-collapse: collapse; height: 132px; width: 100%;"><tr><td colspan="3" style="padding-bottom: 16px;"><table cellpadding="0" cellspacing="0" style="font-family: \'Open Sans\', Tahoma, Arial; border-collapse: collapse;"><tbody><tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; padding-bottom: 8px;">${action}<\/td><\/tr><tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 24px;">${summary}<\/td><\/tr><\/tbody><\/table><\/td><\/tr><tr><td width="66" height="66" align="left" valign="top" style="width: 66px; height: 66px;"><img style="border: 0px none; width: 66px; height: 66px; margin: 0; padding: 0;" src="${StudioManager.GetImage(\'event_66.png\')}"/><\/td><td style="padding-left: 16px;"><table cellpadding="0" cellspacing="0" style="font-family: \'Open Sans\', Tahoma, Arial; border-collapse: collapse;"><tbody><tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; color: rgb(153, 153, 153);">${ASC.Resources.Master.TemplateResource.MailIcsCalendarWhenLabel}:<\/td><td style="vertical-align: top; padding-left: 8px; padding-bottom: 8px; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px;" title="${dateEvent}">${dateEvent}<\/td><\/tr>{{if typeof(rruleText) != \'undefined\' && rruleText != \'\' && rruleText != null }}<tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; color: rgb(153, 153, 153);">${ASC.Resources.Master.TemplateResource.MailIcsCalendarRecurrenceLabel}:<\/td><td style="vertical-align: top; padding-left: 8px; padding-bottom: 8px; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px;" title="${dateEvent}">${rruleText}<\/td><\/tr>{{/if}}<tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; color: rgb(153, 153, 153);">${ASC.Resources.Master.TemplateResource.MailIcsCalendarWhereLabel}:<\/td><td style="vertical-align: top; padding-left: 8px; padding-bottom: 8px; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px;" {{if typeof(location) !=\'undefined\' && location !=\'\'&& location !=null }} title="${location}" {{/if}}>{{if typeof(location) != \'undefined\' && location != \'\' && location != null }}                                                        ${location}                                                        {{if typeof(mapUrl) != \'undefined\' && mapUrl != \'\' && mapUrl != null }}                                                        &nbsp;<a href="${mapUrl}" target="_blank" style="color: #333333;">(${ASC.Resources.Master.TemplateResource.MailIcsCalendarMapLabel})<\/a>{{/if}}                                                        {{else}}                                                        ${ASC.Resources.Master.TemplateResource.MailIcsCalendarNoLocationLabel}                                                        {{/if}}<\/td><\/tr><tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; color: rgb(153, 153, 153);">${ASC.Resources.Master.TemplateResource.MailIcsCalendarWhoLabel}:<\/td><td style="vertical-align: top; padding-left: 8px; padding-bottom: 8px; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px;">{{if orgEmail !== \'\' }}<a title="${orgEmail}" name="${orgName}" href="${mailToHref}" style="color: #333333;">{{if typeof(orgName) != \'undefined\' && orgName != \'\' && orgName != null }}                                                            ${orgName}                                                            {{else}}                                                            ${orgEmail}                                                            {{/if}}<\/a>{{else}}                                                        ${orgName}                                                        {{/if}}&nbsp;(${ASC.Resources.Master.TemplateResource.MailIcsCalendarOrganizerLabel})<\/td><\/tr>{{if typeof(description) != \'undefined\' && description != \'\' && description != null }}<tr><td style="vertical-align: top; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; color: rgb(153, 153, 153);">${ASC.Resources.Master.TemplateResource.MailIcsCalendarDescriptionLabel}:<\/td><td style="vertical-align: top; padding-left: 8px; padding-bottom: 8px; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px;">{{html description}}<\/td><\/tr>{{/if}}<\/tbody><\/table><\/td><\/tr><\/table><\/div><\/div><\/td><\/tr><tr border="0" cellspacing="0" cellpadding="0"><td colspan="5" style="width: 600px; vertical-align: top; margin: 0; padding: 20px 30px 15px;"><p style="color: #7b7b7b; font-family: \'Open Sans\', Tahoma, Arial; font-size: 12px; margin: 0; padding: 0; text-align: center; width: 540px;">${ASC.Resources.Master.TemplateResource.MailAutoGeneratedText}<br/>${ASC.Resources.Master.TemplateResource.AllRightsReservedText}<\/p><\/td><\/tr><\/tbody><\/table><\/div>');jQuery.template("template-mailReceipt",'<div style="background-color: #fff; width: 600px; margin: 0 auto; text-align: left;"><table cellspacing="0" cellpadding="0" style="font-family: \'Open Sans\', Tahoma, Arial; font-style: normal; font-weight: 400; font-size: 14px; color: #333; background: #fff; text-align: center; width: 600px; margin: 0; padding: 0; border: 0 none; border-collapse: collapse; empty-cells: show; border-spacing: 0;"><tbody><tr border="0" cellspacing="0" cellpadding="0"><td colspan="3" style="margin: 0; padding: 0; background-color: #fff; height: 65px; padding: 20px 0 0 30px;"><div style="text-align: left; height: 65px; width: 570px; margin: 0; padding: 0;"><a href="http://www.onlyoffice.com/" style="text-decoration: none; display: inline-block; width: 216px; height: 35px; margin: 0; padding: 0;" target= "blank"><img src="${ASC.Resources.Master.LogoDarkUrl}" x-mail-embedded="true" style="border: 0px none; width: 216px; height: 35px; margin: 0; padding: 0;"/><\/a><\/div><\/td><\/tr><tr border="0" cellspacing="0" cellpadding="0"><td colspan="3" style="margin: 0; padding: 15px 30px 15px; background-color: #f6f6f6; -moz-border-radius: 6px; -webkit-border-radius: 6px; border-radius: 6px;"><div style="font-family: \'Open Sans\', Tahoma, Arial; font-style: normal; font-weight: 400; font-size: 14px; color: #333; margin: 0; padding: 0; width: 540px; height: auto; overflow: hidden; word-wrap: break-word; vertical-align: top; text-align: left; border: 0 none;"><h1 style="color: #333333; font-size: 28px; font-weight: bold; margin: 0">${receiptLabel}<\/h1><br>${user}&nbsp;&lt;<a href="mailto:${mailTo}">${mailTo}<\/a>&gt;&nbsp;${receiptUserLabel}<br>${dateNow}<br><br><hr style="color: #C4C4C4;"><br>${sentRequestInfoLabel}<br>${dateSent}<br><br><\/div><\/td><\/tr><\/tbody><\/table><\/div>');jQuery.template("consumerSettingsTmpl","<select class=\"textEdit\">{{each storages}}<option value=\"${id}\">${title}<\/option>{{/each}}<\/select>{{each storages}}<div data-id=\"${id}\" class=\"display-none\">{{each properties}}        {{if !isSet}}<input class='textBox disabled' placeholder='${title}' data-id='${name}' type='text' disabled>{{else}}<input class='textBox' placeholder='${title}' data-id='${name}' type='text'>{{/if}}        {{/each}}<\/div>{{/each}}");
jQuery.template("template-productItem",'{{if CanNotBeDisabled === false}}<div class="tabs-section {{if Disabled === true}} accessRights-disabledText{{/if}}"><span class="header-base"><img src="{{if Disabled === true}}${DisabledIconUrl}{{else}}${IconUrl}{{/if}}" align="absmiddle" /><span>${Name}<\/span><\/span><span id="switcherAccessRights_${ItemName}" data-id="${ItemName}" class="toggle-button"            data-switcher="0" data-showtext="${ASC.Resources.Master.TemplateResource.Show}" data-hidetext="${ASC.Resources.Master.TemplateResource.Hide}">${ASC.Resources.Master.TemplateResource.Hide}<\/span><\/div><div id="accessRightsContainer_${ItemName}" data-id="${ID}" class="accessRights-content"><div{{if Disabled === true}} style=\'display:none\'{{/if}}><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="390px" valign="top"><div>${jq.format(ASC.Resources.Master.AccessRightsAccessToProduct, Name)}:<\/div><div class="accessRightsItems"><input type="radio" id="all_${ID}" name="radioList_${ID}"                             onclick="ASC.Settings.AccessRights.changeAccessType(this, \'${ItemName}\')"><label for="all_${ID}">${ASC.Resources.Master.AccessRightsAllUsers}<\/label><\/div><div class="accessRightsItems"><input type="radio" id="fromList_${ID}" name="radioList_${ID}"                             onclick="ASC.Settings.AccessRights.changeAccessType(this, \'${ItemName}\')"><label for="fromList_${ID}">${ASC.Resources.Master.AccessRightsUsersFromList}<\/label><\/div><\/td><td valign="top">{{if UserOpportunities != null && UserOpportunities.length > 0}}<div>${UserOpportunitiesLabel}:<\/div>{{each(i, opp) UserOpportunities}}<div class="simple-marker-list">${Encoder.htmlEncode(opp)}<\/div>{{/each}}                        {{/if}}<\/td><\/tr><\/tbody><\/table><div id="selectorContent_${ItemName}" class="accessRightProductBlock"><div id="emptyUserListLabel_${ItemName}" class="describe-text accessRightsEmptyUserList">${ASC.Resources.Master.AccessRightsEmptyUserList}<\/div><div id="selectedUsers_${ItemName}" class="clearFix">{{if SelectedUsers != null &&  SelectedUsers.length > 0}}                    {{each(i, usr) SelectedUsers}}<div class="accessRights-selectedItem" id="selectedUser_${ItemName}_${usr.ID}"><img src="${window.imageHelper.PeopleImgSrc}"><img src="${window.imageHelper.TrashImgSrc}" id="deleteSelectedUserImg_${ItemName}_${usr.ID}"                                title="${window.imageHelper.TrashImgTitle}" class="display-none">${usr.Name}<\/div>{{/each}}                {{/if}}<\/div><div id="selectedGroups_${ItemName}" class="clearFix">{{if SelectedGroups != null &&  SelectedGroups.length > 0}}                    {{each(i, gr) SelectedGroups}}<div class="accessRights-selectedItem" id="selectedGroup_${ItemName}_${gr.ID}"><img src="${window.imageHelper.GroupImgSrc}"><img src="${window.imageHelper.TrashImgSrc}" id="deleteSelectedGroupImg_${ItemName}_${gr.ID}"                                title="${window.imageHelper.TrashImgTitle}" class="display-none">${gr.Name}<\/div>{{/each}}                {{/if}}<\/div><div class="accessRights-selectorContent"><div id="userSelector_${ItemName}" class="link dotline plus">${ASC.Resources.Master.AccessRightsAddUser}<\/div><div id="groupSelector_${ItemName}" class="link dotline plus">${ASC.Resources.Master.AccessRightsAddGroup}<\/div><\/div><\/div><\/div><div class="accessRights-disabledText" {{if Disabled === false}} style=\'display:none\'{{/if}}>${jq.format(ASC.Resources.Master.AccessRightsDisabledProduct, Name)}<\/div><\/div>{{/if}}');
jQuery.template("template-commentsList",'{{if showCaption == true}}<div id="commentsTitle" class="headerPanel">${ASC.Resources.Master.TemplateResource.Comments}<\/div>{{/if}}<div id="noComments"{{if isEmpty !== true}} style="display: none;"{{/if}}>${ASC.Resources.Master.UserControlsCommonResource.NoComments}<\/div><textarea id="commentsClip" style="position: absolute;top: 0;left: -1000px;"><\/textarea><div id="mainCommentsContainer" class="comment-main-container" style="{{if total%2==0}}border-bottom:1px solid #ddd; {{/if}} {{if isEmpty===true}} display:none; {{/if}}">{{each(i, cmt) comments}}        {{tmpl({comment: cmt, commentLevel: 1, maxDepthLevel: maxDepthLevel}) \'template-comment\'}}        {{/each}}<\/div><br/>{{if isShowAddCommentBtn == true}}<a id="add_comment_btn">${ASC.Resources.Master.TemplateResource.AddNewCommentButton}<\/a>{{/if}}<div id="commentBox" class="comment-main-actions-container"><div id="commentBoxContainer"><input type="hidden" id="hdnParentComment" value=""/><input type="hidden" id="hdnAction" value=""/><input type="hidden" id="hdnCommentID" value=""/><input type="hidden" id="hdnObjectID" value="${objectID}"/><textarea id="commentEditor${_jsObjName}" name="commentEditor${_jsObjName}"><\/textarea><div class="middle-button-container"><a href="javascript:void(0);" id="btnAddComment" class="button">${ASC.Resources.Master.TemplateResource.PublishButton}<\/a><span class="splitter-buttons"><\/span><a href="javascript:void(0);" id="btnPreview" class="button disable">${ASC.Resources.Master.TemplateResource.PreviewButton}<\/a><span class="splitter-buttons"><\/span><a href="javascript:void(0);" id="btnCancel" class="button gray cancelFckEditorChangesButtonMarker">${ASC.Resources.Master.TemplateResource.CancelButton}<\/a><\/div><\/div><div id="previewBox" class="comment-preview-container"><div class="headerPanel">${ASC.Resources.Master.TemplateResource.PreviewButton}<\/div><div id="previewBoxBody"><\/div><div class="middle-button-container"><a href="javascript:void(0);" class="button blue">${ASC.Resources.Master.TemplateResource.CloseButton}<\/a><\/div><\/div><\/div>');jQuery.template("template-comment",'<div{{if commentLevel != 1 && commentLevel <= maxDepthLevel}} style="margin-left: 35px;"{{/if}} id="container_${comment.commentID}"><div class="comments-item-container" id="comment_${comment.commentID}">{{if comment.inactive}}                {{tmpl \'template-comment-inactive\'}}            {{else}}<table cellpadding="0" cellspacing="0"><tr><td><img class="userMiniPhoto" alt="${comment.userFullName}" src="${comment.userAvatarPath}"/><\/td><td><div class="comments-item-data"><div><a style="margin-left:10px;" class="link bold" href="${comment.userProfileLink}">${comment.userFullName}<\/a>&nbsp;&nbsp;<span class="text-medium-describe" style="padding-left:5px;">${comment.timeStampStr}<\/span><a id="clip_${comment.commentID}" class="link dotline gray" style="float:right;" title="${ASC.Resources.Master.CopyToClipboard}">#<\/a><\/div>{{if comment.userPost != ""}}<div style="padding-top:2px;padding-left:10px;" class="describe-text">${comment.userPost}<\/div>{{/if}}<div id="content_${comment.commentID}" style="padding-top:8px;padding-left:10px;" class="longWordsBreak clearFix">{{html comment.commentBody}}<\/div>{{if comment.attachments != null && comment.attachments.length > 0}}<div id="attacments_${comment.commentID}" style="padding-top:10px;padding-left:15px;">{{each(k, attach) comment.attachments}}                                {{if k!=0}}, {{/if}}<a class="linkDescribe" href="${attach.FilePath}">${attach.FileName}<\/a><input name="attacment_name_${comment.commentID}" type="hidden" value="${attach.FileName}" /><input name="attacment_path_${comment.commentID}" type="hidden" value="${attach.FileName}" />{{/each}}<\/div>{{/if}}<\/div><div class="clearFix comments-item-actions">{{if comment.isResponsePermissions == true}}<div class="float-left"><a class="link dotline gray" id="response_${comment.commentID}" href="javascript:void(0);">${ASC.Resources.Master.TemplateResource.AnswerButton}<\/a><\/div>{{/if}}                       {{if comment.isEditPermissions == true}}<div class="float-right"><a class="link dotline gray" id="edit_${comment.commentID}" href="javascript:void(0);">${ASC.Resources.Master.TemplateResource.EditButton}<\/a><span class="text-medium-describe splitter"><\/span><a class="link dotline gray" id="remove_${comment.commentID}" href="javascript:void(0);">${ASC.Resources.Master.TemplateResource.DeleteButton}<\/a><\/div>{{/if}}<\/div><\/td><\/tr><\/table>{{/if}}<\/div>{{if comment.commentList != null && comment.commentList.length > 0}}        {{each(ind, citem) comment.commentList}}            {{tmpl({comment: citem, commentLevel: commentLevel + 1, maxDepthLevel: maxDepthLevel}) \'template-comment\'}}        {{/each}}        {{/if}}<\/div>');jQuery.template("template-comment-inactive",'<div class="comment-inactive">${ASC.Resources.Master.TemplateResource.CommentWasRemoved}<\/div>');
jQuery.template("common_containerTmpl",'<div class="{{if options.IsPopup && options.PopupContainerCssClass}} ${options.PopupContainerCssClass} {{else}} ${options.ContainerCssClass}{{/if}}" style="${options.ContainerStyle}">{{if header || currentPageCaption || options.IsPopup}}<div class="containerHeaderBlock"><table cellspacing="0" cellpadding="0" border="0" style=\'width: 100%; height: 0px;\'><tr valign="top"><td>{{if currentPageCaption}}<div>{{if options.HeaderBreadCrumbCaption}}                            ${options.HeaderBreadCrumbCaption}                            {{else}}                            ${Encoder.htmlEncode(currentPageCaption)}                            {{/if}}<\/div>{{else header}}                        {{tmpl(header.data) header.title}}                        {{/if}}<\/td>{{if options.IsPopup}}<td class="popupCancel"><div class="cancelButton" onclick="${options.OnCancelButtonClick}">&times;<\/div><\/td>{{/if}}<\/tr><\/table><\/div>{{/if}}        {{if options.IsPopup}}<div {{if !options.InfoMessageText}}style="display:none" {{/if}} class="infoPanel {{if options.InfoType === 1}} warn{{else options.InfoType === 2}} alert{{/if}}"><div>${options.InfoMessageText}<\/div><\/div>{{else}}<div class="infoPanel {{if options.InfoType === 1}} warn{{else options.InfoType === 2}} alert{{/if}}"><div {{if !options.InfoMessageText}}style="display:none" {{/if}}>${options.InfoMessageText}<\/div><\/div>{{/if}}        {{if body}}<div class="containerBodyBlock">{{tmpl(body.data) body.title}}<\/div>{{/if}}<\/div>');
jQuery.template("progressDialogTmpl",'<div id="bottomLoaderPanel" class="progress-dialog-container"><div id="progressDialog" class="progress-dialog"><div class="progress-dialog-header"><a class="actions-container close" title="${ASC.Resources.Master.ResourceJS.CloseButton}">&times;<\/a><span id="progressDialogHeader">${header}<\/span><\/div><div class="progress-dialog-body"><div class="pd-body-container"><table id="progressDialogBodyTable" class="tableBase" cellspacing="0" cellpadding="5"><colgroup><col class="pd-column-icon" /><col /><col class="pd-column-progress" /><col class="pd-column-action" /><\/colgroup><tbody><\/tbody><\/table><\/div><div>{{html footer}}<\/div><\/div><\/div><\/div>');jQuery.template("progressDialogRowTmpl",'<tr id="${id}" class="pd-row started"><td class="borderBase"><div class="${fileTypeCssClass}"><\/div><\/td><td class="borderBase"><div class="pd-cell-title" ><span title="${fileName}">${fileName}<\/span><\/div><\/td><td class="borderBase"><div class="pd-cell-progress"><progress max="100" value="0" ><div class="asc-progress-wrapper"><div class="asc-progress-value"><\/div><\/div><\/progress><div class="progress-label">0%<\/div><span class="progress-complete gray-text">${ASC.Resources.Master.ResourceJS.Complete}<\/span><span class="progress-error red-text expl">${ASC.Resources.Master.ResourceJS.Error}<\/span><div class="popup_helper"><\/div><\/div><\/td><td class="borderBase"><div class="pd-cell-action"><a class="linkMedium gray-text" href="#" target="_blank">${ASC.Resources.Master.ResourceJS.Open}<\/a><\/div><\/td><\/tr>');jQuery.template("progressBarTmpl",'<div id="progressDialog" class="progress-dialog"><div class="progress-dialog-header"><a class="actions-container close" title="${ASC.Resources.Master.ResourceJS.CloseButton}">&times;<\/a><span id="progressDialogHeader">${header}<\/span><\/div><div class="progress-dialog-body files-progress-box"><progress max="100" value="0"><div class="asc-progress-wrapper"><div class="asc-progress-value"><\/div><\/div><\/progress><div class="asc-progress-percent">${percentage}<\/div><\/div><\/div>');
window.CustomEvent=function(n){var t,r,i;if(typeof this.supportedEvents=="undefined"&&(this.supportedEvents=[]),typeof this.eventHandlers=="undefined"&&(this.eventHandlers=[],this.handlerIds={}),!n)return undefined;if(typeof n=="object")if(n instanceof Array)for(t=0,r=n.length;t<r;t++)typeof n[t]=="string"&&this.supportedEvents.push(n[t].toLowerCase());else for(i in n)n.hasOwnProperty(i)&&typeof n[i]=="string"&&this.supportedEvents.push(n[i].toLowerCase());else typeof n=="string"&&this.supportedEvents.push(n.toLowerCase())};window.CustomEvent.prototype.isSupported=function(n){if(!(this.supportedEvents instanceof Array)||!(this.eventHandlers instanceof Array))return!1;for(var t=this.supportedEvents.length;t--;)if(this.supportedEvents[t]===n)return!0;return!1};window.CustomEvent.prototype.bind=function(n,t,i){var f,u;if(!(this.supportedEvents instanceof Array)||!(this.eventHandlers instanceof Array))throw"Invalid CustomEvent object";if(typeof n!="string"||typeof t!="function")throw"Incorrect params";if(!this.isSupported(n=n.toLowerCase()))throw"Unsupported event "+n;i=i||{};f=i.hasOwnProperty("once")?i.once:!1;u=0;u|=+f*1;for(var e=0,r=Math.floor(Math.random()*1e6);this.handlerIds.hasOwnProperty(r)&&e++<1e3;)r=Math.floor(Math.random()*1e6);return this.handlerIds[r]={},this.eventHandlers.push({id:r,name:n,handler:t,type:u}),r};window.CustomEvent.prototype.unbind=function(n){if(!(this.supportedEvents instanceof Array)||!(this.eventHandlers instanceof Array))throw"Invalid CustomEvent object";if(typeof n=="undefined")return undefined;if(this.handlerIds.hasOwnProperty(n))for(var i=this.eventHandlers,t=this.eventHandlers.length;t--;)if(i[t].id===n){delete this.handlerIds[t];i.splice(t,1);break}};window.CustomEvent.prototype.call=function(n,t,i){var u,r,f;if(!(this.supportedEvents instanceof Array)||!(this.eventHandlers instanceof Array))throw"Invalid CustomEvent object";if(typeof n!="string")throw"Incorrect params";if(!this.isSupported(n=n.toLowerCase()))throw"Unsupported event "+n;for(t=t||window,i=i||[],u=this.eventHandlers,r=0,f=u.length;r<f;r++)u[r].name===n&&(u[r].handler.apply(t,i),f=u.length,u[r]&&u[r].type&1&&(u.splice(r,1),r--,f--))};window.CustomEvent.prototype.extend=function(n){var t,r,i;if(typeof this.supportedEvents=="undefined"&&(this.supportedEvents=[]),typeof this.eventHandlers=="undefined"&&(this.eventHandlers=[],this.handlerIds={}),!n)return undefined;if(typeof n=="object")if(n instanceof Array)for(t=0,r=n.length;t<r;t++)typeof n[t]=="string"&&this.supportedEvents.push(n[t].toLowerCase());else for(i in n)n.hasOwnProperty(i)&&typeof n[i]=="string"&&this.supportedEvents.push(n[i].toLowerCase());else typeof n=="string"&&this.supportedEvents.push(n.toLowerCase())};
window.ServiceFactory=function(){function n(n,t,i){var r={handler:n,re:t};return typeof i!="undefined"&&(r.method=i),r}function lt(n){return n?n.constructor.toString().indexOf("Array")!=-1:!1}function fi(n,t){var i,r,u;if(t===!0){for(i=[["&lt;","<"],["&gt;",">"],["&and;","\\^"],["&sim;","~"],["&amp;","&"]],r=i.length;r--;)n=n.replace(new RegExp(i[r][1],"g"),i[r][0]);return n}return u=document.createElement("textarea"),u.innerHTML=n,u.value}function s(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function ei(n){if(!n||typeof n!="object")return n;var i,t,r=typeof n.pop=="function"?[]:{};for(i in n)n.hasOwnProperty(i)&&(t=n[i],r[i]=t&&typeof t=="object"?ei(t):t);return r}function i(n,t,i){for(var u=[],r=n?n.length:0;r--;)u.unshift(s(t?t(n[r]):{},i(n[r])));return u}function a(n,t){return(n=""+n,!t)?n.length===1?"0"+n:n:n.length===t?n:"000000000".substring(0,t-n.length)+n}function di(n){var t=null;if(typeof n=="string"){try{t=JSON.parse(fi(n))}catch(i){t=null}if(!t||typeof t!="object")try{t=JSON.parse(fi(jQuery.base64.decode(n)))}catch(i){t=null}}if(typeof n=="object")try{t=n.hasOwnProperty("response")?n.response:n}catch(i){t=null}return t}function at(n){return n?(n.indexOf("://")===-1&&(n.charAt(0)!=="/"&&(n="/"+n),n=[location.protocol,"//",location.hostname,location.port?":"+location.port:"",n].join("")),n):""}function gi(n){for(var i=null,r=0,u=bi,t=0,t=u.length;t--;)for(i=u[t].exts,r=i.length;r--;)if(i[r]==n)return u[t].name;return"unknown"}function nr(n){for(var i=ii,t=0,t=i.length;t--;)if(n==i[t])return!0;return!1}function tr(n){for(var t=wi,i=0,i=t.length;i--;)if(t[i].id==n)return t[i].label;return t.length>0?t[0].label:""}function ir(n){for(var t=pi,i=0,i=t.length;i--;)if(t[i].id==n)return t[i].label;return t.length>0?t[0].label:n}function oi(n){var t=ct;for(var i in t)if(t.hasOwnProperty(i)&&t[i].id==n)return t[i].name;return""}function rr(n){var t=null,i=null,r={mailboxes:[],telephones:[],links:[]},u,f;if(!n)return r;for(u=0,f=n.length;u<f;u++){i=n[u];t={type:l.hasOwnProperty(i.type)?l[i.type].type:-1,name:i.type,title:i.value,label:l.hasOwnProperty(i.type)?l[i.type].title:i.type,istop:!1};switch(t.name){case l.twitter.name:t.val=t.title.indexOf("twitter.com")===-1?"http://twitter.com/"+t.title:t.title;t.title=t.title.indexOf("twitter.com")!==-1?t.title.substring(t.title.lastIndexOf("/")):t.title;break;case l.facebook.name:t.val=t.title.indexOf("facebook.com")===-1?"http://facebook.com/"+t.title:t.title;t.title=t.title.indexOf("facebook.com")!==-1?t.title.substring(t.title.lastIndexOf("/")+1):t.title;break;case l.skype.name:t.istop=!0;t.val="skype:"+t.title+"?call";case l.jabber.name:case l.msn.name:case l.aim.name:case l.telegram.name:break;case l.icq.name:t.val="http://www.icq.com/people/"+t.title;break;case l.yahoo.name:case l.gmail.name:case l.gtalk.name:t.istop=!0;t.val="mailto:"+t.title;break;case l.blogger.name:t.val=t.title.indexOf("blogger.com")===-1?"http://"+t.title+".blogger.com/":t.title;break;case l.myspace.name:t.val=t.title.indexOf("myspace.com")===-1?"http://myspace.com/"+t.title:t.title;t.title=t.title.indexOf("myspace.com")!==-1?t.title.substring(t.title.lastIndexOf("/")+1):t.title;break;case l.livejournal.name:t.val=t.title.indexOf("livejournal.com")===-1?"http://"+t.title+".livejournal.com/":t.title;break;default:t.val=t.title}switch(t.type){case 0:r.mailboxes.push(t);break;case 1:r.telephones.push(t);break;case 2:r.links.push(t);break;case-1:r.links.push(t)}}return r}function hi(n,t,i,r,u,f){var e;switch(t){case"d":return n.getDate();case"dd":return a(n.getDate());case"ddd":return i[n.getDay()];case"dddd":return r[n.getDay()];case"h":return e=n.getHours(),e>12?e-12:e===0?12:e;case"hh":return e=n.getHours(),a(e>12?e-12:e===0?12:e);case"H":return n.getHours();case"HH":return a(n.getHours());case"m":return n.getMinutes();case"mm":return a(n.getMinutes());case"M":return n.getMonth()+1;case"MM":return a(n.getMonth()+1);case"MMM":return u[n.getMonth()];case"MMMM":return f[n.getMonth()];case"s":return n.getSeconds();case"ss":return a(n.getSeconds());case"t":return n.getHours()<12?"A":"P";case"tt":return n.getHours()<12?"AM":"PM";case"y":return n.getYear()-100;case"yy":return(n.getYear()%100<10?"0":"")+n.getYear()%100;case"yyy":return(n.getYear()%100<10?"0":"")+n.getYear()%100;case"yyyy":return n.getFullYear()}return""}function vt(n){if(!n)return null;return{type:"group",id:n.id,name:n.name,manager:n.manager||"",title:n.title||n.name,members:n.hasOwnProperty("members")?li(n.members):null}}function or(n){if(!n)return[];for(var t=null,u=[],i=lt(n)?n:[n],r=0,r=i?i.length:0;r--;)t=vt(i[r]),t?u.unshift(t):null;return u}function h(n){var u;if(!n)return null;n.hasOwnProperty("email")&&n.hasOwnProperty("contacts")&&(u={type:"mail",value:n.email},n.contacts=n.contacts==null?[u]:[u].concat(n.contacts));var t=r(n.created||n.workFrom||n.workFromDate),i=r(n.terminated||n.terminatedDate),h=r(n.birthday),s=n.displayName||n.firstName+" "+n.lastName,f=rr(n.contacts);return{index:s.charAt(0).toLowerCase(),type:"person",id:n.id,timestamp:t?t.getTime():0,crtdate:t,displayCrtdate:e(t),displayDateCrtdate:o(t),displayTimeCrtdate:c(t),trtdate:i,displayTrtdate:e(i),displayDateTrtdate:o(i),displayTimeTrtdate:c(i),birthday:h,birthdayApiString:n.birthday||"",userName:n.userName||"",firstName:n.firstName||"",lastName:n.lastName||"",displayName:s||"",email:n.email||"",tel:f.telephones.length>0?f.telephones[0].val:"",contacts:f,avatar:n.avatar||n.avatarSmall||st,avatarBig:n.avatarBig,avatarSmall:n.avatarSmall||ht,groups:or(n.groups||[]),status:n.status||0,activationStatus:n.activationStatus||0,isActivated:ri.activated.id===(n.activationStatus||0),isPending:ri.pending.id===(n.activationStatus||0),isTerminated:typeof n.isTerminated!="undefined"?n.isTerminated:ki.terminated.id===(n.status||0),isMe:v?v.id===n.id:!1,isManager:!1,isPortalOwner:typeof n.isOwner!="undefined"?n.isOwner:null,isAdmin:typeof n.isAdmin!="undefined"?n.isAdmin:null,listAdminModules:typeof n.listAdminModules!="undefined"?n.listAdminModules:[],isVisitor:typeof n.isVisitor!="undefined"?n.isVisitor:null,isOutsider:typeof n.isOutsider!="undefined"?n.isOutsider:null,sex:n.sex||"",location:n.location||"",title:n.title||"",notes:n.notes||"",culture:n.cultureName||"",profileUrl:n.profileUrl||"",isLDAP:typeof n.isLDAP!="undefined"?n.isLDAP:typeof n.isldap!="undefined"?n.isldap:!1,isSSO:typeof n.isSSO!="undefined"?n.isSSO:typeof n.issso!="undefined"?n.issso:!1}}function li(n){if(!n)return[];for(var t=null,u=[],i=lt(n)?n:[n],r=0,r=i?i.length:0;r--;)t=h(i[r]),t?u.unshift(t):null;return u}var pt=!1,yi=!1,st="",wt="",ht="",tt=null,p=null,b=null,ot={datetime:tt,date:p,time:b},k=[],d=[],g=[],nt=[],rt={days:g,shortdays:nt,months:k,shortmonths:d},it=0,bt="",kt="",v={},dt={},gt={},f="post",u="get",y="delete",w="put",ni=[],ti=[],ii=[],pi=[{id:-1,label:"unknown"},{id:0,label:"project"},{id:1,label:"milestone"},{id:2,label:"task"},{id:3,label:"subtask"},{id:4,label:"team"},{id:5,label:"comment"},{id:6,label:"discussion"},{id:7,label:"file"},{id:8,label:"timespend"},{id:9,label:"activity"}],wi=[{id:0,name:"DEFAULT",label:"folder-default"},{id:1,name:"COMMON",label:"folder-common"},{id:2,name:"BUNCH",label:"folder-bunch"},{id:3,name:"TRASH",label:"folder-trash"},{id:5,name:"USER",label:"folder-user"},{id:6,name:"SHARE",label:"folder-shared"}],l={mail:{name:"mail",type:0,title:"Email"},facebook:{name:"facebook",type:2,title:"FaceBook"},myspace:{name:"myspace",type:2,title:"MySpace"},livejournal:{name:"livejournal",type:2,title:"LiveJournal"},twitter:{name:"twitter",type:2,title:"twitter"},yahoo:{name:"yahoo",type:2,title:"YAHOO"},jabber:{name:"jabber",type:2,title:"Jabber"},blogger:{name:"blogger",type:2,title:"blogger"},skype:{name:"skype",type:2,title:"skype"},msn:{name:"msn",type:2,title:"msn"},aim:{name:"aim",type:2,title:"aim"},telegram:{name:"telegram",type:2,title:"telegram"},icq:{name:"icq",type:2,title:"icq"},gmail:{name:"gmail",type:0,title:"Google Mail"},gbuzz:{name:"gbuzz",type:2,title:"Google Buzz"},gtalk:{name:"gtalk",type:2,title:"Google Talk"},phone:{name:"phone",type:1,title:"Tel"},mobphone:{name:"mobphone",type:1,title:"Mobile"},extmobphone:{name:"extmobphone",type:1,title:"Mobile"},extmail:{name:"extmail",type:0,title:"Email"}},ut={phone:{id:0,title:"Phone",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},mobile:{id:2,title:"Mobile"},fax:{id:3,title:"Fax"},direct:{id:4,title:"Direct"},other:{id:5,title:"Other"}}},email:{id:1,title:"Email",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},website:{id:2,title:"Website",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},skype:{id:3,title:"Skype",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},twitter:{id:4,title:"Twitter",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},linkedin:{id:5,title:"LinkedIn",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},facebook:{id:6,title:"Facebook",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},address:{id:7,title:"Address",categories:{home:{id:0,title:"Home"},postal:{id:1,title:"Postal"},office:{id:2,title:"Office"},billing:{id:3,title:"Billing"},other:{id:4,title:"Other"},work:{id:5,title:"Work"}}},livejournal:{id:8,title:"LiveJournal",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},myspace:{id:9,title:"MySpace",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},gmail:{id:10,title:"GMail",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},blogger:{id:11,title:"Blogger",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},yahoo:{id:12,title:"Yahoo",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},msn:{id:13,title:"MSN",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},icq:{id:14,title:"ICQ",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},jabber:{id:15,title:"Jabber",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},aim:{id:16,title:"AIM",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}},telegram:{id:17,title:"Telegram",categories:{home:{id:0,title:"Home"},work:{id:1,title:"Work"},other:{id:2,title:"Other"}}}},bi=[{name:"archive",exts:[".zip",".rar",".ace",".arc",".arj",".cab",".enc",".jar",".lha",".lzh",".pak",".pk3",".tar",".tgz",".uue",".xxe",".zoo",".bh",".gz",".ha"]},{name:"image",exts:[".bmp",".cod",".gif",".ief",".jpe",".jpg",".tif",".cmx",".ico",".pnm",".pbm",".ppm",".psd",".rgb",".xbm",".xpm",".xwd",".png",".ai",".jpeg"]},{name:"sound",exts:[".mp3",".wav",".pcm",".3gp",".fla",".cda",".ogg",".aiff",".flac"]},{name:"ebook",exts:[".fb2",".ibk",".prc",".epub"]},{name:"html",exts:[".htm",".mht",".html"]},{name:"djvu",exts:[".djvu"]},{name:"svg",exts:[".svg"]},{name:"svgt",exts:[".svgt"]},{name:"doc",exts:[".doc",".docx"]},{name:"doct",exts:[".doct"]},{name:"xls",exts:[".xls",".xlsx"]},{name:"xlst",exts:[".xlst"]},{name:"pps",exts:[".pps",".ppsx"]},{name:"ppt",exts:[".ppt",".pptx"]},{name:"pptt",exts:[".pptt"]},{name:"odp",exts:[".odp"]},{name:"ods",exts:[".ods"]},{name:"odt",exts:[".odt"]},{name:"pdf",exts:[".pdf"]},{name:"rtf",exts:[".rtf"]},{name:"txt",exts:[".txt"]},{name:"iaf",exts:[".iaf"]},{name:"csv",exts:[".csv"]},{name:"xml",exts:[".xml"]},{name:"xps",exts:[".xps",".oxps"]},{name:"avi",exts:[".avi"]},{name:"flv",exts:[".flv",".fla"]},{name:"m2ts",exts:[".m2ts"]},{name:"mkv",exts:[".mkv"]},{name:"mov",exts:[".mov"]},{name:"mp4",exts:[".mp4"]},{name:"mpg",exts:[".mpg"]},{name:"vob",exts:[".vob"]}],ki={active:{id:1,name:"active"},terminated:{id:2,name:"terminated"},leaveofabsence:{id:4,name:"leaveofabsence"}},ri={notactivated:{id:0,name:"notactivated"},activated:{id:1,name:"activated"},pending:{id:2,name:"pending"}},ct={notaccept:{id:0,name:"notaccept"},open:{id:1,name:"open"},closed:{id:2,name:"closed"},disable:{id:3,name:"disable"},unclassified:{id:4,name:"unclassified"},notinmilestone:{id:5,name:"notinmilestone"}},ui={None:"0",ReadWrite:"1",Read:"2",Restrict:"3"},ft=[n("cmt-blog",/blog\.json/,f),n("cmt-blog",/blog\/[\w\d-]+\.json/),n("cmt-topic",/forum\/topic\/[\w\d-]+\.json/),n("cmt-event",/event\/[\w\d-]+\.json/),n("cmt-event",/event\.json/,f),n("cmt-bookmark",/bookmark\/[\w\d-]+\.json/),n("cmt-bookmark",/bookmark\.json/,f),n("cmt-blogs",/blog\.json/,u),n("cmt-blogs",/blog\/@search\/.+\.json/,u),n("cmt-topics",/forum\/topic\/recent\.json/),n("cmt-topics",/forum\/@search\/.+\.json/,u),n("cmt-categories",/forum\.json/),n("cmt-events",/event\.json/,u),n("cmt-events",/event\/@search\/.+\.json/,u),n("cmt-bookmarks",/bookmark\/top\/recent\.json/,u),n("cmt-bookmarks",/bookmark\/@search\/.+\.json/,u),n("prj-task",/project\/[\w\d-]+\/task\.json/,f),n("prj-task",/project\/task\/[\w\d-]+\.json/),n("prj-task",/project\/task\/[\w\d-]+\/status\.json/),n("prj-task",/project\/task\/[\w\d-]+\/copy\.json/),n("prj-task",/project\/task\/[\w\d-]+\/milestone\.json/),n("prj-tasks",/project\/[\w\d-]+\/task\.json/,u),n("prj-tasks",/project\/[\w\d-]+\/task\/@self\.json/),n("prj-tasks",/project\/[\w\d-]+\/task\/filter\.json/),n("prj-tasks",/project\/task\/filter\.json/),n("prj-tasks",/project\/task\.json\?taskid/),n("prj-tasks",/project\/task\/status\.json/),n("prj-tasks",/project\/task\/milestone\.json/),n("prj-tasks",/project\/task\.json/,y),n("prj-simpletasks",/project\/task\/filter\/simple\.json/,u),n("prj-tasks",/project\/task\/@self\.json/),n("prj-subtask",/project\/task\/[\d]+\.json/,f),n("prj-subtask",/project\/task\/[\d]+\/[\d]+\/copy\.json/),n("prj-subtask",/project\/task\/[\d]+\/[\d]+\.json/),n("prj-subtask",/project\/task\/[\d]+\/[\d]+\/status\.json/),n("prj-subtask",/project\/task\/[\d]+\/[\d]+\/move\.json/),n("prj-milestone",/project\/milestone\/[\w\d-]+\.json/),n("prj-milestone",/project\/[\w\d-]+\/milestone\.json/,f),n("prj-milestones",/project\/[\w\d-]+\/milestone\.json/,u),n("prj-milestones",/project\/milestone\/[\w\d-]+\/[\w\d-]+\/[\w\d-]+\.json/),n("prj-milestones",/project\/milestone\/[\w\d-]+\/[\w\d-]+\.json/),n("prj-milestones",/project\/milestone\/late\.json/),n("prj-milestones",/project\/milestone\.json/),n("prj-milestones",/project\/milestone\/filter\.json/),n("prj-milestone",/project\/milestone\/[\w\d-]+\/status\.json/),n("prj-discussion",/project\/message\/[\w\d-]+\.json/),n("prj-discussion",/project\/[\w\d-]+\/message\.json/,f),n("prj-discussions",/project\/message\.json/),n("prj-discussions",/project\/[\w\d-]+\/message\.json/,u),n("prj-discussions",/project\/message\/filter\.json/),n("prj-project",/project\/[\d-]+\.json/,u),n("prj-project",/project\/[\d-]+\/status\.json/,w),n("prj-project",/project\/[\w\d-]+\/contact\.json/,f),n("prj-project",/project\/[\w\d-]+\/contact\.json/,y),n("prj-projects",/project[\/]*[@self|@follow]*\.json/),n("prj-projects",/project\/filter\.json/),n("prj-projects",/project\/contact\/[\w\d-]+\.json/),n("prj-searchentries",/project\/@search\/.+\.json/),n("prj-projectperson",/project\/[\w\d-]+\/team\.json/,f),n("prj-projectperson",/project\/[\w\d-]+\/team\.json/,y),n("prj-projectpersons",/project\/[\w\d-]+\/team\.json/,u),n("prj-projectpersons",/project\/[\w\d-]+\/teamExcluded\.json/,u),n("prj-timespend",/project\/time\/[\w\d-]+\.json/),n("prj-timespends",/project\/time\/times\/status\.json/,w),n("prj-timespends",/project\/time\/filter\.json/,u),n("prj-timespends",/project\/task\/[\w\d-]+\/time\.json/,u),n("prj-activities",/project\/activities\/filter\.json/),n("prj-project",/project\.json/,f),n("doc-folder",/files\/[@\w\d-]+\.json/),n("doc-folder",/files\/[\w\d-]+\/[text|html|file]+\.json/),n("doc-folder",/project\/[\w\d-]+\/files\.json/),n("doc-files",/project\/task\/[\w\d-]+\/files\.json/),n("doc-files",/project\/[\w\d-]+\/entityfiles\.json/),n("doc-files",/crm\/[\w\d-]+\/[\w\d-]+\/files\.json/,u),n("doc-file",/files\/file\/[\w\d-]+\.json/),n("doc-file",/files\/[\w\d-]+\/upload\.xml/),n("doc-file",/files\/[\w\d-]+\/upload\.json/),n("doc-session",/files\/[\w\d-]+\/upload\/create_session\.json/),n("doc-file",/crm\/files\/[\w\d-]+\.json/),n("doc-file",/crm\/[case|contact|opportunity]+\/[\w\d-]+\/files\/upload\.xml/),n("doc-file",/crm\/[case|contact|opportunity]+\/[\w\d-]+\/files\/upload\.json/),n("doc-file",/crm\/[case|contact|opportunity]+\/[\w\d-]+\/files\/text\.json/),n("doc-miss",/files\/fileops.json/),n("doc-miss",/files\/storeoriginal.json/),n("doc-miss",/files\/hideconfirmconvert.json/),n("doc-miss",/files\/displayfavorite.json/),n("doc-miss",/files\/displayrecent.json/),n("doc-miss",/files\/displaytemplates.json/),n("doc-check",/files\/docservice.json/),n("crm-addresses",/crm\/contact\/[\w\d-]+\/data\.json/,u),n("crm-address",/crm\/contact\/[\w\d-]+\/data\/[\w\d-]+\.json/),n("crm-address",/crm\/contact\/[\w\d-]+\/data\.json/,f),n("crm-address",/crm\/contact\/[\w\d-]+\/batch\.json/),n("crm-contact",/crm\/contact\/[\w\d-]+\.json/),n("crm-contact",/crm\/contact\/company\/[\w\d-]+\/type\.json/,f),n("crm-contact",/crm\/contact\/company\/[\w\d-]+\/person\.json/,f),n("crm-contact",/crm\/contact\/company\/[\w\d-]+\/person\.json/,y),n("crm-contact",/crm\/[case|opportunity]+\/[\w\d-]+\/contact\.json/,f),n("crm-contact",/crm\/[case|opportunity]+\/[\w\d-]+\/contact\/[\w\d-]+\.json/,f),n("crm-contact",/crm\/[case|opportunity]+\/[\w\d-]+\/contact\/[\w\d-]+\.json/),n("crm-contacts",/crm\/contact\/bycontactinfo\.json/,u),n("crm-contact",/crm\/contact\/merge\.json/),n("crm-socialmediaavatars",/crm\/contact\/socialmediaavatar\.json/),n("crm-tweets",/crm\/contact\/[\w\d-]+\/tweets\.json/),n("crm-twitterprofiles",/crm\/contact\/twitterprofile\.json/),n("crm-progressitem",/crm\/contact\/mailsmtp\/send\.json/),n("crm-progressitem",/crm\/contact\/mailsmtp\/status\.json/),n("crm-progressitem",/crm\/contact\/mailsmtp\/cancel\.json/),n("crm-progressitem",/crm\/[contact|person|company|opportunity|case]+\/import\/status\.json/),n("crm-progressitem",/crm\/contact\/export\/status\.json/),n("crm-progressitem",/crm\/contact\/export\/cancel\.json/),n("crm-progressitem",/crm\/contact\/export\/start\.json/),n("crm-exportitem",/crm\/export\/partial\/status\.json/),n("crm-exportitem",/crm\/export\/partial\/cancel\.json/),n("crm-exportitem",/crm\/export\/partial\/[\w\d-]+\/start\.json/),n("crm-fileuploadresult",/crm\/import\/uploadfake\.json/),n("crm-task",/crm\/task\.json/),n("crm-task",/crm\/task\/[\w\d-]+\.json/),n("crm-task",/crm\/task\/[\w\d-]+\/close\.json/),n("crm-task",/crm\/task\/[\w\d-]+\/reopen\.json/),n("crm-opportunity",/crm\/opportunity\/[\w\d-]+\.json/),n("crm-opportunity",/crm\/opportunity\/[\w\d-]+\/stage\/[\w\d-]+\.json/),n("crm-opportunity",/crm\/contact\/[\w\d-]+\/opportunity\/[\w\d-]+\.json/),n("crm-dealmilestone",/crm\/opportunity\/stage\/[\w\d-]+\.json/),n("crm-dealmilestone",/crm\/opportunity\/stage\/[\w\d-]+\/color\.json/),n("crm-dealmilestone",/crm\/opportunity\/stage\.json/,f),n("crm-dealmilestones",/crm\/opportunity\/stage\/reorder\.json/),n("crm-dealmilestones",/crm\/opportunity\/stage\.json/,u),n("crm-contactstatus",/crm\/contact\/status\/[\w\d-]+\/color\.json/),n("crm-contactstatus",/crm\/contact\/status\/[\w\d-]+\.json/),n("crm-contactstatus",/crm\/contact\/status\.json/,f),n("crm-contactstatuses",/crm\/contact\/status\/reorder\.json/),n("crm-contactstatuses",/crm\/contact\/status\.json/,u),n("crm-contacttypekind",/crm\/contact\/type\/[\w\d-]+\.json/),n("crm-contacttypekind",/crm\/contact\/type\.json/,f),n("crm-contacttypekinds",/crm\/contact\/type\/reorder\.json/),n("crm-contacttypekinds",/crm\/contact\/type\.json/,u),n("crm-customfield",/crm\/[contact|person|company|opportunity|case]+\/customfield\/[\w\d-]+\.json/),n("crm-customfield",/crm\/[contact|person|company|opportunity|case]+\/customfield\.json/),n("crm-customfields",/crm\/[contact|person|company|opportunity|case]+\/customfield\/definitions\.json/),n("crm-customfields",/crm\/[contact|person|company|opportunity|case]+\/customfield\/reorder\.json/),n("crm-tag",/crm\/[case|contact|opportunity]+\/tag\.json/),n("crm-tag",/crm\/[case|contact|opportunity]+\/taglist\.json/),n("crm-tag",/crm\/[case|contact|opportunity]+\/[\w\d-]+\/tag\.json/),n("crm-tags",/crm\/[case|contact|opportunity]+\/tag\/unused\.json/),n("crm-tags",/crm\/[case|contact|opportunity]+\/tag\/[\w\d-]+\.json/),n("crm-fulltags",/crm\/[case|contact|opportunity]+\/tag\.json/,u),n("crm-caseitem",/crm\/case\/[\w\d-]+\/close\.json/),n("crm-caseitem",/crm\/case\/[\w\d-]+\/reopen\.json/),n("crm-cases",/crm\/cases\.json/),n("crm-cases",/crm\/case\/filter\.json/),n("crm-cases",/crm\/case\/byprefix\.json/),n("crm-contacts",/crm\/contact\.json/),n("crm-contacts",/crm\/contact\/project\/[\w\d-]+\.json/),n("crm-basecontacts",/crm\/contact\/byprefix\.json/),n("crm-contacts",/crm\/contact\/filter\.json/),n("crm-simplecontacts",/crm\/contact\/simple\/filter\.json/),n("crm-basecontacts",/crm\/contact\/mail\.json/),n("crm-contacts",/crm\/contact\/company\/[\w\d-]+\/person\.json/,u),n("crm-contacts",/crm\/[case|opportunity]+\/[\w\d-]+\/contact\.json/,u),n("crm-contacts",/crm\/contact\/access\.json/),n("crm-contacts",/crm\/contact\/[\w\d-]+\/access\.json/,w),n("crm-cases",/crm\/case\/access\.json/),n("crm-cases",/crm\/case\/[\w\d-]+\/access\.json/),n("crm-opportunities",/crm\/opportunity\/access\.json/),n("crm-opportunities",/crm\/opportunity\/[\w\d-]+\/access\.json/),n("crm-tasks",/crm\/task\/filter\.json/),n("crm-opportunities",/crm\/opportunity\/filter\.json/),n("crm-opportunities",/crm\/opportunity\/bycontact\/[\w\d-]+\.json/),n("crm-opportunities",/crm\/opportunity\/byprefix\.json/),n("crm-taskcategory",/crm\/task\/category\/[\w\d-]+\.json/),n("crm-taskcategory",/crm\/task\/category\/[\w\d-]+\/icon\.json/),n("crm-taskcategory",/crm\/task\/category\.json/,f),n("crm-taskcategories",/crm\/task\/category\/reorder\.json/),n("crm-taskcategories",/crm\/task\/category\.json/,u),n("crm-historyevent",/crm\/history\.json/),n("crm-historyevent",/crm\/history\/[\w\d-]+.json/),n("crm-historyevent",/crm\/[contact|opportunity|case]+\/[\w\d-]+\/files\.json/,f),n("crm-historyevents",/crm\/history\/filter\.json/),n("crm-historycategory",/crm\/history\/category\/[\w\d-]+\.json/),n("crm-historycategory",/crm\/history\/category\/[\w\d-]+\/icon\.json/),n("crm-historycategory",/crm\/history\/category\.json/,f),n("crm-historycategories",/crm\/history\/category\/reorder\.json/),n("crm-historycategories",/crm\/history\/category\.json/,u),n("crm-currency",/crm\/settings\/currency\.json/),n("crm-currencies",/crm\/settings\/currency\.json/,u),n("crm-smtpsettings",/crm\/settings\/smtp\.json/),n("crm-rootfolder",/crm\/files\/root\.json/),n("crm-tasktemplatecontainer",/crm\/[contact|person|company|opportunity|case]+\/tasktemplatecontainer\.json/),n("crm-tasktemplatecontainer",/crm\/tasktemplatecontainer\/[\w\d-]+\.json/),n("crm-tasktemplate",/crm\/tasktemplatecontainer\/[\w\d-]+\/tasktemplate\.json/),n("crm-tasktemplate",/crm\/tasktemplatecontainer\/tasktemplate\/[\w\d-]+\.json/),n("crm-invoiceline",/crm\/invoiceline\.json/),n("crm-invoiceline",/crm\/invoice\/[\w\d-]+\.json/),n("crm-invoice",/crm\/invoice\.json/,f),n("crm-invoice",/crm\/invoice\/[\w\d-]+\.json/),n("crm-invoice",/crm\/invoice\/sample\.json/),n("crm-invoice",/crm\/invoice\/sample\.json/),n("crm-invoice",/crm\/invoice\/bynumber\.json/),n("crm-invoiceJsonData",/crm\/invoice\/jsondata\/[\w\d-]+\.json/),n("crm-invoices",/crm\/invoice\.json/,y),n("crm-invoicesAndItems",/crm\/invoice\/status\/[\w\d-]+\.json/),n("crm-invoices",/crm\/invoice\/filter\.json/),n("crm-invoices",/crm\/[contact|person|company|opportunity]+\/invoicelist\/[\w\d-]+\.json/),n("crm-invoiceItem",/crm\/invoiceitem\.json/,f),n("crm-invoiceItems",/crm\/invoiceitem\.json/,y),n("crm-invoiceItems",/crm\/invoiceitem\/filter\.json/),n("crm-invoiceTax",/crm\/invoice\/tax\/[\w\d-]+\.json/),n("crm-invoiceTax",/crm\/invoice\/tax\.json/,f),n("crm-invoiceTaxes",/crm\/invoice\/tax\.json/,u),n("crm-invoiceSettings",/crm\/invoice\/settings\.json/),n("crm-invoiceSettings",/crm\/invoice\/settings\/name\.json/),n("crm-invoiceSettings",/crm\/invoice\/settings\/terms\.json/),n("doc-file",/crm\/invoice\/[\w\d-]+\/pdf\.json/),n("crm-converterData",/crm\/invoice\/converter\/data\.json/),n("crm-currencyRates",/crm\/currency\/rates\.json/,u),n("crm-currencyRate",/crm\/currency\/rates\/[\w\d-]+\.json/),n("crm-currencyRate",/crm\/currency\/rates\/\w{3}\/\w{3}\.json/,u),n("crm-currencyRate",/crm\/currency\/rates\.json/,f),n("crm-voipNumbers",/crm\/voip\/numbers\/available\.json/),n("crm-voipNumbers",/crm\/voip\/numbers\/existing\.json/),n("crm-voipNumber",/crm\/voip\/numbers\.json/,f),n("crm-voipNumber",/crm\/voip\/numbers\/current\.json/),n("crm-voipCall",/crm\/voip\/call\.json/,f),n("crm-voipCalls",/crm\/voip\/call\.json/,u),n("crm-voipCall",/crm\/voip\/call\/[\w\d-]+\.json/,u),n("crm-voipCalls",/crm\/voip\/call\/missed\.json/,u),n("authentication",/authentication\.json/),n("settings",/settings\.json/),n("security",/settings\/security\.json/),n("access",/settings\/security\/access\.json/),n("administrator",/settings\/security\/administrator\.json/),n("quotas",/settings\/quota\.json/),n("profile",/people\/[\w\d-]+\.json/),n("isme",/people\/@self\.json/),n("profiles",/people\/status\/[\w\d-]+\.json/),n("profiles",/people\/status\/[\w\d-]+\/@search\/.+\.json/),n("profiles",/people\/status\/[\w\d-]+\/search\.json/),n("profiles",/people\.json/),n("profiles",/people\/@search\/.+\.json/),n("profiles",/people\/search\.json/),n("profiles",/people\/filter\.json/),n("profiles",/people\/type\/[\w\d-]+\.json/),n("profiles",/people\/invite\.json/),n("text",/people\/password\.json/),n("text",/people\/thirdparty\/linkaccount\.json/),n("text",/people\/thirdparty\/unlinkaccount\.json/),n("group",/group\/[\w\d-]+\.json/),n("groups",/group\.json/),n("crm-tasks",/crm\/contact\/task\/group\.json/),n("crm-tag",/crm\/[company|person]+\/[\w\d-]+\/tag\/group\.json/),n("crm-voipNumber",/crm\/voip\/numbers\/[\w]+\/settings.json/,w),n("crm-voipSettings",/crm\/voip\/numbers\/settings.json/),n("comment",/comment\.json/,f),n("comments",/comment\.json/,u),n("prj-settings",/project\/settings\.json/),n("prj-report",/project\/report\/files\.json/),n("text",/project\/comment\/[\w\d-]+\.json/,y),n("text",/community\/wiki\/comment\/[\w\d-]+\.json/,y),n("text",/community\/event\/comment\/[\w\d-]+\.json/,y),n("text",/community\/bookmark\/comment\/[\w\d-]+\.json/,y),n("text",/community\/blog\/comment\/[\w\d-]+\.json/,y),n("text",/project\/comment\/[\w\d-]+\.json/,w),n("text",/community\/wiki\/comment\/[\w\d-]+\.json/,w),n("text",/community\/event\/comment\/[\w\d-]+\.json/,w),n("text",/community\/bookmark\/comment\/[\w\d-]+\.json/,w),n("text",/community\/blog\/comment\/[\w\d-]+\.json/,w),n("text",/project\/message\/discussion\/preview\.json/),n("commentinlist",/project\/message\/preview\.json/),n("commentinlist",/community\/wiki\/comment\/preview\.json/),n("commentinlist",/community\/event\/comment\/preview\.json/),n("commentinlist",/community\/bookmark\/comment\/preview\.json/),n("commentinlist",/community\/blog\/comment\/preview\.json/),n("commentinlist",/project\/comment\.json/,f),n("commentinlist",/community\/wiki\/comment\.json/,f),n("commentinlist",/community\/event\/comment\.json/,f),n("commentinlist",/community\/bookmark\/comment\.json/,f),n("commentinlist",/community\/blog\/comment\.json/,f),n("feed-feeds",/feed\/filter\.json/),n("text",/crm\/[contact|opportunity|case|relationshipevent]+\/[\w\d-]+\/files\/hidden\.json/)],ur=function(n){var r,f,t,o,e,i;if(pt===!0)return undefined;if(pt=!0,n=n||{},n.hasOwnProperty("portaldatetime")&&n.portaldatetime&&typeof n.portaldatetime=="object"&&(it=n.portaldatetime.hasOwnProperty("utcoffsettotalminutes")?n.portaldatetime.utcoffsettotalminutes:it,bt=it!=0?(it>0?"+":"-")+a(Math.floor(Math.abs(it)/60))+":"+a(Math.abs(it)%60):bt,kt=n.portaldatetime.hasOwnProperty("displayname")?n.portaldatetime.displayname:kt),n.hasOwnProperty("names")&&n.names&&typeof n.names=="object"&&(k=n.names.hasOwnProperty("months")?typeof n.names.months=="object"?n.names.months:n.names.months.split(","):k,d=n.names.hasOwnProperty("shortmonths")?typeof n.names.shortmonths=="object"?n.names.shortmonths:n.names.shortmonths.split(","):d,g=n.names.hasOwnProperty("days")?typeof n.names.days=="object"?n.names.days:n.names.days.split(","):g,nt=n.names.hasOwnProperty("shortdays")?typeof n.names.shortdays=="object"?n.names.shortdays:n.names.shortdays.split(","):nt,rt.days=g,rt.shortdays=nt,rt.months=k,rt.shortmonths=d),n.hasOwnProperty("avatars")&&n.avatars&&typeof n.avatars=="object"&&(st=n.avatars.hasOwnProperty("large")?n.avatars.large:st,wt=n.avatars.hasOwnProperty("medium")?n.avatars.medium:wt,ht=n.avatars.hasOwnProperty("small")?n.avatars.small:ht),n.hasOwnProperty("formats")&&n.formats&&typeof n.formats=="object"&&(tt=n.formats.hasOwnProperty("datetime")?n.formats.datetime:tt,p=n.formats.hasOwnProperty("date")?n.formats.date:p,b=n.formats.hasOwnProperty("time")?n.formats.time:b,b&&p&&(tt=b+" "+p),ot.datetime=tt,ot.date=p,ot.time=b),n.hasOwnProperty("supportedfiles")&&n.supportedfiles&&typeof n.supportedfiles=="object"&&(r=n.supportedfiles.hasOwnProperty("imgs")?n.supportedfiles.imgs||[]:[],ni=r&&typeof r=="string"?r.split("|"):[],f=n.supportedfiles.hasOwnProperty("docs")?n.supportedfiles.docs||[]:[],ti=f&&typeof f=="string"?f.split("|"):[],ii=[].concat(ni,ti)),n.hasOwnProperty("responses")&&n.responses&&typeof n.responses=="object"){t=null;o=n.responses;for(i in o)t=o[i],t&&(typeof t=="object"||typeof t=="string")&&(t=di(t),t&&(t=t.hasOwnProperty("response")?t.response:t,yt(i,u,t)))}if(n.hasOwnProperty("contacttitles")&&n.contacttitles&&typeof n.contacttitles=="object"){e=n.contacttitles;for(i in e)e.hasOwnProperty(i)&&l.hasOwnProperty(i)&&(l[i].title=e[i])}},fr=function(n){var t,i;if(!n||typeof n!="object")return n;t=null;for(i in n)if(n.hasOwnProperty(i)){t=n[i];switch(typeof t){case"string":switch(i.toLowerCase()){case"infotype":ut.hasOwnProperty(t)&&(n.hasOwnProperty("category")&&typeof n.category=="string"&&ut[t].categories.hasOwnProperty(n.category)&&(n.category=ut[t].categories[n.category].id),t=ut[t].id)}}n[i]=t}return n},si=function(n){var i=0,t,r;return n.indexOf("Z")===-1&&(i=n.substring(n.length-5).split(":"),i=(+i[0]*60+ +i[1])*(n.charAt(n.length-6,1)==="+"?1:-1)),t=n.split(".")[0].split("T"),t[0]=t[0].split("-"),t[1]=t[1].split(":"),r=new Date(t[0][0],t[0][1]-1,t[0][2],t[1][0],t[1][1],t[1][2],0),new Date(r.getTime()-i*6e4)},r=function(){return!1&&new Date(Date.parse("1970-01-01T00:00:00.000Z")).getTime()===new Date(Date.parse("1970-01-01T00:00:00.000Z")).getTime()?function(n,t){if(!n)return null;var i=null,r=n&&typeof n=="object"&&n.hasOwnProperty("utc")&&n.utc||n,u=n&&typeof n=="object"&&n.hasOwnProperty("offset")&&isFinite(+n.offset)&&+n.offset||0;return typeof r!="string"?null:(i=new Date(Date.parse(r)),t!==!0&&i instanceof Date&&i.setMinutes(i.getMinutes()-(new Date).getTimezoneOffset()),i instanceof Date?i:null)}:function(n,t){if(!n)return null;var i=null,r=n&&typeof n=="object"&&n.hasOwnProperty("utc")&&n.utc||n,u=n&&typeof n=="object"&&n.hasOwnProperty("offset")&&isFinite(+n.offset)&&+n.offset||0;return typeof r!="string"?null:(u=0,r.indexOf("Z")===-1&&(u=r.substring(r.length-5).split(":"),u=(+u[0]*60+ +u[1])*(r.charAt(r.length-6,1)==="+"?1:-1)),i=r.split(".")[0].split("T"),i[0]=i[0].split("-"),i[1]=i[1].split(":"),typeof t!="undefined"&&t!==!0?i=new Date(i[0][0],i[0][1]-1,i[0][2],i[1][0],i[1][1],i[1][2],0):(i=new Date(Date.UTC(+i[0][0],+i[0][1]-1,+i[0][2],+i[1][0],+i[1][1],+i[1][2],0)),i.setMinutes(i.getMinutes()+i.getTimezoneOffset())),t!==!0&&i instanceof Date,i instanceof Date?i:null)}}(),er=function(n,t){var i=n instanceof Date?""+[n.getFullYear(),a(n.getMonth()+1),a(n.getDate())].join("-")+"T"+[a(n.getHours()),a(n.getMinutes()),a(n.getSeconds())].join(":"):"";return t===!0?i.replace(/:/g,"-"):i},et=function(n,t,i,r,u,f){var e,c;if(!(n instanceof Date)||n.getTime()<0||typeof t!="string"||t.length===0)return"";var s="",o="",h=!1;for(t=t.split(""),e=0,c=t.length;e<c;e++){h=!1;switch(t[e]){case"d":case"h":case"H":case"m":case"M":case"s":case"t":case"y":o+=t[e];break;default:h=!0}h&&(s+=hi(n,o,i,r,u,f),s+=t[e],o="")}return o&&(s+=hi(n,o,i,r,u,f)),s},c=function(n){return n&&b?et(n,b,nt,g,d,k):n?n.toLocaleTimeString():""},o=function(n){return n&&p?et(n,p,nt,g,d,k):n?n.toLocaleDateString():""},ci=function(n){if(n&&p){var t=p;return t.match(/.yyyy/g)?t=t.replace(/.yyyy/,""):t.match(/yyyy./g)&&(t=t.replace(/yyyy./,"")),et(n,t,nt,g,d,k)}return n?n.toLocaleDateString([],{day:"numeric",month:"2-digit"}):""},e=function(n){return n&&tt?et(n,tt,nt,g,d,k):n?n.toLocaleTimeString()+" "+n.toLocaleDateString():""},sr=function(n){if(n.length===0)return n;for(var t=ei(n),u=null,i=0,r=0,i=t?t.length:0;i--;)if(u=t[i].parentId,t[i].comments||(t[i].comments=[]),u!==null)for(r=t.length;r--;)if(t[r].id==u){t[r].comments||(t[r].comments=[]);t[r].comments.unshift(t[i]);break}for(i=t?t.length:0;i--;)t[i].parentId!==null&&t.splice(i,1);return t?t:n},ai=function(n){var t=r(n.created),i;return uptdate=r(n.updated),createdBy=h(n.createdBy),i={type:"comment",id:n.id,inactive:n.hasOwnProperty("inactive")?n.inactive:!1,parentId:n.parentId==="00000000-0000-0000-0000-000000000000"?null:n.parentId||null,timestamp:t?t.getTime():0,crtdate:t,displayCrtdate:e(t),displayDateCrtdate:o(t),displayTimeCrtdate:c(t),displayDatetimeCrtdate:e(t),uptdate:uptdate,displayUptdate:e(uptdate),displayDateUptdate:o(uptdate),displayTimeUptdate:c(uptdate),displayDatetimeUptdate:e(uptdate),createdBy:createdBy,updatedBy:h(n.updatedBy||n.createdBy),isMine:v&&createdBy&&v.id==createdBy.id||!1,comments:[],text:n.text||""},n.hasOwnProperty("canEdit")&&(i.canEdit=n.canEdit),i},vi=function(n){for(var r=[],t=lt(n)?n:[n],i=0,i=t?t.length:0;i--;)r.unshift(ai(t[i]));return sr(r)},hr=function(n){if(!n)return null;for(var f=0,u=0,t=0,e=[],i=n.votes,r=0,r=i?i.length:0;r--;)t=i[r].votes,u+=t,f<t&&(f=t);for(r=i?i.length:0;r--;)t=i[r].votes,e.unshift({title:i[r].name,count:t,percent:u!==0?Math.round(t*100/u):0,leader:f===t});return{votes:e,voted:n.voted,fullCount:u}},t={storageusage:function(n){return n},text:function(n){return n},authentication:function(n){return{token:n.token}},isme:function(n){var t=h(n);for(var i in t)t.hasOwnProperty(i)&&(v[i]=t[i]);return v.isMe=!0,v},profile:function(n){return h(n)},profiles:function(n){return i(n,h,function(){return{}})},group:function(n){return vt(n)},groups:function(n){return i(n,vt,function(){return{}})},settings:function(n){return dt={type:"settings",culture:n.culture,timezone:n.timezone,trustedDomains:n.trustedDomains,trustedDomainsType:n.trustedDomainsType,utcHoursOffset:n.utcHoursOffset,utcOffset:n.utcOffset}},quotas:function(n){return gt={type:"quotas",storageSize:n.storageSize,maxFileSize:n.maxFileSize,usedSize:n.usedSize,availableSize:n.availableSize,storageUsage:t.storageusage(n.storageUsage),maxUsersCount:n.maxUsersCount,usersCount:n.usersCount,availableUsersCount:n.availableUsersCount,userStorageSize:n.userStorageSize,userUsedSize:n.userUsedSize,userAvailableSize:n.userAvailableSize,maxVisitors:n.maxVisitors,visitorsCount:n.visitorsCount}},comment:function(n){return ai(n)},comments:function(n){return vi(n)},commentinlist:function(n){return n},searchentryitems:function(n){return i(n,null,function(n){var i=ir(n.entityType);switch(i){case"file":return t.doc.file(n);case"task":case"subtask":return t.prj.subtask(n);case"discussion":return t.prj.discussion(n);case"milestone":return t.prj.milestone(n);default:return{type:i}}})}},yt;return t.cmt={item:function(n){var t=r(n.created),i=r(n.updated);return{id:n.id,timestamp:t?t.getTime():0,crtdate:t,displayCrtdate:e(t),displayDateCrtdate:o(t),displayTimeCrtdate:c(t),displayDatetimeCrtdate:e(t),uptdate:i,displayUptdate:e(i),displayDateUptdate:o(i),displayTimeUptdate:c(i),displayDatetimeUptdate:e(i),createdBy:h(n.createdBy||n.author),updatedBy:h(n.updatedBy||n.createdBy||n.author),title:n.title||"",text:n.preview||n.text||n.description||""}},tags:function(n){return n||[]},blog:function(n){return s(this.item(n),{type:"blog",tags:t.cmt.tags(n.tags),comments:null})},poll:function(n){return s(this.item(n),{type:"poll"})},topic:function(n){var i=null;return n.posts&&n.posts.length>0&&(i=n.posts[0],n.createdBy=i.createdBy,n.text=i.text,n.posts=n.posts.slice(1)),s(this.item(n),{type:"forum",typeCode:n.type,statusCode:n.status,tags:t.cmt.tags(n.tags),threadTitle:n.threadTitle||n.threadTitile,posts:vi(n.posts||[])})},thread:function(n){return s(this.item(n),{type:"thread"})},category:function(n){return s(this.item(n),{type:"category",threads:t.cmt.threads(n.threads)})},event:function(n){var t=this.item(n);return s(t,{type:"event",typeCode:n.type,poll:hr(n.poll),comments:null})},bookmark:function(n){return s(this.item(n),{type:"bookmark",url:n.url,thumbnail:n.thumbnail,comments:null})},blogs:function(n){return i(n,this.item,function(n){return t.cmt.blog(n)})},polls:function(n){return i(n,this.item,function(n){return t.cmt.poll(n)})},topics:function(n){return i(n,this.item,function(n){return t.cmt.topic(n)})},threads:function(n){return i(n,this.item,function(n){return t.cmt.thread(n)})},categories:function(n){return n=n.hasOwnProperty("categories")?n.categories:n,i(n,this.item,function(n){return t.cmt.category(n)})},events:function(n){return i(n,this.item,function(n){return t.cmt.event(n)})},bookmarks:function(n){return i(n,this.item,function(n){return t.cmt.bookmark(n)})}},t.prj={item:function(n){var u,t,c,f=[],i,s;return u=typeof n.createdBy=="object"?h(n.createdBy):typeof n.createdById=="string"?UserManager.getPerson(n.createdById,h):h(n.author),typeof n.updatedBy=="object"?c=h(n.updatedBy):typeof n.updatedById=="string"&&(c=UserManager.getPerson(n.updatedById,h)),typeof n.responsible=="object"?t=h(n.responsible):typeof n.responsibleId=="string"&&(t=UserManager.getPerson(n.responsibleId,h)),n.responsibles?f=li(n.responsibles||n.responsible):n.responsibleIds&&(f=n.responsibleIds.map(function(n){return h(UserManager.getUser(n)||UserManager.getRemovedProfile())})),i=r(n.created),s=r(n.updated),{id:n.id,timestamp:i?i.getTime():0,crtdate:i,displayDateCrtdate:o(i),uptdate:s,displayUptdate:e(s),displayDateUptdate:o(s),createdBy:u,updatedBy:c,responsible:t||f[0],responsibles:f,canEdit:n.canEdit||!1,isPrivate:n.isPrivate||!1,isShared:n.isShared||!1,isMy:u&&v?u.id===v.id:!1,forMe:t&&v?t.id===v.id:!1,title:n.title||"",lowTitle:(n.title||"").toLowerCase(),description:n.description||"",status:n.status}},task:function(n){var i=r(n.deadline,!1),f=r(n.startDate,!1),u=new Date,l=u.getFullYear(),a=u.getMonth(),v=u.getDate(),y,h;return u=new Date(l,a,v,0,0,0,0),y=new Date(l,a,v+1,0,0,0,0),h=n.hasOwnProperty("projectOwner"),s(this.item(n),{type:"task",projectId:h?n.projectOwner.id:-1,projectTitle:h?n.projectOwner.title:"",projectOwner:n.projectOwner,canCreateSubtask:n.canCreateSubtask,canCreateTimeSpend:n.canCreateTimeSpend,canReadFiles:n.canReadFiles,canEditFiles:n.canEditFiles,canDelete:n.canDelete,deadline:i,displayDeadline:e(i),displayDateDeadline:o(i),displayTimeDeadline:c(i),startDate:f,displayStartDate:e(f),displayDateStart:o(f),displayTimeStart:c(f),status:n.status>2?1:n.status,statusname:oi(n.status>2?1:n.status),priority:n.priority,subtasks:t.prj.subtasks(n.subtasks),progress:n.hasOwnProperty("progress")?n.progress:0,milestoneId:n.milestoneId,milestoneTitle:n.hasOwnProperty("milestone")&&n.milestone?n.milestone.title:"",milestone:n.hasOwnProperty("milestone")?t.prj.milestone(n.milestone):null,deadlineToday:i?i.getTime()>=u.getTime()&&i.getTime()<y.getTime():!1,isOpened:n.status==ct.open.id,isExpired:n.isExpired||!1,links:n.hasOwnProperty("links")?t.prj.links(n.links):[],files:n.files,commentsCount:n.commentsCount,isSubscribed:n.isSubscribed,project:n.project,timeSpend:n.timeSpend,comments:n.comments?n.comments:[],canCreateComment:n.canCreateComment,customTaskStatus:n.customTaskStatus})},simpletask:function(n){var i=r(n.deadline,!1),f=r(n.startDate,!1),u=new Date,h=u.getFullYear(),c=u.getMonth(),l=u.getDate(),a;return u=new Date(h,c,l,0,0,0,0),a=new Date(h,c,l+1,0,0,0,0),s(this.item(n),{type:"task",projectOwner:n.projectOwner,canCreateSubtask:n.canCreateSubtask,canCreateTimeSpend:n.canCreateTimeSpend,canDelete:n.canDelete,createdBy:n.createdBy,updatedBy:n.updatedBy,deadline:i,displayDeadline:e(i),displayDateDeadline:o(i),startDate:f,displayStartDate:e(f),displayDateStart:o(f),responsibles:n.responsibles,status:n.status>2?1:n.status,customTaskStatus:n.customTaskStatus,statusname:oi(n.status>2?1:n.status),priority:n.priority,subtasksCount:n.subtasksCount,progress:n.hasOwnProperty("progress")?n.progress:0,milestoneId:n.milestoneId,deadlineToday:i?i.getTime()>=u.getTime()&&i.getTime()<a.getTime():!1,isOpened:n.status==ct.open.id,isExpired:n.isExpired||!1,links:n.hasOwnProperty("links")?t.prj.links(n.links):null})},milestone:function(n){var t=r(n.deadline,!1),i=new Date,u=i.getFullYear(),f=i.getMonth(),h=i.getDate(),l;return i=new Date(u,f,h,0,0,0,0),l=new Date(u,f,h+1,0,0,0,0),s(this.item(n),{type:"milestone",projectId:n.hasOwnProperty("projectOwner")?n.projectOwner.id:-1,projectTitle:n.hasOwnProperty("projectOwner")?n.projectOwner.title:"",deadline:t,displayDeadline:e(t),displayDateDeadline:o(t),displayTimeDeadline:c(t),status:n.status,deadlineToday:t?t.getTime()>=i.getTime()&&t.getTime()<l.getTime():!1,isKey:n.isKey,isNotify:n.isNotify,isExpired:n.isExpired||!1,activeTaskCount:n.activeTaskCount,closedTaskCount:n.closedTaskCount,canDelete:n.canDelete})},discussion:function(n){var t=r(n.created);return s(this.item(n),{type:"discussion",projectId:n.hasOwnProperty("projectOwner")?n.projectOwner.id:-1,projectTitle:n.hasOwnProperty("projectOwner")?n.projectOwner.title:"",projectOwner:n.projectOwner,parentId:null,comments:n.comments?n.comments:[],text:n.text||"",status:n.status,displayTimeCrtdate:c(t),displayDateTimeCrtdate:e(t),canReadFiles:n.canReadFiles,canEditFiles:n.canEditFiles,canCreateComment:n.canCreateComment,commentsCount:n.commentsCount,subscribers:n.subscribers,files:n.files,project:n.project})},project:function(n){var i,t;return typeof n.createdBy=="object"?i=h(n.createdBy):typeof n.createdById=="string"&&(i=UserManager.getPerson(n.createdById,h)),typeof n.responsible=="object"?t=h(n.responsible):typeof n.responsibleId=="string"?t=UserManager.getPerson(n.responsibleId,h):typeof n.responsible=="string"&&(t=UserManager.getPerson(n.responsible,h)),{id:n.id,title:n.title||"",description:n.description||"",status:n.status,canCreateMessage:n.hasOwnProperty("security")?n.security.canCreateMessage:"",canCreateMilestone:n.hasOwnProperty("security")?n.security.canCreateMilestone:"",canCreateTask:n.hasOwnProperty("security")?n.security.canCreateTask:"",canCreateTimeSpend:n.hasOwnProperty("security")?n.security.canCreateTimeSpend:"",canEditTeam:n.hasOwnProperty("security")?n.security.canEditTeam:"",security:n.security,isPrivate:n.isPrivate||!1,isInTeam:n.hasOwnProperty("security")?n.security.isInTeam:"",canLinkContact:n.hasOwnProperty("security")?n.security.canLinkContact:null,displayDateCrtdate:o(r(n.created)),taskCount:n.taskCount,taskCountTotal:n.taskCountTotal,milestoneCount:n.milestoneCount,participantCount:n.participantCount,discussionCount:n.discussionCount,documentsCount:n.documentsCount,responsibleId:t!=null&&t.id?t.id:t,canEdit:n.canEdit||!1,canDelete:n.canDelete,createdBy:i,responsible:t,timeTrackingTotal:n.timeTrackingTotal,isFollow:n.isFollow,tags:n.hasOwnProperty("tags")?n.tags:[]}},link:function(n){return{type:"link",parentTaskId:n.parentTaskId,dependenceTaskId:n.dependenceTaskId,linkType:n.linkType}},projectrequest:function(n){return s(this.item(n),{type:"request"})},activity:function(n){var t=new Date(n.date);return s(this.item(n),{type:"activity",projectId:n.projectId,projectTitle:n.projectTitle,title:n.title,url:n.url,actionText:n.actionText,displayDatetime:e(t),displayDate:o(t),displayTime:c(t),user:n.user,entityType:n.entityType,entityTitle:n.entityTitle})},subtask:function(n){return s(this.item(n),{type:"subtask",status:n.status,taskid:n.taskId})},subtasks:function(n){return i(n,this.item,function(n){return t.prj.subtask(n)})},tasks:function(n){return i(n,this.item,function(n){return t.prj.task(n)})},simpletasks:function(n){return i(n,this.item,function(n){return t.prj.simpletask(n)})},milestones:function(n){return i(n,this.item,function(n){return t.prj.milestone(n)})},discussions:function(n){return i(n,this.item,function(n){return t.prj.discussion(n)})},projects:function(n){var i=function(n){return t.prj.project(n)};return n.map(i)},links:function(n){return i(n,null,function(n){return t.prj.link(n)})},projectperson:function(n){var t=h(n);return t.canReadFiles=n.canReadFiles,t.canReadMessages=n.canReadMessages,t.canReadMilestones=n.canReadMilestones,t.canReadTasks=n.canReadTasks,t.canReadContacts=n.canReadContacts,t.isAdministrator=n.isAdministrator,t.isManager=n.isManager,t.department=n.department||"",t.isRemovedFromTeam=n.isRemovedFromTeam,t},projectpersons:function(n){for(var r=[],i=0;i<n.length;i++)r.push(t.prj.projectperson(n[i]));return r},searchentries:function(n){return i(n,this.item,function(n){var i=n.projectOwner;return{id:i?i.id:n.id||-1,type:"project",title:i?i.title:n.title||"",status:i?i.status:n.status||"",items:n.items?t.searchentryitems(n.items):[]}})},timespend:function(n){var i=r(n.date),u=r(n.statusChanged);return s(this.item(n),{type:"timespend",date:i,displayCreationDate:e(i),displayDateCreation:o(i),displayTimeCreation:c(i),hours:n.hours,note:n.note,status:n.paymentStatus,paymentStatus:n.paymentStatus,statusChanged:o(u),canEditPaymentStatus:n.canEditPaymentStatus,relatedProject:n.relatedProject,relatedTask:n.relatedTask,relatedTaskTitle:n.relatedTaskTitle,task:t.prj.task(n.task),person:n.hasOwnProperty("person")?h(n.person):""})},timespends:function(n){return i(n,this.item,function(n){return t.prj.timespend(n)})},activities:function(n){return i(n,this.item,function(n){return t.prj.activity(n)})},settings:function(n){return n},report:function(n){return n}},t.feed={item:function(n){function f(n){var i,t;if(!n)return null;for(i=[],t=0;t<n.length;t++)i.push(s(n[t]));return i}function s(n){var i=n.Date.slice(0,-1),t=r(i);return t.setMinutes(t.getMinutes()+ASC.Resources.Master.CurrentTenantTimeZone.UtcOffset),{id:n.Id,description:n.Description,authorId:n.AuthorId,date:t,formattedDate:e(t)}}var t=n.IsAllDayEvent?si(n.CreatedDate):r(n.CreatedDate),i=r(n.ModifiedDate),u=r(n.AggregatedDate);return{item:n.Item,itemId:n.ItemId,itemUrl:n.ItemUrl,id:n.Id,authorId:n.AuthorId,createdDate:t,displayCreatedDatetime:e(t),displayCreatedDate:o(t),displayCreatedTime:c(t),displayCreatedDayMonth:ci(t),modifiedDate:i,displayModifiedDatetime:e(i),displayModifiedDate:o(i),displayModifiedTime:c(i),aggregatedDate:u,product:n.Product,module:n.Module,action:n.Action,title:n.Title,isToday:n.IsToday,isYesterday:n.IsYesterday,isTomorrow:n.IsTomorrow,description:n.Description,extraLocation:n.ExtraLocation,extraLocationUrl:n.ExtraLocationUrl,additionalInfo:n.AdditionalInfo,additionalInfo2:n.AdditionalInfo2,additionalInfo3:n.AdditionalInfo3,additionalInfo4:n.AdditionalInfo4,hasPreview:n.HasPreview,isAllDayEvent:n.IsAllDayEvent,canComment:n.CanComment,commentApiUrl:n.CommentApiUrl,groupedFeeds:n.GroupedFeeds,comments:f(n.Comments)}},feeds:function(n){function c(n){var t=JSON.parse(n.feed);return t.IsToday=n.isToday,t.IsYesterday=n.isYesterday,t.IsTomorrow=n.isTomorrow,t.LastModifiedBy=n.lastModifiedBy,t.CreatedDate=n.createdDate,t.ModifiedDate=n.modifiedDate,t.AggregatedDate=n.aggregatedDate,t}for(var u,f,e,h,o=[],s=0;s<n.feeds.length;s++){for(u=n.feeds[s],f=c(u),f.GroupedFeeds=[],e=0;e<u.groupedFeeds.length;e++)f.GroupedFeeds.push(c(u.groupedFeeds[e]));o=o.concat(f)}return h=i(o,this.item,function(n){return t.feed.item(n)}),{feeds:h,readedDate:r(n.readedDate)}}},t.doc={miss:function(n){return n},item:function(n){var t=r(n.created),i=r(n.updated);return{id:n.id,parentId:n.parentId||n.folderId||-1,folderId:n.folderId||n.parentId||-1,access:n.access,sharedByMe:n.sharedByMe,rootFolderType:n.rootFolderType,rootType:tr(n.rootFolderType),timestamp:t?t.getTime():0,crtdate:t,displayCrtdate:e(t),displayDateCrtdate:o(t),displayTimeCrtdate:c(t),uptdate:i,displayUptdate:e(i),displayDateUptdate:o(i),displayTimeUptdate:c(i),createdBy:h(n.createdBy||n.author),updatedBy:h(n.updatedBy),canEdit:n.canEdit||!1,title:n.title||"",description:n.description||""}},rootFolder:function(n){if(!n||n.length<=1)return null;var t=n[0]||{};return{type:"folder",id:t.key,title:t.path}},parentFolder:function(n){if(!n||n.length<=1)return null;var t=n[n.length-2]||null;return t?{type:"folder",id:t.key,title:t.path,path:t.path}:null},files:function(n){return i(n,this.item,function(n){return t.doc.file(n)})},folders:function(n){return i(n,this.item,function(n){return t.doc.folder(n)})},file:function(n){var t,i,r;return n?(t=n.title?n.title:"",i=t.substring(0,t.lastIndexOf(".")),i=i?i:n.title,r=(t.substring(t.lastIndexOf("."))||"").toLowerCase(),s(this.item(n),{type:"file",extension:r,filename:i,filetype:gi(r),version:n.version,versionGroup:n.versionGroup,fileStatus:n.fileStatus,contentLength:n.contentLength,pureContentLength:n.pureContentLength,webUrl:at(n.webUrl||""),viewUrl:at(n.viewUrl||""),fileUrl:at(n.fileUrl||""),isSupported:nr(r),isUploaded:!1})):undefined},folder:function(n){var u=n.hasOwnProperty("__filenames")?n.__filenames:null,h=t.doc.folders(n.folders),i=t.doc.files(n.files),f=n.pathParts,n=n.current||n;if(u)for(var r=0,e="",o=u.length;o--;)for(e=u[o],r=i.length;r--;)i[r].title===e&&(i[r].isUploaded=!0);return s(this.item(n),{type:"folder",folders:h,files:i,pathParts:f,filesCount:n.filesCount,foldersCount:n.foldersCount,isShareable:n.isShareable||!1,canAddItems:n.access==ui.None||n.access==ui.ReadWrite,rootFolder:t.doc.rootFolder(f),parentFolder:t.doc.parentFolder(f)})},session:function(n){return n}},t.crm={item:function(n){var t=r(n.created),i=r(n.updated),u=r(n.expected||n.expectedCloseDate);return{id:n.id,timestamp:t?t.getTime():0,crtdate:t,displayCrtdate:e(t),displayDateCrtdate:o(t),displayTimeCrtdate:c(t),uptdate:i,displayUptdate:e(i),displayDateUptdate:o(i),displayTimeUptdate:c(i),expdate:u,displayExpdate:e(u),displayDateExpdate:o(u),displayTimeExpdate:c(u),createdBy:h(n.createdBy||n.createBy||n.author),updatedBy:h(n.updatedBy),responsible:h(n.responsible),title:n.title||"",description:n.description||""}},bidCurrency:function(n){return n},customfield:function(n){return n},dealmilestone:function(n){return n},category:function(n){return n},contactstatus:function(n){return n},contacttypekind:function(n){return n},historycategory:function(n){return n},entity:function(n){return n},company:function(n){return n},address:function(n){var r=["Home","Postal","Office","Billing","Other","Work"],u=["Phone","Email","Website","Skype","Twitter","LinkedIn","Facebook","Address","LiveJournal","MySpace","GMail","Blogger","Yahoo","MSN","ICQ","Jabber","AIM","Telegram"],t=n.category,i=n.infoType;return{id:n.id,infoType:i,infoTypeName:isFinite(+i)&&+i>=0&&+i<u.length?u[+i]:i,category:t,categoryName:isFinite(+t)&&+t>=0&&+t<r.length?r[+t]:t,data:n.data,isPrimary:n.isPrimary}},addresses:function(n){return i(n,this.address,function(n){return t.crm.address(n)})},contactbase:function(n){return s(this.item(n),{type:"contactbase",displayName:n.displayName,isCompany:n.isCompany,isPrivate:n.isPrivate,accessList:n.accessList,isShared:n.isShared,shareType:n.shareType,smallFotoUrl:n.smallFotoUrl,mediumFotoUrl:n.mediumFotoUrl,company:n.company?t.crm.company(n.company):null,email:n.email?n.email:null,currency:n.currency?t.crm.currency(n.currency):null,canEdit:n.canEdit,canDelete:n.canDelete})},contact:function(n){return s(this.item(n),{type:"contact",contactclass:n.firstName?"person":"company",displayName:n.displayName,firstName:n.firstName,lastName:n.lastName,isCompany:n.isCompany,isPrivate:n.isPrivate,isShared:n.isShared,shareType:n.shareType,smallFotoUrl:n.smallFotoUrl,mediumFotoUrl:n.mediumFotoUrl,company:n.company?t.crm.company(n.company):null,personsCount:n.personsCount,customFields:t.crm.customfields(n.customFields),about:n.about,industry:n.industry,currency:n.currency?t.crm.currency(n.currency):null,accessList:n.accessList,addresses:n.addresses,commonData:n.commonData,haveLateTasks:n.haveLateTasks||!1,taskCount:n.taskCount,contactStatus:n.contactStatus,canEdit:n.canEdit,canDelete:n.canDelete,tags:n.tags})},simplecontact:function(n){return s(this.item(n),{type:"contact",contactclass:n.firstName?"person":"company",displayName:n.displayName,firstName:n.firstName,lastName:n.lastName,isCompany:n.isCompany,isPrivate:n.isPrivate,isShared:n.isShared,shareType:n.shareType,smallFotoUrl:n.smallFotoUrl,mediumFotoUrl:n.mediumFotoUrl,company:n.company?t.crm.company(n.company):null,personsCount:n.personsCount,customFields:t.crm.customfields(n.customFields),about:n.about,industry:n.industry,accessList:n.accessList,addresses:n.addresses,commonData:n.commonData,haveLateTasks:n.haveLateTasks||!1,taskCount:n.taskCount,contactStatus:n.contactStatus,currency:n.currency?t.crm.currency(n.currency):null,canEdit:n.canEdit,canDelete:n.canDelete,tags:n.tags,nearTask:n.nearTask||null})},basecontact:function(n){return s(this.item(n),{type:"contact",contactclass:n.isCompany?"company":"person",displayName:n.displayName,email:n.email,phone:n.phone,isCompany:n.isCompany,currency:n.currency?t.crm.currency(n.currency):null,isPrivate:n.isPrivate,isShared:n.isShared,shareType:n.shareType,accessList:n.accessList,smallFotoUrl:n.smallFotoUrl,mediumFotoUrl:n.mediumFotoUrl,canEdit:n.canEdit,canDelete:n.canDelete})},socialmediaavatar:function(n){return{type:"socialmediaavatar",socialNetwork:n.socialNetwork,imageUrl:n.imageUrl,identity:n.identity}},socialmediaavatars:function(n){return i(n,null,function(n){return t.crm.socialmediaavatar(n)})},tweet:function(n){var t=r(n.postedOn);return{type:"tweet",userImageUrl:n.userImageUrl,userName:n.userName,userId:n.userId,text:n.text,postedOn:t,postedOnDisplay:e(t),source:n.source}},tweets:function(n){return i(n,null,function(n){return t.crm.tweet(n)})},twitterprofile:function(n){var t=r(n.postedOn);return{type:"twitterprofile",userID:n.userID,screenName:n.screenName,userName:n.userName,smallImageUrl:n.smallImageUrl,description:n.description}},twitterprofiles:function(n){return i(n,null,function(n){return t.crm.twitterprofile(n)})},progressitem:function(n){return n},exportitem:function(n){return!n||jq.isEmptyObject(n)?n:{id:n.id,status:n.status,percentage:n.percentage,isCompleted:n.isCompleted,exception:n.error||n.errorText,fileId:n.fileId,fileUrl:n.fileUrl,fileName:n.fileName}},fileuploadresult:function(n){return n},file:function(n){return s(this.item(n),{type:"file",title:n.title,folderId:n.folderId,version:n.version,fileStatus:n.fileStatus,contentLength:n.contentLength,pureContentLength:n.pureContentLength,viewUrl:n.viewUrl,webUrl:n.webUrl,access:n.access,sharedByMe:n.sharedByMe,rootFolderType:n.rootFolderType,createdDate:r(n.created)})},files:function(n){return i(n,this.item,function(n){return t.crm.file(n)})},tag:function(n){return n},task:function(n){var i=r(n.deadLine),u=i&&i.getHours()==0&&i.getMinutes()==0&&i.getSeconds()==0?o(i):e(i);return s(this.item(n),{type:"task",category:t.crm.category(n.category),canEdit:n.canEdit,canWork:n.canWork,contact:n.contact?t.crm.contactbase(n.contact):null,deadLine:i,deadLineString:u,entity:n.entity?t.crm.entity(n.entity):null,isClosed:n.isClosed,alertValue:typeof n.alertValue!="undefined"?n.alertValue:0})},opportunity:function(n){var i=r(n.expectedCloseDate),u=r(n.actualCloseDate);return s(this.item(n),{type:"opportunity",accessList:n.accessList,actualCloseDate:u,actualCloseDateString:o(u),bidCurrency:t.crm.bidCurrency(n.bidCurrency),bidType:n.bidType,bidValue:n.bidValue,contact:n.contact?t.crm.contact(n.contact):null,customFields:t.crm.customfields(n.customFields),stage:t.crm.dealmilestone(n.stage),successProbability:n.successProbability,expectedCloseDate:i,expectedCloseDateString:o(i),isPrivate:n.isPrivate,canEdit:n.canEdit,perPeriodValue:n.perPeriodValue})},taskcategory:function(n){return s(this.item(n),{type:"taskcategory",imagePath:n.imagePath,relativeItemsCount:n.relativeItemsCount,sortOrder:n.sortOrder})},caseitem:function(n){return s(this.item(n),{type:"case",accessList:n.accessList,isClosed:n.isClosed,isPrivate:n.isPrivate,canEdit:n.canEdit})},cases:function(n){return i(n,this.item,function(n){return t.crm.caseitem(n)})},tags:function(n){return n},fulltag:function(n){return{type:"fulltag",title:n.title,relativeItemsCount:n.relativeItemsCount||0}},fulltags:function(n){for(var r=[],i=0,u=n.length;i<u;i++)r.push(t.crm.fulltag(n[i]));return r},contacts:function(n){return i(n,this.item,function(n){return t.crm.contact(n)})},simplecontacts:function(n){for(var r,u=[],i=0;i<n.length;i++)r=t.crm.simplecontact(n[i].contact),n[i].hasOwnProperty("task")&&(r.nearTask=t.crm.task(n[i].task)),u.push(r);return u},basecontacts:function(n){return i(n,this.item,function(n){return t.crm.basecontact(n)})},customfields:function(n){return i(n,this.item,function(n){return t.crm.customfield(n)})},dealmilestones:function(n){return i(n,this.item,function(n){return t.crm.dealmilestone(n)})},contactstatuses:function(n){return i(n,this.item,function(n){return t.crm.contactstatus(n)})},contacttypekinds:function(n){return i(n,this.item,function(n){return t.crm.contacttypekind(n)})},historycategories:function(n){return i(n,this.item,function(n){return t.crm.historycategory(n)})},tasks:function(n){return i(n,this.item,function(n){return t.crm.task(n)})},opportunities:function(n){return i(n,this.item,function(n){return t.crm.opportunity(n)})},taskcategories:function(n){return i(n,this.item,function(n){return t.crm.taskcategory(n)})},historyevent:function(n){return s(this.item(n),{type:"event",createdDate:o(r(n.created)),canEdit:n.canEdit,category:t.crm.category(n.category),contact:n.contact?t.crm.contact(n.contact):null,content:n.content,entity:n.entity?t.crm.entity(n.entity):null,files:n.files&&n.files.length!=0?t.crm.files(n.files):null})},historyevents:function(n){return i(n,this.item,function(n){return t.crm.historyevent(n)})},currency:function(n){return{type:"currency",abbreviation:n.abbreviation,cultureName:n.cultureName,symbol:n.symbol,title:n.title,isConvertable:n.isConvertable,isBasic:n.isBasic}},currencies:function(n){return i(n,null,function(n){return t.crm.currency(n)})},smtpsettings:function(n){return{type:"smtpsettings",enableSSL:n.enableSSL,host:n.host,hostLogin:n.hostLogin,hostPassword:n.hostPassword,port:n.port,requiredHostAuthentication:n.requiredHostAuthentication,senderDisplayName:n.senderDisplayName,senderEmailAddress:n.senderEmailAddress}},rootfolder:function(n){return{id:n}},invoice:function(n){var f=r(n.issueDate),h=o(f),i=r(n.dueDate),l=i&&i.getHours()==0&&i.getMinutes()==0&&i.getSeconds()==0?o(i):e(i),u=n.createOn?r(n.createOn):null,a=n.status.id==2&&i<new Date;return s(this.item(n),{type:"invoice",number:n.number,status:n.status,debtor:a,issueDate:f,issueDateString:h,dueDate:i,dueDateString:l,templateType:n.templateType,contact:n.contact?t.crm.basecontact(n.contact):null,consignee:n.consignee?t.crm.basecontact(n.consignee):null,entity:n.entity?t.crm.entity(n.entity):null,language:n.language,currency:n.currency?t.crm.currency(n.currency):null,cost:n.cost,purchaseOrderNumber:n.purchaseOrderNumber,terms:n.terms,description:n.description,fileId:n.fileID,crtdate:u,displayCrtdate:e(u),displayDateCrtdate:o(u),displayTimeCrtdate:c(u),invoiceLines:n.invoiceLines&&n.invoiceLines.length!=0?t.crm.invoiceLines(n.invoiceLines):null,canEdit:n.canEdit,canDelete:n.canDelete})},invoices:function(n){return i(n,this.item,function(n){return t.crm.invoice(n)})},invoiceJsonData:function(n){return JSON.parse(n||null)},invoiceLines:function(n){return i(n,this.item,function(n){return t.crm.invoiceLine(n)})},invoiceLine:function(n){return{type:"invoiceLine",id:n.id,invoiceID:n.invoiceID,invoiceItemID:n.invoiceItemID,invoiceTax1ID:n.invoiceTax1ID,invoiceTax2ID:n.invoiceTax2ID,sortOrder:n.sortOrder,description:n.description,quantity:n.quantity,price:n.price,discount:n.discount,canEdit:n.canEdit}},invoiceItems:function(n){return i(n,this.item,function(n){return t.crm.invoiceItem(n)})},invoiceItem:function(n){return{type:"invoiceItem",id:n.id,title:n.title,stockKeepingUnit:n.stockKeepingUnit,description:n.description,price:n.price,currency:n.currency,stockQuantity:n.stockQuantity,trackInvenory:n.trackInvenory,invoiceTax1:n.invoiceTax1?t.crm.invoiceTax(n.invoiceTax1):null,invoiceTax2:n.invoiceTax2?t.crm.invoiceTax(n.invoiceTax2):null,sortOrder:n.sortOrder,canEdit:n.canEdit,canDelete:n.canDelete}},invoicesAndItems:function(n){return{invoices:n.key&&n.key.length!=0?t.crm.invoices(n.key):null,invoiceItems:n.value&&n.value.length!=0?t.crm.invoiceItems(n.value):null}},invoiceTaxes:function(n){return i(n,this.item,function(n){return t.crm.invoiceTax(n)})},invoiceTax:function(n){return{type:"invoiceTax",id:n.id,name:n.name,description:n.description,rate:n.rate,canEdit:n.canEdit,canDelete:n.canDelete}},invoiceSettings:function(n){return{type:"invoiceSettings",autogenerated:n.autogenerated,prefix:n.prefix,number:n.number,terms:n.terms}},currencyRates:function(n){return i(n,this.item,function(n){return t.crm.currencyRate(n)})},currencyRate:function(n){return{type:"currencyRate",id:n.id,fromCurrency:n.fromCurrency,toCurrency:n.toCurrency,rate:n.rate}},voipNumbers:function(n){return i(n,null,function(n){return t.crm.voipNumber(n)})},voipNumber:function(n){return{id:n.id,number:n.number,alias:n.alias,settings:n.settings}},voipSettings:function(n){return n},voipCalls:function(n){return i(n,null,function(n){return t.crm.voipCall(n)})},voipCall:function(n){var i=r(n.dialDate);return{id:n.id,from:n.from,to:n.to,status:n.status,answeredBy:h(n.answeredBy),dateObj:i,datetime:e(i),time:c(i),dialDuration:n.dialDuration,cost:n.cost,recordUrl:n.recordUrl,recordDuration:n.recordDuration,contact:n.hasOwnProperty("contact")&&n.contact?t.crm.contact(n.contact):null,history:n.history}},converterData:function(n){return{type:"converterData",storageUrl:n.storageUrl,revisionId:n.revisionId,urlToFile:n.urlToFile,invoiceId:n.invoiceId,fileId:n.fileId}}},yt=function(n,i,r,u){var e,o,f;if(typeof r=="undefined")return null;for(u=u||[r],i=typeof i=="string"?i.toLowerCase():"",e=ft.length;e--;)if(ft[e].re.test(n)){if(!ft[e].hasOwnProperty("method"))break;if(ft[e].method===i)break}return(o=e!==-1?ft[e].handler:n,f=o.split("-"),f.length>1&&t.hasOwnProperty(f[0])&&typeof t[f[0]][f[1]]=="function")?t[f[0]][f[1]].apply(t[f[0]],[r,u]):typeof t[o]=="function"?t[o].apply(t,[r,u]):yi===!0?null:r},{profile:v,dateFormats:ot,contactTypes:ut,nameCollections:rt,init:ur,create:yt,fixData:fr,formattingDate:et,serializeUtcDate:si,serializeDate:r,serializeTimestamp:er,getDisplayTime:c,getDisplayDate:o,getDisplayDatetime:e,getDisplayDayMonth:ci}}();
window.ServiceHelper=function(n){function h(n){var f,u,o=n.attributes,s=n.childNodes,i=n.nodeType,t={},r=null,e=-1;if(i==1&&o.length){for(t[i="@attributes"]={};f=o.item(++e);)t[i][f.nodeName]=f.nodeValue;e=-1}else i==3&&(t=n.nodeValue);while(u=s.item(++e))i=u.nodeName,t.hasOwnProperty(i)?(t.toString.call(t[i])!="[object Array]"&&(t[i]=[t[i]]),t[i].push(h(u))):i==="#text"?(r=h(u),t=isFinite(+r)?+r:r,(r==="true"||r==="false")&&(t=r==="true")):t[i]=h(u);return t}function i(n){return n?n.constructor.toString().indexOf("Array")!=-1:!1}function ti(n){return n?n.constructor.toString().indexOf("File")!=-1:!1}function ii(n){return ti(n)?!1:!0}function ct(n){return""+(n?n+"-":"")+Math.floor(Math.random()*1e6)}function lt(n,t){for(var r=0,i=ct(t);n.hasOwnProperty(i)&&r++<1e3;)i=ct(t);return i}function at(n,t,r){var u=null,o=null,f,s,e,h;for(f in t)if(t.hasOwnProperty(f)){if(s=!1,u=t[f],r?r[f]=u:null,typeof u=="string"&&u.length>0&&(u=encodeURIComponent(u)),u&&i(u)){for(o=[],e=0,h=u.length;e<h;e++)o.push(f+"[]="+encodeURIComponent(u[e]));n.push(o.join("&"));s=!0}s===!1?n.push(f+"="+u):null}return n}function ri(n,t,i,r,u){var f=[],e;switch(n){case"get":case"delete":r&&typeof r=="object"&&(f=at(f,r,null),r=null)}return!u||typeof u!="object"?t:(i.__filter={},e=u.hasOwnProperty("filter")?u.filter||{}:{},f=at(f,e,i.__filter),t+(f.length>0?"?"+f.join("&"):""))}function g(n,t){var i=null,r;if(!n)return!1;if(n.__once===!0)for(r=t.length;r--;)if(i=t[r],i.__eventname===n.__eventname&&i.type===n.type&&i.url===n.url)return!1;return!0}function nt(){for(var n="",i=[],t=0,r=arguments.length;t<r;t++)i.push(arguments[t]);return n=i.join(ot),u+(n.charAt(0)===ot?n.substring(1):n)}function vt(n){for(var t in n)delete n[t],n[t]=null}function tt(n){for(var i=0,r=t.length;i<r;i++)if(t[i].__id==n)return t[i];return null}function o(n){for(var i=t.length;i--;)t[i].__id==n&&(vt(t[i]),delete t[i],t[i]=null,t.splice(i,1));delete req}function it(n){if(!n||typeof n!="object"||!n.__id)return null;for(var i=0,r=t.length;i<r;i++)if(t[i].__id==n.__id)return t[i];return null}function rt(n,t){var i;if(typeof n.__errorcallback=="function")try{n.__errorcallback(n.__params,n.__errors)}catch(i){console.log(i)}if(t!==!0)try{r("extention",this,[n.__eventname,n.__params,n.__errors])}catch(i){console.log(i)}}function yt(n){var r,f,u,i;if(!n)return!1;if(n.__attcount!=0&&n.type!="get"||n.__attcount>=n.__max_request_attempts){if(n.hasOwnProperty("__jointrequests")&&n.__jointrequests)for(r=0,f=n.__jointrequests.length;r<f;r++)u=n.__jointrequests[r],typeof u.__aftercallback=="function"&&u.__aftercallback(u.__params);for(typeof n.__aftercallback=="function"&&n.__aftercallback(n.__params),rt(n),i=t.length;i--;)t[i]===n&&(vt(t[i]),delete t[i],t[i]=null,t.splice(i,1));return delete n,!1}return!0}function ut(n,t,u){var h,p,c,a,l,w,b,v;if(!n)return!1;var s=null,e=!1,y=!1,f=null;switch(u){case"error":e=!0;break;case"timeout":n.__totcount++;e=!0;s="timeout expected"}switch(t.status){case 401:e=!0;y=!0;n.__attcount+=n.__max_request_attempts;s="unauthorized request"}if(!e){try{f=t.responseObject||JSON.parse(t.responseText)}catch(k){f=null;e=!0;s="response parse error"}e||f||(e=!0,s="response parse error");e||f.response!=null||(f.hasOwnProperty("error")?(e=!0,n.__attcount+=n.__max_request_attempts,s=f.error.message||"throw error"):(e=!0,s="empty response"))}if(e||f&&f.status!=0&&(e=!0,s="invalid status"),e){if(s)n.__errors.push(s);else{try{f=t.responseObject||JSON.parse(t.responseText)}catch(k){f=null}f&&f.error&&(n.__errors.push(f.error.message),n.__errors.push(f.error))}if(y&&r("unauthenticated",this,[n.__params]),n.hasOwnProperty("__jointrequests")&&n.__jointrequests)for(h=0,p=n.__jointrequests.length;h<p;h++)c=n.__jointrequests[h],typeof c.__errorcallback=="function"&&c.__errorcallback(c.__params,n.__errors);for(a=n.__batchrequests&&i(n.__batchrequests)?n.__batchrequests:[],l=0,w=a.length;l<w;l++)b=a[l].Name,v=tt(b),v&&o(v.__id);return n.__processing=!1,delete n,!1}return!0}function ui(n,t){if(!n)return!1;var f=null,u=!1,e=!1,i=null;if(u=!1,e=!1,!u)try{jQuery.isXMLDoc(t.responseText)&&(i=h(t.responseText),i=i.result||null);typeof t.responseText=="string"&&(i=t.responseText.replace(/^<pre>/,"").replace(/<\/pre>$/,""),i=JSON.parse(t.responseText))}catch(o){i=null;u=!0;f="response parse error"}return(u||i||(u=!0,f="response parse error"),u||i.response||(i.hasOwnProperty("error")?(u=!0,n.__attcount+=n.__max_request_attempts,f=i.error.message||"throw error"):(u=!0,f="empty response")),u||i&&i.status!=0&&(u=!0,f="invalid status"),u)?(f&&(n.__errors.push(f),rt(n)),e&&r("unauthenticated",this,[]),n.__processing=!1,delete n,!1):!0}function y(t,i,u,f,e){var s=f&&t.__singleresponse===!0?n.create(t.url,t.type,f[0],f):null,l,v,w,b,a,h,c,d;if(typeof s!="undefined"&&s!=null){l=e[0];for(h in l)l.hasOwnProperty(h)&&(u["__"+h]=l[h]);if(t.__isme===!0&&wi(t.__params,s),t.__isauth===!0&&ki(t.__params,s),t.__issettings===!0&&bi(t.__params,s),v=!0,typeof t.__successcallback=="function")try{t.__successcallback(t.__params,s)===!1&&(v=!1)}catch(k){console.log(k)}if(v===!0)try{r(null,this,[t.__params,s]);t.__eventname&&r(t.__eventname,this,[t.__params,s])}catch(k){console.log(k)}}if(s===null&&f&&t.__singleresponse===!1){var y=[],p=[];for(w in e)if(e.hasOwnProperty(w)){b={};a=e[w];for(h in a)a.hasOwnProperty(h)&&(b["__"+h]=a[h]);p.push(b)}for(p.push(u),y.push(p),c=0,d=f.length;c<d;c++)s=n.create(t.__urls[c],t.__methods[c],f[c],f),y.push(s);!0&&fi.call(this,t,y)}o(t.__id)}function fi(n,t){var i=!0;if(typeof n.__successcallback=="function")try{n.__successcallback.apply(this,t)===!1&&(i=!1)}catch(u){console.log(u)}if(i===!0)try{r(null,this,t);n.__eventname&&r(n.__eventname,this,t)}catch(u){console.log(u)}}function ei(n,t){var r=null,i=it(this),f,u,e;if(!ut(i,n,t)||(r=JSON.parse(n.responseText),i=i.__processing===!0?i:null,!i))return undefined;if(typeof i.__aftercallback=="function"&&i.__aftercallback(i.__params),i.__urls.push(i.url),i.__methods.push(i.type),i.__responses.push(r.response),i.__paramses.push({count:r.count,startIndex:r.startIndex,nextIndex:r.nextIndex||undefined,total:r.total||undefined}),i.batch.length>0)return delete i.__errors,i.__errors=[],i.__errcount=0,i.__totcount=0,i.__attcount=0,i.__processing=!1,i.url=i.batch[0],i.batch=i.batch.slice(1),undefined;for(f=[i,i.__eventname,i.__params,i.__responses,i.__paramses],u=0,e=arguments.length;u<e;u++)f.push(arguments[u]);y.apply(this,f);o(i.__id)}function oi(n,t){var h=null,e=0,d=[],g=[],nt=[],ft=[],f=it(this),et=null,c=null,u=null,w=null,b=null,r=null,a,s,l,p,ot,st;if(!ut(f,n,t)||(c=n.responseObject||JSON.parse(n.responseText),f=f.__processing===!0?f:null,!f))return undefined;if(f.hasOwnProperty("__jointrequests")&&f.__jointrequests)for(s=0,l=f.__jointrequests.length;s<l;s++)a=f.__jointrequests[s],typeof a.__aftercallback=="function"&&a.__aftercallback(a.__params);typeof f.__aftercallback=="function"&&f.__aftercallback(f.__params);h=f.__batchrequests&&i(f.__batchrequests)?f.__batchrequests:[];var v=null,k=[],et=i(c.response)?c.response:[c.response];for(s=0,l=arguments.length;s<l;s++)k.push(arguments[s]);for(p=0,ot=et.length;p<ot;p++){for(u=et[p],w=u.name,r=tt(w),e=h.length;e--;)h[e].Name===w&&(b=h[e].RelativeUrl,method=h[e].RelativeMethod);try{u=JSON.parse(u.data)}catch(ht){u=null}ut(f,{status:u.statusCode||200,responseObject:u},t)||(u={response:null});u&&b&&(g.push(b),nt.push(method),d.push(u.response),ft.push({count:u.count,startIndex:u.startIndex,nextIndex:u.nextIndex||undefined,total:u.total||undefined}));r&&u&&r.url&&u.response&&(r.__urls.push(r.url),r.__methods.push(r.type),r.__responses.push(u.response),r.__paramses.push({count:u.count,startIndex:u.startIndex,nextIndex:u.nextIndex||undefined,total:u.total||undefined}),v=[r,r.__eventname,r.__params,r.__responses,r.__paramses].concat(k),y.apply(this,v),o(r.__id))}for(e=0,st=h.length;e<st;e++)r=tt(h[e].Name),r&&r.__id&&o(r.__id);r=it(this);r&&(r.__urls=[].concat(g),r.__methods=[].concat(nt),r.__responses=[].concat(d),r.__paramses=[].concat(ft),r.__errors.length>0&&(r.__params.__errors=r.__errors,rt(r,!0)),v=[r,r.__eventname,r.__params,r.__responses,r.__paramses].concat(k),y.apply(this,v),o(r.__id))}function si(n,t,i){var r=e.hasOwnProperty(n)?e[n]:null;r&&typeof r.__beforecallback=="function"&&r.__beforecallback(r.__params,t,i)}function hi(n,t,i){var r=e.hasOwnProperty(n)?e[n]:null,u;if(r&&typeof r.__aftercallback=="function"&&r.__aftercallback(r.__params),!ui(r,{status:0,responseText:i},"success"))return undefined;if(jQuery.isXMLDoc(i)&&(i=h(i),i=i&&typeof i=="object"?i:null,i=i&&i.hasOwnProperty("result")?i.result:i),typeof i=="string"){i=i.replace(/^<pre>/,"").replace(/<\/pre>$/,"");try{i=JSON.parse(i)}catch(f){i=null}}r&&i&&(t&&(i.response.__filenames=typeof t=="string"?[t]:[]),r.__urls.push(r.url),r.__methods.push(r.type),r.__responses.push(i.response),r.__paramses.push({count:i.count,startIndex:i.startIndex,nextIndex:i.nextIndex||undefined,total:i.total||undefined}),u=[r,r.__eventname,r.__params,r.__responses,r.__paramses,null,"success"],y.apply(this,u),o(r.__id),e.hasOwnProperty(n)&&delete e[n])}function pt(){var r,n,u,i,f;if(t.length>0&&(t[0].__processing===!1||t[0].__isasync===!0)){if(r=[],gt===!0&&t.length>1&&t[0].__issimple===!0)for(n=0,u=t.length;n<u;n++)t[n].__issimple===!0&&t[n].__processing===!1&&r.push(t[n]);if(r.length>1)ci(r);else for(i=0,f=t.length;i<f;i++)if(t[i].__processing===!1){li(t[i]);break}}ht=new Date}function c(t,r,u,f,e,o){var h,s,c,k;if(r=r||{},u=typeof u=="string"?u.toLowerCase():"get",e&&typeof e=="object")for(s in e)e.hasOwnProperty(s)&&e[s]instanceof Date&&(e[s]=n.serializeTimestamp(e[s]));if(o&&typeof o=="object"&&o.hasOwnProperty("filter")){h=o.filter;for(s in h)h.hasOwnProperty(s)&&h[s]instanceof Date&&(h[s]=n.serializeTimestamp(h[s],!0))}f=ri(u,f,r,e,o);var d=lt({}),l=null,a=null,v=null,p=b,y=typeof o=="function"?o:null,w=!1;if(o&&typeof o=="object"&&(l=o.hasOwnProperty("before")&&typeof o.before=="function"?o.before:l,a=o.hasOwnProperty("after")&&typeof o.after=="function"?o.after:a,v=o.hasOwnProperty("error")&&typeof o.error=="function"?o.error:v,y=o.hasOwnProperty("success")&&typeof o.success=="function"?o.success:y,o.hasOwnProperty("max_request_attempts")&&(p=o.max_request_attempts),o.hasOwnProperty("is_single")&&(w=o.is_single)),f=typeof f=="string"?nt(f):f,i(f))for(c=0,k=f.length;c<k;c++)f[c]=nt(f[c]);return{__id:d,__errors:[],__errcount:0,__totcount:0,__attcount:0,__eventname:t||"",__processing:!1,__params:r,__once:r.hasOwnProperty("__once")?r.__once===!0:!1,__beforecallback:l,__aftercallback:a,__errorcallback:v,__successcallback:y,__isauth:t==="authentication",__issettings:t==="settings",__isme:t==="me",__issimple:t!=="authentication"&&t!=="settings"&&t!=="me"&&u==="get"&&typeof f=="string"&&w===!1,__urls:[],__methods:[],__paramses:[],__responses:[],__singleresponse:typeof f=="string",__uploader:null,__max_request_attempts:p,__isasync:o&&o.hasOwnProperty("async")&&typeof o.async=="boolean"?o.async:!1,jsonp:!1,"async":!0,dataType:"json",processData:ii(e),cache:!0,converters:{"* text":!1,"text script":!1,"text html":!1,"text json":!1,"text xml":!1},url:typeof f=="string"?f:i(f)?f[0]:null,batch:typeof f=="object"&&i(f)&&f.length>1?f.slice(1):[],type:u,data:e,timeout:st,complete:ei}}function ft(n,t,r,u,f,e,o,s){t=t||{};var y=lt({}),h=null,c=null,l=null,v=b,a=typeof e=="function"?e:null;return e&&typeof e=="object"&&(h=e.hasOwnProperty("before")&&typeof e.before=="function"?e.before:h,c=e.hasOwnProperty("after")&&typeof e.after=="function"?e.after:c,l=e.hasOwnProperty("error")&&typeof e.error=="function"?e.error:l,a=e.hasOwnProperty("success")&&typeof e.success=="function"?e.success:a,e.hasOwnProperty("max_request_attempts")&&(v=e.max_request_attempts)),u=typeof u=="string"?nt(u):u,{__id:y,__errors:[],__errcount:0,__totcount:0,__attcount:0,__eventname:n||"",__processing:!1,__params:t,__beforecallback:h,__aftercallback:c,__errorcallback:l,__successcallback:a,__isbatch:!0,__urls:[],__methods:[],__paramses:[],__responses:[],__singleresponse:!1,__uploader:null,__batchrequests:o&&i(o)?o:null,__jointrequests:s&&typeof s=="object"&&i(s)?s:null,__max_request_attempts:v,jsonp:!1,"async":!0,dataType:"json",cache:!0,converters:{"* text":!1,"text script":!1,"text html":!1,"text json":!1,"text xml":!1},url:u,type:r,data:f,timeout:st,complete:oi}}function wt(n){n.__processing=!0;n.url+=(n.url.indexOf("?")===-1?"?":"&")+v+"="+n.__id;jQuery.ajax(n)}function ci(n){for(var e=n.length,u,h,r,f;e--;)if(!yt(n[e]))break;if(e===-1){var i=null,o=[],c=[],s=b;for(r=0,f=n.length;r<f;r++)i=n[r],i.__attcount++,i.__processing=!0,i.url+=(i.url.indexOf("?")===-1?"?":"&")+v+"="+i.__id,o.push({Name:i.__id,RelativeUrl:i.url,RelativeMethod:i.type}),c.push(i),i.__max_request_attempts<s&&(s=i.__max_request_attempts);for(u=ft(null,null,"post","batch.json",{batch:jQuery.toJSON(o)},{max_request_attempts:s},o,c),h=!1,r=0,f=t.length;r<f;r++)if(t[r].issimple===!0){t.splice(r,0,u);h=!0;break}h===!1&&t.push(u);u.__attcount++;wt(u)}}function li(n){yt(n)&&(n.__attcount++,wt(n))}function ai(){l=(new Date).getTime();delete s;s=[]}function vi(n,i){var r=null;l=0;r=ft("",n,"post","batch.json",{batch:jQuery.toJSON(s)},i,s);g(r,t)&&(typeof r.__beforecallback=="function"&&r.__beforecallback(r.__params),t.push(r))}function yi(r,u,f,e,o,h){var a=null,tt=new Date,b,nt,y,k,d;if(tt-ht>3*w&&(clearInterval(p),p=setInterval(pt,w)),o=n.fixData(o),l>0&&(new Date).getTime()-l<ni)return a=c(r,u,f,e,o,h),a.url+=(a.url.indexOf("?")===-1?"?":"&")+v+"="+a.__id,s.push({Name:a.__id,method:a.type,RelativeUrl:a.url,RelativeMethod:a.type}),s;if(i(e)){for(b=[],nt=[],y=0,k=e.length;y<k;y++)a=c(r,u,f,e[y],o,h),a.url+=(a.url.indexOf("?")===-1?"?":"&")+v+"="+a.__id,b.push({Name:a.__id,method:a.type,RelativeUrl:a.url,RelativeMethod:a.type}),nt.push(a);a=ft(r,u,"post","batch.json",{batch:jQuery.toJSON(b)},h,b,nt)}else a=c(r,u,f,e,o,h);if(g(a,t)){if(a.hasOwnProperty("__jointrequests")&&a.__jointrequests)for(y=0,k=a.__jointrequests.length;y<k;y++)d=a.__jointrequests[y],typeof d.__beforecallback=="function"&&d.__beforecallback(d.__params);typeof a.__beforecallback=="function"&&a.__beforecallback(a.__params);t.push(a)}}function bt(n,i,r,u,f,e){var o=c(n,i,r,u,f,e);g(o,t)&&(typeof o.__beforecallback=="function"&&o.__beforecallback(o.__params),t.unshift(o))}function wi(n,t){a|=1;k=t;a===3&&r("completeinit",this,[k,d])}function bi(n,t){a|=2;d=t;a===3&&r("completeinit",this,[k,d])}function ki(){dt({__once:!0})}function di(){}var et=!1,gt=!0,l=0,ni=500,s=[],a=0,u=null,v="__",ot="/",p=0,w=50,b=3,st=6e4,k=null,d=null,f={},e={},t=[],ht=new Date,pi=function(n,t,i,r,u,f){var o=c(n,t,i,r,u,f);return u=u||{},u.action=o.url,u.onSubmit=function(n){return function(t,i){si(n,t,i)}}(o.__id),u.onComplete=function(n){return function(t,i){hi(n,t,i)}}(o.__id),e[o.__id]=o,o.__uploader=new AjaxUpload(u.buttonId,u)},gi=function(n,t){if(et===!0)return undefined;et=!0;u=typeof n=="string"&&n.length>0?n:u;u&&(u=u.charAt(u.length-1)==="/"?u:u+"/");p=setInterval(pt,w);kt("unauthenticated",di);t&&dt({__once:!0})},kt=function(n,t){f.hasOwnProperty(n)||(f[n]=[]);typeof t=="function"&&f[n].push(t)},r=function(n,t,i){var u,r,e;if(f.hasOwnProperty(n)){for(u=f[n],t=t||window,i=i||[],r=0,e=u.length;r<e;r++)u[r].apply(t,i);return undefined}if(f.hasOwnProperty("event"))for(u=f.event,t=t||window,r=0,e=u.length;r<e;r++)u[r].apply(t,[n,t,i])},dt=function(n,t){n=n||{};bt("me",n,"get","people/@self.json",null,t)},tr=function(n,t){n=n||{};bt("settings",n,"get","settings.json",null,t)},nr=function(){};return{test:nr,init:gi,bind:kt,exec:r,joint:ai,start:vi,request:yi,uploader:pi}}(ServiceFactory);
window.Teamlab=function(){function e(n){return n?n.constructor.toString().indexOf("Array")!=-1:!1}function s(n){return n&&typeof n=="object"&&n.hasOwnProperty("query")?n.query:null}function it(){for(var n in r)a[n]=!0,a[r[n]]=!0}function rt(n,t,i,r){n=n.replace(/-/g,"_");t&&typeof t=="object"&&typeof t[n]=="function"&&t[n].apply(i,r)}function h(n){return n&&e(n)?window.Teamlab:n}function ot(n,t,i){a.hasOwnProperty(n)&&w(n,t,i)}function st(n,t,i){c.call(r.getException,this,[t,i])}function ht(n){var i,t,r;if(n.hasOwnProperty("___handler")&&n.hasOwnProperty("___container")){for(i=[n],t=1,r=arguments.length;t<r;t++)i.push(arguments[t]);rt(n.___handler,n.___container,this,i)}}function n(n,t,i,r,u,f){return h(o.request(n,t,i,r,u,f))}var u="post",i="put",f="delete",t="get",o=ServiceHelper,p=!1,r={getException:"ongetexception",getAuthentication:"ongetauthentication",addPrjComment:"onaddprjcomment",updatePrjTime:"onupdateprjtime",removePrjTime:"onremoveprjtime",getMailFilteredMessages:"ongetmailmessages",getMailFolders:"ongetmailfolders",getAccounts:"ongetmailaccounts",getMailTags:"ongetmailtags",getMailConversation:"ongetmailconversation",getNextMailConversationId:"ongetnextmailconversationid",getPrevMailConversationId:"ongetprevmailconversationid",getMailMessage:"ongetmailmessage",getNextMailMessageId:"ongetnextmailmessageid",getPrevMailMessageId:"ongetprevmailmessageid",removeMailFolderMessages:"onremovemailfoldermessages",restoreMailMessages:"onrestoremailmessages",moveMailMessages:"onmovemailmessages",removeMailMessages:"onremovemailmessages",markMailMessages:"onmarkmailmessages",createMailTag:"oncreatemailtag",updateMailTag:"onupdatemailtag",removeMailTag:"onremovemailtag",addMailDocument:"onaddmaildocument",setMailTag:"onsetmailtag",setMailConversationsTag:"onsetmailconversationstag",unsetMailTag:"unsetmailtag",unsetMailConversationsTag:"unsetmailconversationstag",removeMailMailbox:"onremovemailmailbox",getMailDefaultMailboxSettings:"ongetmaildefaultmailboxsettings",getMailMailbox:"ongetmailmailbox",setDefaultAccount:"onsetdefaultaccount",createMailMailboxSimple:"oncreatemailmailboxsimple",createMailMailboxOAuth:"oncreateMailMailboxOAuth",updateMailMailboxOAuth:"updateMailMailboxOAuth",createMailMailbox:"oncreatemailmailbox",updateMailMailbox:"onupdatemailmailbox",setMailMailboxState:"onsetmailmailboxstate",removeMailMessageAttachment:"onremovemailmessageattachment",sendMailMessage:"onsendmailmessage",sendMailReceipt:"onsendmailreceipt",saveMailMessage:"onsavemailmessage",saveMailTemplate:"onsavemailtemplate",searchEmails:"ongetSearchEmails",getMailContacts:"ongetMailContacts",getMailContactsByInfo:"ongetMailContactsByInfo",createMailContact:"oncreateMailContact",deleteMailContacts:"ondeleteMailContacts",updateMailContact:"onupdateMailContact",getMailAlerts:"ongetmailalerts",deleteMailAlert:"ondeletemailalert",moveMailConversations:"onmovemailconversations",restoreMailConversations:"onrestoremailconversations",removeMailConversations:"onremovemailconversations",markMailConversations:"onmarkmailconversations",getMailFilteredConversations:"ongetmailfilteredconversations",getMailDisplayImagesAddresses:"ongetmaildisplayimagesaddresses",createDisplayImagesAddress:"oncreatedisplayimagesaddress",removeDisplayImagesAddress:"onremovedisplayimagesaddress",getLinkedCrmEntitiesInfo:"ongetlinkedcrmentitiesinfo",linkChainToCrm:"onlinkchaintocrm",markChainAsCrmLinked:"onmarkchainascrmlinked",unmarkChainAsCrmLinked:"onunmarkchainascrmlinked",isConversationLinkedWithCrm:"ongetcrmlinked",exportMessageToCrm:"onexportmessagetocrm",getMailboxSignature:"ongetmailboxsignature",updateMailboxSignature:"onupdatemailboxsignature",updateMailboxAutoreply:"onupdatemailboxautoreply",exportAllAttachmentsToMyDocuments:"exportallattachmentstomydocuments",exportAllAttachmentsToDocuments:"exportallattachmentstodocuments",exportAttachmentToMyDocuments:"exportattachmenttomydocuments",exportAttachmentToDocuments:"exportAttachmentToDocuments",downloadAttachmentsAll:"downloadattachmentsall",setEMailInFolder:"onsetemailinfolder",getMailServer:"getmailserver",getMailServerFullInfo:"getmailserverfullinfo",getMailServerFreeDns:"getmailserverfreedns",getMailDomains:"getmaildomains",addMailDomain:"addmaildomain",removeMailDomain:"removemaildomain",addMailbox:"addmailbox",getMailboxes:"getmailboxes",removeMailbox:"removeMailbox",addMailBoxAlias:"addmailboxalias",updateMailbox:"updateMailbox",removeMailBoxAlias:"removemailboxalias",addMailGroup:"addmailgroup",addMailGroupAddress:"addmailgroupaddress",getMailGroups:"getmailgroups",removeMailGroup:"removemailgroup",removeMailGroupAddress:"removemailgroupaddress",isDomainExists:"isdomainexists",checkDomainOwnership:"checkdomainownership",getDomainDnsSettings:"getdomaindnssettings",createNotificationAddress:"createnotificationaddress",removeNotificationAddress:"removenotificationaddress",addCalendarBody:"addcalendarbody",setMailConversationEnabledFlag:"setmailconversationenabledflag",setMailAlwaysDisplayImagesFlag:"setmailalwaysdisplayimagesflag",setMailCacheUnreadMessagesFlag:"setmailcacheunreadmessagesflag",setMailEnableGoNextAfterMove:"setmailenablegonextaftermove",setMailEnableReplaceMessageBody:"setmailenablereplacemessagebody",getMailOperationStatus:"getmailoperationstatus",getMailUserFolders:"ongetmailuserfolders",createMailFolder:"oncreatemailfolder",updateMailFolder:"onupdatemailfolder",removeMailFolder:"onremovemailfolder",changeMailboxPassword:"changemailboxpassword",getRandomPassword:"getRandomPassword",isMailServerAddressExists:"ismailserveraddressexists",isMailServerAddressValid:"ismailserveraddressvalid",getMailFilters:"ongetmailfilters",createMailFilter:"oncreatemailfilter",updateMailFilter:"onupdatemailfilter",deleteMailFilter:"ondeletemailfilter",checkMailFilter:"oncheckmailfilter",applyMailFilter:"applymailfilter",getTalkUnreadMessages:"gettalkunreadmessages",addSubtask:"addsubtask",removeSubtask:"removesubtask",updateSubtask:"updateSubtask",moveSubtask:"moveSubtask",removePrjTask:"removePrjTask",removePrjTasks:"removePrjTasks",updatePrjTask:"updatePrjTask",updatePrjTaskStatus:"updatePrjTaskStatus",updatePrjTasksStatus:"updatePrjTasksStatus",addPrjTask:"addPrjTask",copyPrjTask:"copyPrjTask",addPrjMilestone:"addPrjMilestone",updatePrjMilestone:"updatePrjMilestone",updatePrjMilestoneStatus:"updatePrjMilestoneStatus",removePrjMilestone:"removePrjMilestone",updatePrjTeam:"updatePrjTeam",removePrjTeam:"removePrjTeam",getPrjProject:"getPrjProject",updatePrjProjectStatus:"updatePrjProjectStatus",removePrjProjects:"removePrjProjects",removePrjProject:"removePrjProject",getCrmContactsForProject:"getCrmContactsForProject",addCrmContactForProject:"addCrmContactForProject",removeCrmContactFromProject:"removeCrmContactFromProject",getDocFolder:"getDocFolder",getAutoCleanUp:"getAutoCleanUp"},a={},c=new CustomEvent(r),b,k;it();var ut=function(){if(p===!0)return undefined;p=!0;o.bind(null,ht);o.bind("event",ot);o.bind("extention",st)},ft=function(n,t,i){return c.bind(n,t,i)},et=function(n){return c.unbind(n)},w=function(n,t,i){c.call(n,t,i)};b=function(){return o.joint(),window.Teamlab};k=function(n,t){return o.start(n,t)};var ct=function(i,u){return n(r.getQuotas,i,t,"settings/quota.json",null,u)},lt=function(i,r){return n(null,i,t,"settings/recalculatequota.json",null,r)},at=function(i,r){return n(null,i,t,"settings/checkrecalculatequota.json",null,r)},vt=function(t,i,r){return n(null,t,u,"people/password.json",{email:i},r)},yt=function(t,r,u){return n(null,t,i,"people/thirdparty/linkaccount.json",r,u)},pt=function(t,i,u){return n(r.thirdPartyUnLinkAccount,t,f,"people/thirdparty/unlinkaccount.json",i,u)},wt=function(t,i,r){return n(null,t,u,"people.json",i,r),!0},bt=function(t,i){return n(null,null,u,"people/import/save.json",t,i),!0},kt=function(i){return n(null,null,t,"people/import/status.json",null,i),!0},dt=function(i,r,u){return n(null,i,t,"people/"+r+".json",null,u)},gt=function(i,r){var u=null,f,e;return r&&typeof r=="object"&&r.hasOwnProperty("filter")&&(u=r.filter.hasOwnProperty("status")?r.filter.status:u),f=s(r),e="people"+(u!==null?"/status/"+u:"")+".json",f&&(r.filter?r.filter.query=f:r.filter={query:f},e="people"+(u!==null?"/status/"+u:"")+"/search.json"),n(null,i,t,e,null,r)},ni=function(i,r){return n(null,i,t,"people/filter.json",null,r)},ti=function(i,r){return n(null,i,t,"people/simple/filter.json",null,r)},ii=function(t,i,r){return n(null,t,u,"people/birthdays/reminder.json",i,r)},ri=function(t,i,r){return n(null,t,u,"group.json",i,r),!0},ui=function(i,r,u){return n(null,i,t,"group/"+r+".json",null,u)},fi=function(i,r){return n(null,i,t,"group.json",null,r)},ei=function(t,r,u,f){return n(null,t,i,"group/"+r+".json",u,f)},oi=function(t,i,r){return n(null,t,f,"group/"+i+".json",null,r)},si=function(t,r,u,f){n(null,t,i,"people/"+r+".json",u,f)},hi=function(t,r,u,f){return n(null,t,i,"people/type/"+r+".json",u,f)},ci=function(t,r,u,f){return n(null,t,i,"people/status/"+r+".json",u,f)},li=function(i,r,u){return n(null,i,t,"people/"+r+"/photo.json",null,u)},ai=function(t,r,u,f){return n(null,t,i,"people/"+r+"/photo.json",u,f)},vi=function(t,i,r){return n(null,t,f,"people/"+i+"/photo.json",null,r)},yi=function(t,i,r,f){return n(null,t,u,"people/"+i+"/photo/thumbnails.json",r,f)},pi=function(t,r,u){return n(null,t,i,"people/invite.json",r,u)},wi=function(t,i,r){return n(null,t,f,"people/"+i+".json",null,r)},bi=function(t,r,u){return n(null,t,i,"people/delete.json",r,u)},ki=function(i,r){return n(null,null,t,"group/user/"+i+".json",null,r)},di=function(t,r){return n(null,t,i,"people/self/delete.json",null,r)},gi=function(t,i,r){return n(null,t,u,"community/blog.json",i,r),!0},nr=function(i,r,u){return n(null,i,t,"community/blog/"+r+".json",null,u)},tr=function(i,r){var u=s(r);return n(null,i,t,"community/blog"+(u?"/@search/"+u:"")+".json",null,r)},ir=function(t,i,r,f){return n(null,t,u,"community/forum/"+i+".json",r,f),!0},rr=function(i,r,u){return n(null,i,t,"community/forum/topic/"+r+".json",null,u)},ur=function(i,r){var u=s(r);return n(null,i,t,"community/forum"+(u?"/@search/"+u:"/topic/recent")+".json",null,r)},fr=function(i,r){return n(null,i,t,"community/forum.json",null,r)},er=function(t,i,r){return n(null,t,u,"community/forum.json",i,r)},or=function(t,i,r){return n(null,t,u,"community/event.json",i,r),!0},sr=function(i,r,u){return n(null,i,t,"community/event/"+r+".json",null,u)},hr=function(i,r){var u=s(r);return n(null,i,t,"community/event"+(u?"/@search/"+u:"")+".json",null,r)},cr=function(t,i,r){return n(null,t,u,"community/bookmark.json",i,r),!0},lr=function(i,r,u){return n(null,i,t,"community/bookmark/"+r+".json",null,u)},ar=function(i,r){var u=s(r);return n(null,i,t,"community/bookmark"+(u?"/@search/"+u:"/top/recent")+".json",null,r)},vr=function(t,i,r,f){return n(null,t,u,"community/forum/topic/"+i+".json",r,f),!0},yr=function(t,i,r,f){return n(null,t,u,"community/blog/"+i+"/comment.json",r,f),!0},pr=function(i,r,u){return n(null,i,t,"community/blog/"+r+"/comment.json",null,u)},wr=function(t,i,r,f){return n(null,t,u,"community/event/"+i+"/comment.json",r,f),!0},br=function(i,r,u){return n(null,i,t,"community/event/"+r+"/comment.json",null,u)},kr=function(t,i,r,f){return n(null,t,u,"community/event/"+i+"/subscribe.json",r,f),!0},dr=function(t,i,r,f){return n(null,t,u,"community/bookmark/"+i+"/comment.json",r,f),!0},gr=function(i,r,u){return n(null,i,t,"community/bookmark/"+r+"/comment.json",null,u)},nu=function(t,i,r){return n(null,t,u,"community/preview.json",i,r)},tu=function(t,r,u){return n(null,t,i,"project/"+r+"/follow.json",r,u),!0},iu=function(i,r){return n(null,i,t,"feed/filter.json",null,r)},ru=function(i,r){return n(null,i,t,"feed/newfeedscount.json",null,r)},uu=function(t,r){return n(null,t,i,"feed/read.json",null,r)},fu=function(t,r){return n(null,{},i,"project/settings.json",t,r)},eu=function(i){return n(null,{},t,"project/settings.json",null,i)},ou=function(i){return n(null,{},t,"project/status.json",null,i)},su=function(t,i){return n(null,null,f,"project/status/"+t+".json",t,i),!0},hu=function(t,i){return n(null,null,u,"project/status.json",{status:t},i),!0},cu=function(t,r){return n(null,null,i,"project/status.json",{newStatus:t},r),!0},lu=function(t,r){return n(null,null,i,"project/statuses.json",{statuses:t},r),!0},au=function(t,i){return n(null,t,"get","project/tag.json",null,i)},vu=function(t,i){return n(null,t,"get","project/securityinfo.json",null,i)},yu=function(t,i,r,u){return n(null,t,"get","project/tag/search.json",r,u)},pu=function(n,t,i,r){var u=null;switch(t.toLowerCase()){case"discussion":u=d}return typeof u=="function"?h(u(n,i,r)):!1},wu=function(t,i,f,e){return n(r.addSubtask,t,u,"project/task/"+i+".json",f,e),!0},bu=function(t,i,f,e){return n(r.addSubtask,t,u,"project/task/"+i+"/"+f+"/copy.json",null,e),!0},ku=function(t,u,f,e){return n(r.moveSubtask,t,i,"project/task/"+u+"/"+f+"/move.json",null,e),!0},du=function(t,u,f,e,o){var s=!1;for(var h in e)if(e.hasOwnProperty(h))switch(h){case"status":s=!0}return n(r.updateSubtask,t,i,"project/task/"+u+"/"+f+(s?"/status":"")+".json",e,o),!0},gu=function(t,i,u,e){return n(r.removeSubtask,t,f,"project/task/"+i+"/"+u+".json",u,e),!0},nf=function(t,i,f,e){return n(r.addPrjTask,t,u,"project/"+i+"/task.json",f,e),!0},tf=function(t,i,f,e){return n(r.copyPrjTask,t,u,"project/task/"+f.copyFrom+"/copy.json",f,e),!0},rf=function(t,i,r,f){n(null,t,u,"project/"+i+"/task/"+r+".json",null,f)},uf=function(t,u,f,e){var o=!1,s=!1,h=r.updatePrjTask;for(var c in f)if(f.hasOwnProperty(c))switch(c){case"status":o=!0;h=r.updatePrjTaskStatus;break;case"newMilestoneID":s=!0;f.milestoneid=f.newMilestoneID}return n(h,t,i,"project/task/"+u+(o?"/status":"")+(s?"/milestone":"")+".json",f,e),!0},ff=function(t,r){return n(null,null,i,"project/task/milestone.json",t,r),!0},ef=function(t,u){return n(r.updatePrjTasksStatus,null,i,"project/task/status.json",t,u),!0},sf=function(t,i,u){return n(r.removePrjTask,t,f,"project/task/"+i+".json",i,u),!0},hf=function(t,i){return n(r.removePrjTasks,null,f,"project/task.json",t,i),!0},cf=function(i,r,u){return n(null,i,t,"project/task/"+r+".json",null,u)},lf=function(i,r,u){return n(null,i,t,"project/task.json",r,u)},af=function(i,r){if(r&&typeof r=="object"&&r.hasOwnProperty("filter")){var u=r.filter;u.simple=!0}return n(null,i,t,"project/task/filter.json",null,r)},vf=function(i,r){return n(null,i,t,"project/task/filter/simple.json",null,r)},yf=function(i,r,u){return n(null,i,t,"project/task/"+r+"/files.json",null,u)},pf=function(t,r,u){return n(null,t,i,"project/task/"+r+"/subscribe.json",r,u)},wf=function(i,r,u){return n(null,i,t,"project/task/"+r+"/notify.json",null,u)},bf=function(t,i,r,f){return n(null,t,u,"project/task/"+i+"/link.json",r,f),!0},kf=function(t,i,r,u){return n(null,t,f,"project/task/"+i+"/link.json",r,u),!0},v=function(i,r,f){var e=r&&(typeof r=="number"||typeof r=="string");return n(null,i,e?t:u,"project"+(e?"/"+r:"")+"/team.json",e?null:{ids:r},f)},df=function(i,r){return n(null,null,t,"project/"+i+"/teamExcluded.json",{projectid:i},r)},gf=function(t,u,f,e){return n(r.updatePrjTeam,t,i,"project/"+u+"/team.json",f,e)},ne=function(t,r,u,f){return n(null,t,i,"project/"+r+"/team/security.json",u,f)},te=function(i,r,u){return n(null,i,t,"project/"+r+"/files.json",null,u)},ie=function(t,i,r,f,o){return o=o||{},typeof o=="function"&&(o={success:o}),o.hasOwnProperty("filter")||(o.filter={}),o.filter.hasOwnProperty("entityType")||(o.filter.entityType=r),n(null,t,u,"project/"+i+"/entityfiles.json",e(f)?{files:f}:f,o),!0},re=function(t,i,r,u,o){return o=o||{},typeof o=="function"&&(o={success:o}),o.hasOwnProperty("filter")||(o.filter={}),o.filter.hasOwnProperty("entityType")||(o.filter.entityType=r),n(null,t,f,"project/"+i+"/entityfiles"+(e(u)?"many":"")+".json",e(u)?{files:u}:{entityType:r,fileid:u},o),!0},ue=function(i,r,u,f){return f=f||{},typeof f=="function"&&(f={success:f}),f.hasOwnProperty("filter")||(f.filter={}),f.filter.hasOwnProperty("entityType")||(f.filter.entityType=u),n(null,i,t,"project/"+r+"/entityfiles.json",null,f)},fe=function(t,i,f,e){return n(r.addPrjMilestone,t,u,"project/"+i+"/milestone.json",f,e),!0},ee=function(t,u,f,e){var s=0,o=null,h=r.updatePrjMilestone;for(var c in f)if(f.hasOwnProperty(c)){s++;switch(c){case"status":h=r.updatePrjMilestoneStatus;o="status"}}return s>1&&(o=null),n(h,t,i,"project/milestone/"+u+(o?"/"+o:"")+".json",f,e),!0},oe=function(t,i){return n(r.removePrjMilestone,null,f,"project/milestone/"+t+".json",t,i),!0},se=function(t,i){return n(null,null,f,"project/milestone.json",t,i),!0},he=function(i,r,u){return n(null,i,t,"project/milestone/"+r+".json",null,u)},ce=function(i,r,u){var s,h;arguments.length<3&&(u=arguments[1],r=null);var f=null,e=r,o=f;switch(r){case"late":o=r;e=null}if(r instanceof Date&&(o=r.getFullYear()+"/"+(r.getMonth()+1),e=null),r=e,f=o,u&&typeof u=="object"&&u.hasOwnProperty("filter")){s=u.filter;s.simple=!0;for(h in s)switch(h){case"participant":case"tag":case"projectId":case"status":case"deadlineStart":case"deadlineStop":case"sortBy":case"sortOrder":f=f||"filter"}}return n(null,i,t,"project"+(r?"/"+r:"")+"/milestone"+(f?"/"+f:"")+".json",null,u)},le=function(t,i,r,f){return n(null,t,u,"project/"+i+"/message.json",r,f),!0},ae=function(t,r,u,f){return n(null,t,i,"project/message/"+r+".json",u,f),!0},ve=function(t,r,u,f){return n(null,t,i,"project/message/"+r+"/status.json",u,f),!0},ye=function(t,i,r){return n(null,t,f,"project/message/"+i+".json",i,r),!0},pe=function(i,r,u){return n(null,i,t,"project/message/"+r+".json",null,u)},we=function(i,r){var u=null,f,e;if(r&&typeof r=="object"&&r.hasOwnProperty("filter")){f=r.filter;f.simple=!0;for(e in f)switch(e){case"participant":case"tag":case"projectId":case"sortBy":case"sortOrder":u=u||"filter"}}return n(null,i,t,"project/message"+(u?"/"+u:"")+".json",null,r)},be=function(t,r,u){return n(null,t,i,"project/message/"+r+"/subscribe.json",r,u)},ke=function(i,r,u){return n(null,i,t,"project/message/"+r+"/subscribes.json",r,u)},de=function(t,i,r){return n(null,t,u,"project/withSecurity.json",i,r),!0},ge=function(t,r,u,f){var o=0,e=null;for(var s in u)if(u.hasOwnProperty(s)){o++;switch(s){case"tags":e="tag";break;case"status":e="status"}}return o>1&&(e="withSecurityInfo"),n(null,t,i,"project/"+r+(e?"/"+e:"")+".json",u,f),!0},no=function(t,u,f,e){return n(r.updatePrjProjectStatus,t,i,"project/"+u+"/status.json",f,e),!0},to=function(t,r,u){return n(null,null,i,"project/"+t+"/tags.json",r,u),!0},l=function(n,t){var i=ASC.Resources.Master.ApiPath+"calendar/caldavprojcal.json",r={calendarId:"Project_"+n,team:t};jq.ajax({type:"delete",url:i,data:r,complete:function(){}})},io=function(n){jq.ajax({type:"get",url:ASC.Resources.Master.ApiPath+"calendar/"+n+"/caldavurl.json",complete:function(n){var t=jq.evalJSON(n.responseText);t.status!=0&&console.log("Get caldav url error")}})},ro=function(i,r){n(null,i,t,"settings/carddavurl",null,r)},uo=function(t,i){n(null,t,f,"settings/deletebook",null,i)},fo=function(t,i){return v({},t,function(n,i){l(t,jq.map(i,function(n){return n.id}))}),n(r.removePrjProject,null,f,"project/"+t+".json",t,i),!0},eo=function(t,i){for(var u=0;u<t.projectids.length;u++)(function(){var n=t.projectids[u];v({},n,function(t,i){l(n,jq.map(i,function(n){return n.id}))})})();return n(r.removePrjProjects,null,f,"project.json",t,i),!0},oo=function(t,r,u,f){return n(null,t,i,"project/"+r+"/follow.json",u,f)},so=function(i,u,f){return n(r.getPrjProject,i,t,"project/"+u+".json",null,f)},y=function(i,r,u){var f,o,e;if(arguments.length<4&&(u=r,r=null),f=null,u&&typeof u=="object"&&u.hasOwnProperty("filter")){f=u.filter;f.simple=!0;for(o in f)switch(o){case"tag":case"follow":case"status":case"participant":case"sortBy":case"sortOrder":r=r||"filter"}}return e=s(u),n(null,i,t,"project"+(r?"/"+r:"")+(e?"/@search/"+e:"")+".json",null,u)},ho=function(n,t){return y(n,"@self",t)},co=function(n,t){return y(n,"@follow",t)},lo=function(i,r,u){return n(null,i,t,"project/contact/"+r+".json",null,u)},ao=function(t,i,r,f){return n(null,t,u,"project/"+i+"/contact.json",r,f)},vo=function(t,i,r,u){return n(null,t,f,"project/"+i+"/contact.json",r,u)},yo=function(t,i,r,f){return r.parentid||(r.parentid="00000000-0000-0000-0000-000000000000"),n(null,t,u,"project/task/"+i+"/comment.json",r,f),!0},po=function(i,r,u){return n(null,i,t,"project/task/"+r+"/comment.json",null,u)},wo=function(t,i,r,f){return r.parentid||(r.parentid="00000000-0000-0000-0000-000000000000"),n(null,t,u,"project/message/"+i+"/comment.json",r,f),!0},d=function(i,r,u){return n(null,i,t,"project/message/"+r+"/comment.json",null,u)},bo=function(t,i,r){return n(null,t,u,"project/message/discussion/preview.json",{htmltext:i},r)},ko=function(t,i,r,f){return n(null,t,u,"project/comment/preview.json",{commentid:i,htmltext:r},f)},go=function(t,i,r,f){return n(null,t,u,"community/wiki/comment/preview.json",{commentid:i,htmltext:r},f)},ns=function(t,i,r,f){return n(null,t,u,"community/blog/comment/preview.json",{commentid:i,htmltext:r},f)},ts=function(t,i,r,f){return n(null,t,u,"community/event/comment/preview.json",{commentid:i,htmltext:r},f)},is=function(t,i,r,f){return n(null,t,u,"community/bookmark/comment/preview.json",{commentid:i,htmltext:r},f)},rs=function(t,i,r){return n(null,t,f,"project/comment/"+i+".json",null,r),!0},us=function(t,i,r){return n(null,t,f,"community/wiki/comment/"+i+".json",null,r),!0},fs=function(t,i,r){return n(null,t,f,"community/blog/comment/"+i+".json",null,r),!0},es=function(t,i,r){return n(null,t,f,"community/event/comment/"+i+".json",null,r),!0},os=function(t,i,r){return n(null,t,f,"community/bookmark/comment/"+i+".json",null,r),!0},ss=function(t,i,f){return n(r.addPrjComment,t,u,"project/comment.json",i,f),!0},hs=function(t,i,r){return n(null,t,u,"community/wiki/comment.json",i,r),!0},cs=function(t,i,r){return n(null,t,u,"community/blog/comment.json",i,r),!0},ls=function(t,i,r){return n(null,t,u,"community/event/comment.json",i,r),!0},as=function(t,i,r){return n(null,t,u,"community/bookmark/comment.json",i,r),!0},vs=function(t,r,u,f){return n(null,t,i,"project/comment/"+r+".json",u,f),!0},ys=function(t,r,u,f){return n(null,t,i,"community/wiki/comment/"+r+".json",u,f),!0},ps=function(t,r,u,f){return n(null,t,i,"community/blog/comment/"+r+".json",u,f),!0},ws=function(t,r,u,f){return n(null,t,i,"community/event/comment/"+r+".json",u,f),!0},bs=function(t,r,u,f){return n(null,t,i,"community/bookmark/comment/"+r+".json",u,f),!0},ks=function(t,r,u){return n(null,t,i,"portal/fcke/comment/removecomplete.json",r,u),!0},ds=function(t,r,u){return n(null,t,i,"portal/fcke/comment/cancelcomplete.json",r,u),!0},gs=function(t,r,u){return n(null,t,i,"portal/fcke/comment/editcomplete.json",r,u),!0},nh=function(t,r,u){return n(null,t,i,"portal/getshortenlink.json",{link:r},u)},th=function(t,r,u){return n(null,t,i,"portal/portalrename.json",{alias:r},u),!0},ih=function(t,i,r,f){return n(null,t,u,"project/"+i+"/team.json",r,f),!0},rh=function(t,i,u,e){return l(i,t.userId),n(r.removePrjTeam,t,f,"project/"+i+"/team.json",u,e),!0},uh=function(i,r,u){return n(null,i,t,"project/"+r+"/team.json",null,u)},fh=function(i,r,u){return n(null,i,t,"project/"+r+"/entityfiles.json",null,u)},eh=function(i,r,u){return n(null,i,t,"project/"+r+"/order.json",null,u)},oh=function(t,r,u,f){return n(null,t,i,"project/"+r+"/order.json",u,f),!0},sh=function(t,i,r,f){return n(null,t,u,"project/task/"+i+"/time.json",r,f),!0},hh=function(n,t){return g(n,null,t)},ch=function(i,r,u){return n(null,i,t,"project/"+r+"/time/total.json",null,u)},g=function(i,r,u){var f,h;if(!r||!u){var s=null,e=null,o=null;for(f=2,h=arguments.length;f<h;f++)o=o||(typeof arguments[f]=="function"||typeof arguments[f]=="object"?arguments[f]:o),e=e||(isFinite(+arguments[f])?+arguments[f]:e);u=o;r=e}return u&&typeof u=="object"&&u.hasOwnProperty("filter")&&(s=u.filter),n(null,i,t,"project"+(r?"/task/"+r:"")+"/time"+(s?"/filter":"")+".json",null,u)},lh=function(i,r){var u=null;return r&&typeof r=="object"&&r.hasOwnProperty("filter")&&(u=r.filter),n(null,i,t,"project/time/filter/total.json",null,r)},ah=function(t,u,f,e){return n(r.updatePrjTime,t,i,"project/time/"+u+".json",f,e),!0},vh=function(t,r,u){return n(null,t,i,"project/time/times/status.json",r,u),!0},yh=function(t,i,u){return n(r.removePrjTime,t,f,"project/time/times/remove.json",i,u),!0},ph=function(i,r){return n(null,i,t,"project/template.json",null,r),!0},wh=function(i,r,u){return n(null,i,t,"project/template/"+r+".json",null,u),!0},bh=function(t,r,u,f){return n(null,t,i,"project/template/"+r+".json",u,f),!0},kh=function(t,i,r){return n(null,t,u,"project/template.json",i,r),!0},dh=function(t,i,r){return n(null,t,f,"project/template/"+i+".json",null,r),!0},gh=function(i,r){return n(null,i,t,"project/activities/filter.json",null,r)},nc=function(t,i,r){return n(null,t,u,"project/import/quota.json",i,r)},tc=function(t,i,r){return n(null,t,u,"project/import.json",i,r)},ic=function(i,r){return n(null,i,t,"project/import.json",null,r)},rc=function(t,i,r){return n(null,t,u,"project/import/projects.json",i,r)},uc=function(i,r,u){return n(null,i,t,"project/report/"+r+".json",null,u)},fc=function(t,i,r){return n(null,t,u,"project/report.json",i,r)},ec=function(t,r,u,f){return n(null,t,i,"project/report/"+r+".json",u,f)},oc=function(t,i,r){return n(null,t,f,"project/report/"+i+".json",null,r)},sc=function(t,i){n(null,null,u,"project/report/create.json",t,i)},hc=function(i){n(null,null,t,"project/report/terminate.json",null,i)},cc=function(i){n(null,null,t,"project/report/status.json",null,i)},lc=function(i){n(null,null,t,"project/report/files.json",null,i)},ac=function(t,i){return n(null,null,f,"project/report/files/"+t+".json",null,i)},vc=function(n,t,i,r){return o.uploader(null,n,"file","project/"+t+"/entityfiles/upload.tml",i,r)},yc=function(t,i,r){return n(null,t,u,"project/tag.json",i,r),!0},pc=function(n,t,i,r){return o.uploader(null,n,"file","files/"+t+"/upload.tml",i,r)},wc=function(t,i,r,f,e){return n(null,t,u,"files/"+i+(r?"/"+r:"")+".json",f,e),!0},bc=function(t,r,u){return n(null,t,i,"files/"+t.fileId+"/update.json?encrypted="+t.encrypted+"&forcesave="+t.forcesave,r,u)},kc=function(i,r,u){return n(null,i,t,"files/file/"+r+".json",null,u)},dc=function(t,i,r,f){return n(null,t,u,"files/"+i+".json",r,f),!0},gc=function(i,u,f){return n(r.getDocFolder,i,t,"files/"+u+".json",null,f)},nl=function(t,i,r){return n(null,t,f,"files/file/"+i+".json",null,r)},tl=function(t,i,r,f){return n(null,t,u,"files/"+i+"/upload/create_session.json",r,f)},il=function(i,r){return n(null,null,t,"files/folder/"+i+"/path.json",null,r)},rl=function(i,r){return n(null,null,t,"files/file/"+i+"/share.json",null,r)},ul=function(t,r,u){return n(null,null,i,"files/"+t+"/sharedlink.json",r,u)},fl=function(t,r){return n(null,null,i,"files/fileops/copy.json",t,r)},el=function(i){return n(null,null,t,"files/fileops.json",null,i)},ol=function(t,r,u,f){return n(null,null,i,"files/docservice.json",{docServiceUrl:t,docServiceUrlInternal:r,docServiceUrlPortal:u},f)},sl=function(t,r){return n(null,null,i,"files/storeoriginal.json",{set:t},r)},hl=function(t,r){return n(null,null,i,"files/hideconfirmconvert.json",{save:t},r)},cl=function(t,r){return n(null,null,i,"files/displayrecent.json",{set:t},r)},ll=function(t,r){return n(null,null,i,"files/settings/favorites.json",{set:t},r)},al=function(t,i,r){return n(null,t,u,"files/favorites.json",i,r),!0},vl=function(t,i,r){return n(null,t,f,"files/favorites.json",i,r),!0},yl=function(t,r){return n(null,null,i,"files/settings/templates.json",{set:t},r)},pl=function(t,i,r){return n(null,t,u,"files/templates.json",i,r),!0},wl=function(t,i,r){return n(null,t,f,"files/templates.json",i,r),!0},bl=function(t,i,r){return n(null,t,u,"files/thumbnails.json",i,r),!0},kl=function(t,i,r,f){return n(null,t,u,"files/"+i+"/file.json",{title:r.fileTitle,templateId:r.templateId},f),!0},dl=function(t,r){return n(null,null,i,"files/settings/downloadtargz.json",{set:t},r)},gl=function(t,r,u){return n(null,null,i,"files/settings/autocleanup.json",{set:t,gap:r},u)},na=function(t,r){return n(null,null,i,"files/settings/dafaultaccessrights.json",{value:t},r)},ta=function(i,r,u){return n(null,i,t,"files/"+r+"/properties.json",null,u),!0},ia=function(t,r,u,f){return n(null,t,i,"files/"+r+"/properties.json",u,f),!0},ra=function(t,r,u){return n(null,t,i,"files/batch/properties.json",r,u),!0},ua=function(t,i,r,f){return n(null,t,u,"files/file/"+i+"/copyas.json",r,f)},fa=function(n,t,i,r,u){return o.uploader(null,n,"file","crm/"+t+"/"+i+"/files/upload.tml",r,u)},ea=function(i,r,u){return n(null,i,t,"crm/contact/"+r+"/data.json",null,u),!0},oa=function(t,i,r,f){return n(null,t,u,"crm/contact/"+i+"/data.json",r,f),!0},sa=function(t,r,u,f){return n(null,t,i,"crm/contact/"+r+"/data/"+u.id+".json",u,f),!0},ha=function(t,i,r,u){return n(null,t,f,"crm/contact/"+i+"/data/"+r+".json",null,u),!0},ca=function(t,i,r,f){return n(null,t,u,"crm/contact/"+i+"/batch.json",e(r)?{data:r}:r,f),!0},la=function(t,r,u,f){return n(null,t,i,"crm/contact/"+r+"/batch.json",e(u)?{data:u}:u,f),!0},aa=function(t,i,r,f){return n(null,t,u,"crm/contact/"+i+"/data.json",r,f),!0},va=function(t,i,r,f,e){return n(null,t,u,"crm/"+i+"/"+r+"/files/text.json",f,e),!0},ya=function(n,t,i,r){return t===!0?nt(n,i,r):tt(n,i,r)},nt=function(t,i,r){return n(null,t,u,"crm/contact/company"+(e(i)?"/quick":"")+".json",e(i)?{data:i}:i,r),!0},pa=function(t,r,u,f){return n(null,t,i,"crm/contact/company/"+r+".json",u,f),!0},wa=function(t,r,u,f){return n(null,t,i,"crm/contact/company/"+r+"/status.json",u,f),!0},ba=function(t,r,u,f){return n(null,t,i,"crm/contact/person/"+r+"/status.json",u,f),!0},ka=function(t,r,u,f){return n(null,t,i,"crm/contact/"+r+"/status.json",u,f),!0},tt=function(t,i,r){return n(null,t,u,"crm/contact/person"+(e(i)?"/quick":"")+".json",e(i)?{data:i}:i,r),!0},da=function(t,r,u,f){return n(null,t,i,"crm/contact/person/"+r+".json",u,f),!0},ga=function(t,r,u){var e=r&&(typeof r=="number"||typeof r=="string"),o=r&&typeof r=="object";return n(null,t,e?f:i,"crm/contact"+(e?"/"+r:"")+".json",o?{contactids:r}:null,u),!0},nv=function(t,r,u){return n(null,t,i,"crm/contact/merge.json",r,u),!0},tv=function(i,u,f){return n(r.getCrmContactsForProject,i,t,"crm/contact/project/"+u+".json",null,f)},iv=function(t,i,r,f,e){return n(null,t,u,"crm/"+i+(typeof r=="object"?"/taglist":"/"+r+"/tag")+".json",{entityid:r,tagName:f},e),!0},rv=function(t,i,r,f,e){return n(null,t,u,"crm/"+i+"/"+r+"/tag/group.json",{entityid:r,entityType:i,tagName:f},e),!0},uv=function(t,i,r,u,e){return n(null,t,f,"crm/"+i+"/"+r+"/tag/group.json",{entityid:r,entityType:i,tagName:u},e),!0},fv=function(t,i,r,u,e){return n(null,t,f,"crm/"+i+"/"+r+"/tag.json",{tagName:u},e),!0},ev=function(i,r,u,f){return n(null,i,t,"crm/"+r+"/"+u+"/tag.json",null,f)},ov=function(i,r,u){return n(null,i,t,"crm/"+r+"/tag.json",null,u),!0},sv=function(t,i,r,f){return n(null,t,u,"crm/"+i+"/tag.json",{entityType:i,tagName:r},f),!0},hv=function(t,i,r,u){return n(null,t,f,"crm/"+i+"/tag.json",{tagName:r},u),!0},cv=function(t,i,r){return n(null,t,f,"crm/"+i+"/tag/unused.json",null,r),!0},lv=function(i,r,u){return n(null,i,t,"crm/"+r+"/customfield/definitions.json",null,u),!0},av=function(t,i,r,f){return n(null,t,u,"crm/"+i+"/customfield.json",r,f),!0},vv=function(t,r,u,f,e){return n(null,t,i,"crm/"+r+"/customfield/"+u+".json",f,e),!0},yv=function(t,i,r,u){return n(null,t,f,"crm/"+i+"/customfield/"+r+".json",null,u),!0},pv=function(t,r,u,f){return n(null,t,i,"crm/"+r+"/customfield/reorder.json",{fieldids:u,entityType:r},f),!0},wv=function(i,r){return n(null,i,t,"crm/opportunity/stage.json",null,r),!0},bv=function(t,i,r){return n(null,t,u,"crm/opportunity/stage.json",i,r),!0},kv=function(t,r,u,f){return n(null,t,i,"crm/opportunity/stage/"+r+".json",u,f),!0},dv=function(t,r,u,f){return n(null,t,i,"crm/opportunity/stage/"+r+"/color.json",u,f),!0},gv=function(t,i,r){return n(null,t,f,"crm/opportunity/stage/"+i+".json",null,r),!0},ny=function(t,r,u){return n(null,t,i,"crm/opportunity/stage/reorder.json",{ids:r},u),!0},ty=function(t,i,r){return n(null,t,u,"crm/contact/status.json",i,r),!0},iy=function(t,r,u,f){return n(null,t,i,"crm/contact/status/"+r+".json",u,f),!0},ry=function(t,r,u,f){return n(null,t,i,"crm/contact/status/"+r+"/color.json",u,f),!0},uy=function(t,i,r){return n(null,t,f,"crm/contact/status/"+i+".json",null,r),!0},fy=function(t,i,r){return n(null,t,u,"crm/contact/type.json",i,r),!0},ey=function(t,r,u,f){return n(null,t,i,"crm/contact/type/"+r+".json",u,f),!0},oy=function(t,i,r){return n(null,t,f,"crm/contact/type/"+i+".json",null,r),!0},sy=function(i,r,u){var f="";switch(r){case 1:f="crm/contact/status.json";break;case 2:f="crm/task/category.json";break;case 3:f="crm/history/category.json";break;case 4:f="crm/contact/type.json";break;default:return!1}return n(null,i,t,f,null,u),!0},hy=function(t,i,r,f){var e="";switch(i){case 1:e="crm/contact/status.json";break;case 2:e="crm/task/category.json";break;case 3:e="crm/history/category.json";break;case 4:e="crm/contact/type.json";break;default:return!1}return n(null,t,u,e,r,f),!0},cy=function(t,r,u,f,e){var o="";switch(r){case 1:o="crm/contact/status/"+u+".json";break;case 2:o="crm/task/category/"+u+".json";break;case 3:o="crm/history/category/"+u+".json";break;case 4:o="crm/contact/type/"+u+".json";break;default:return!1}return n(null,t,i,o,f,e),!0},ly=function(t,r,u,f,e){var o="";switch(r){case 2:o="crm/task/category/"+u+"/icon.json";break;case 3:o="crm/history/category/"+u+"/icon.json";break;default:return!1}return n(null,t,i,o,f,e),!0},ay=function(t,i,r,u,e){var o="",s={newcategoryid:u};switch(i){case 1:o="crm/contact/status/"+r+".json";break;case 2:o="crm/task/category/"+r+".json";break;case 3:o="crm/history/category/"+r+".json";break;case 4:o="crm/contact/type/"+r+".json";break;default:return!1}return n(null,t,f,o,s,e),!0},vy=function(t,r,u,f){var e="";switch(r){case 1:e="crm/contact/status/reorder.json";break;case 2:e="crm/task/category/reorder.json";break;case 3:e="crm/history/category/reorder.json";break;case 4:e="crm/contact/type/reorder.json";break;default:return!1}return n(null,t,i,e,{titles:u},f),!0},yy=function(t,i,r){return n(null,t,u,"crm/task.json",i,r),!0},py=function(t,i,r){return n(null,t,u,"crm/contact/task/group.json",i,r),!0},wy=function(i,r,u){return n(null,i,t,"crm/task/"+r+".json",null,u)},by=function(t,r,u,f){var e=u.hasOwnProperty("isClosed");return e?n(null,t,i,!u.isClosed?"crm/task/"+r+"/reopen.json":"crm/task/"+r+"/close.json",u,f):n(null,t,i,"crm/task/"+r+".json",u,f),!0},ky=function(t,i,r){return n(null,t,f,"crm/task/"+i+".json",null,r),!0},dy=function(t,i,f,e,o,s){n(r.addCrmContactForProject,t,u,"crm/contact/"+e+"/project/"+f+".json",o,s)},gy=function(t,i,r,f){n(null,t,u,"crm/contact/project/"+i+".json",r,f)},np=function(t,i,u,e,o){n(r.removeCrmContactFromProject,t,f,"crm/contact/"+e+"/project/"+u+".json",null,o)},tp=function(t,i,r,f){n(null,t,u,"crm/contact/"+i+"/opportunity/"+r+".json",{contactid:i,opportunityid:r},f)},ip=function(t,i,r,u){n(null,t,f,"crm/contact/"+i+"/opportunity/"+r+".json",{contactid:i,opportunityid:r},u)},rp=function(t,i,r,f,e,o){n(null,t,u,"crm/"+i+"/"+r+"/contact"+(i==="opportunity"?"/"+f:"")+".json",e,o)},up=function(t,i,r,u,e){n(null,t,f,"crm/"+i+"/"+r+"/contact/"+u+".json",null,e)},fp=function(i,r,u,f){return n(null,i,t,"crm/"+r+"/"+u+"/contact.json",null,f)},ep=function(t,i,r,f,e,o){n(null,t,u,"crm/contact/"+i+"/"+r+"/person.json",e,o)},op=function(t,i,r,u,e){n(null,t,f,"crm/contact/"+i+"/"+r+"/person.json",{personid:u},e)},sp=function(i,r,u,f){return n(null,i,t,"crm/contact/"+r+"/"+u+"/person.json",null,f)},hp=function(n,t,i,r){var u=null;switch(t){case"company":u=sp;break;default:u=fp}return u?h(u(n,t,i,r)):!1},cp=function(n,t,i,r,u,f){var e=null;switch(t){case"company":e=ep;break;case"project":e=dy;break;default:e=rp}return e?h(e(n,t,i,r,u,f)):!1},lp=function(n,t,i,r,u){var f=null;switch(t){case"company":f=op;break;case"project":f=np;break;default:f=up}return f?h(f(n,t,i,r,u)):!1},ap=function(i,r){return n(null,i,t,"crm/case/filter.json",null,r)},vp=function(i,r){return n(null,i,t,"crm/case/byprefix.json",null,r)},yp=function(t,r,u){var e=r&&(typeof r=="number"||typeof r=="string"),o=r&&typeof r=="object";return n(null,t,e?f:i,"crm/case"+(e?"/"+r:"")+".json",o?{casesids:r}:null,u),!0},pp=function(t,r,u,f){var e=u.hasOwnProperty("isClosed");return e?n(null,t,i,!u.isClosed?"crm/case/"+r+"/reopen.json":"crm/case/"+r+"/close.json",u,f):n(null,t,i,"crm/case/"+r+".json",u,f),!0},wp=function(i,r){return n(null,i,t,"crm/contact/filter.json",null,r)},bp=function(i,r){return n(null,i,t,"crm/contact/simple/filter.json",null,r)},kp=function(i,r,u){return n(null,i,t,"crm/contact/mail.json",typeof r=="number"||typeof r=="string"?{contactids:[r]}:r,u)},dp=function(i,r){return n(null,i,t,"crm/contact/byprefix.json",null,r)},gp=function(i,r,u){return n(null,i,t,"crm/contact/"+r+".json",null,u)},nw=function(i,r){return n(null,i,t,"crm/task/filter.json",null,r)},tw=function(i,r,u){return n(null,i,t,"crm/opportunity/"+r+".json",null,u)},iw=function(i,r,u){return n(null,i,t,"crm/case/"+r+".json",null,u)},rw=function(i,r,u){return n(null,i,t,"crm/contact/bycontactinfo.json",r,u)},uw=function(i,r){return n(null,i,t,"crm/opportunity/filter.json",null,r)},fw=function(i,r,u){return n(null,i,t,"crm/opportunity/bycontact/"+r+".json",null,u)},ew=function(i,r){return n(null,i,t,"crm/opportunity/byprefix.json",null,r)},ow=function(t,r,u){var e=r&&(typeof r=="number"||typeof r=="string"),o=r&&typeof r=="object";return n(null,t,e?f:i,"crm/opportunity"+(e?"/"+r:"")+".json",o?{opportunityids:r}:null,u),!0},sw=function(t,r,u,f){n(null,t,i,"crm/opportunity/"+r+"/stage/"+u+".json",{opportunityid:r,stageid:u},f)},hw=function(i,r,u){n(null,i,t,"crm/settings/currency/convert.json",r,u)},cw=function(i,r,u){n(null,i,t,"crm/settings/currency/summarytable.json",{currency:r},u)},lw=function(t,r,u){n(null,t,i,"crm/settings/currency.json",{currency:r},u)},aw=function(t,i,r,f){n(null,t,u,"crm/currency/setrates.json",{currency:i,rates:r},f)},vw=function(t,i,r){n(null,t,u,"crm/currency/addrates.json",{rates:i},r)},yw=function(t,r,u){n(null,t,i,"crm/contact/status/settings.json",{changeContactStatusGroupAuto:r},u)},pw=function(t,r,u){n(null,t,i,"crm/contact/tag/settings.json",{addTagToContactGroupAuto:r},u)},ww=function(t,r,u){n(null,t,i,"crm/contact/mailtohistory/settings.json",{writeMailToHistoryAuto:r},u)},bw=function(t,r,u){n(null,t,i,"crm/settings/organisation/base.json",{companyName:r},u)},kw=function(t,r,u){n(null,t,i,"crm/settings/organisation/address.json",r,u)},dw=function(t,r,u){n(null,t,i,"crm/settings/organisation/logo.json",r,u)},gw=function(i,r,u){n(null,i,t,"crm/settings/organisation/logo.json",{id:r},u)},nb=function(t,r){return n(null,t,i,"crm/settings/webformkey/change.json",null,r)},tb=function(t,i,r){n(null,t,u,"crm/contact/mailsmtp/send.json",i,r)},ib=function(t,i,r){n(null,t,u,"crm/contact/mailsmtp/preview.json",i,r)},rb=function(i,r){n(null,i,t,"crm/contact/mailsmtp/status.json",null,r)},ub=function(t,r){n(null,t,i,"crm/contact/mailsmtp/cancel.json",null,r)},fb=function(t,i,r){n(null,t,u,"crm/history.json",i,r)},eb=function(t,i,r){n(null,t,f,"crm/history/"+i+".json",null,r)},ob=function(i,r){return n(null,i,t,"crm/history/filter.json",null,r)},sb=function(t,i,r){return n(null,t,f,"crm/files/"+i+".json",null,r),!0},hb=function(i,r,u){return n(null,i,t,"crm/files/"+r+".json",null,u)},cb=function(i,r,u){return n(null,i,t,"crm/contact/"+r+"/access.json",null,u)},lb=function(t,r,u,f){return u&&f||(f=u,u=r,r=null),n(null,t,i,"crm/contact"+(r?"/"+r:"")+"/access.json",u,f),!0},ab=function(t,r,u,f){return u&&f||(f=u,u=r,r=null),n(null,t,i,"crm/case"+(r?"/"+r:"")+"/access.json",u,f),!0},vb=function(t,r,u,f){return u&&f||(f=u,u=r,r=null),n(null,t,i,"crm/opportunity"+(r?"/"+r:"")+"/access.json",u,f),!0},yb=function(t,i,r,f,o){return f&&typeof f=="object"&&!f.hasOwnProperty("entityType")&&(f.entityType=r),n(null,t,u,"crm"+(r?"/"+r:"")+"/"+i+"/files.json",e(f)?{entityType:r,entityid:i,fileids:f}:f,o),!0},pb=function(t,i,r){return n(null,t,f,"crm/files/"+i+".json",null,r),!0},wb=function(i,r,u,f){return n(null,i,t,"crm"+(u?"/"+u:"")+"/"+r+"/files.json",null,f)},bb=function(i,r){return n(null,i,t,"crm/task/category.json",null,r)},kb=function(t,i,r){return n(null,t,u,"crm/"+i.entityType+"/tasktemplatecontainer.json",i,r),!0},db=function(t,r,u,f){return n(null,t,i,"crm/tasktemplatecontainer/"+r+".json",u,f),!0},gb=function(t,i,r){return n(null,t,f,"crm/tasktemplatecontainer/"+i+".json",null,r),!0},nk=function(i,r,u){return n(null,i,t,"crm/tasktemplatecontainer/"+r+".json",null,u)},tk=function(i,r,u){return n(null,i,t,"crm/"+r+"/tasktemplatecontainer.json",null,u)},ik=function(t,i,r){return n(null,t,u,"crm/tasktemplatecontainer/"+i.containerid+"/tasktemplate.json",i,r),!0},rk=function(t,r,u){return n(null,t,i,"crm/tasktemplatecontainer/"+r.containerid+"/tasktemplate.json",r,u),!0},uk=function(t,i,r){return n(null,t,f,"crm/tasktemplatecontainer/tasktemplate/"+i+".json",null,r),!0},fk=function(i,r,u){return n(null,i,t,"crm/tasktemplatecontainer/tasktemplate/"+r+".json",null,u)},ek=function(i,r,u){return n(null,i,t,"crm/tasktemplatecontainer/"+r+"/tasktemplate.json",null,u)},ok=function(i,r){return n(null,i,t,"crm/invoice/filter.json",null,r)},sk=function(i,r,u,f){return n(null,i,t,"crm/"+r+"/invoicelist/"+u+".json",null,f)},hk=function(t,r,u,f){return n(null,t,i,"crm/invoice/status/"+r+".json",{invoiceids:u},f)},ck=function(i,r,u){return n(null,i,t,"crm/invoice/bynumber.json",{number:r},u)},lk=function(i,r,u){return n(null,i,t,"crm/invoice/bynumber/exist.json",{number:r},u)},ak=function(i,r){return n(null,i,t,"crm/invoiceitem/filter.json",null,r)},vk=function(t,i,r){return n(null,t,u,"crm/invoiceitem.json",i,r),!0},yk=function(t,r,u,f){return n(null,t,i,"crm/invoiceitem/"+r+".json",u,f),!0},pk=function(t,i,r){return n(null,t,f,"crm/invoiceitem"+(i&&(typeof i=="number"||typeof i=="string")?"/"+i:"")+".json",i&&typeof i=="object"?{ids:i}:null,r),!0},wk=function(i,r){return n(null,i,t,"crm/invoice/tax.json",null,r)},bk=function(t,i,r){return n(null,t,u,"crm/invoice/tax.json",i,r),!0},kk=function(t,r,u,f){return n(null,t,i,"crm/invoice/tax/"+r+".json",u,f),!0},dk=function(t,i,r){return n(null,t,f,"crm/invoice/tax/"+i+".json",null,r),!0},gk=function(i,r,u){return n(null,i,t,"crm/invoice/"+r+".json",null,u)},nd=function(i,r){return n(null,i,t,"crm/invoice/sample.json",null,r)},td=function(i,r,u){return n(null,i,t,"crm/invoice/jsondata/"+r+".json",null,u)},id=function(t,i,r){return n(null,t,u,"crm/invoice.json",i,r),!0},rd=function(t,r,u,f){return n(null,t,i,"crm/invoice/"+r+".json",u,f),!0},ud=function(t,i,r){return n(null,t,f,"crm/invoice"+(i&&(typeof i=="number"||typeof i=="string")?"/"+i:"")+".json",i&&typeof i=="object"?{invoiceids:i}:null,r),!0},fd=function(i,r,u){return n(null,i,t,"crm/invoice/"+r+"/pdf.json",null,u),!0},ed=function(t,i,r){return n(null,t,u,"crm/invoice/converter/data.json",i,r),!0},od=function(t,i,r){return n(null,t,u,"crm/invoiceline.json",i,r),!0},sd=function(t,r,u,f){return n(null,t,i,"crm/invoiceline/"+r+".json",u,f),!0},hd=function(t,i,r){return n(null,t,f,"crm/invoiceline/"+i+".json",null,r),!0},cd=function(i,r){return n(null,i,t,"crm/invoice/settings.json",null,r)},ld=function(t,r,u){return n(null,t,i,"crm/invoice/settings/name.json",r,u),!0},ad=function(t,r,u){return n(null,t,i,"crm/invoice/settings/terms.json",r,u),!0},vd=function(i,r){return n(null,i,t,"crm/currency/rates.json",null,r)},yd=function(i,r,u){return n(null,i,t,"crm/currency/rates/"+r+".json",null,u),!0},pd=function(i,r,u,f){return n(null,i,t,"crm/currency/rates/"+r+"/"+u+".json",null,f),!0},wd=function(t,i,r){return n(null,t,u,"crm/currency/rates.json",i,r),!0},bd=function(t,r,u,f){return n(null,t,i,"crm/currency/rates/"+r+".json",u,f),!0},kd=function(t,i,r){return n(null,t,f,"crm/currency/rates/"+i+".json",null,r),!0},dd=function(i,r,u,f){return n(null,i,t,"crm/contact/"+r+"/tweets.json",{contactid:r,count:u},f)},gd=function(i,r,u){return n(null,i,t,"crm/contact/twitterprofile.json",{searchText:r},u)},ng=function(t,i,r,u){return n(null,t,f,"crm/contact/"+i+"/avatar.json",r,u)},tg=function(t,r,u,f){return n(null,t,i,"crm/contact/"+r+"/avatar.json",u,f)},ig=function(t,i,r){return n(null,t,u,"crm/contact/socialmediaavatar.json",{socialNetworks:i},r)},rg=function(t,i,r){return n(null,t,u,"crm/"+i.entityType+"/import/start.json",i,r),!0},ug=function(i,r,u){return n(null,i,t,"crm/"+r.entityType+"/import/status.json",r,u),!0},fg=function(i,r,u){return n(null,i,t,"crm/import/samplerow.json",r,u),!0},eg=function(t,i,r){return n(null,t,u,"crm/import/uploadfake.json",i,r),!0},og=function(i,r){n(null,i,t,"crm/export/status.json",null,r)},sg=function(t,r){n(null,t,i,"crm/export/cancel.json",null,r)},hg=function(t,i){return n(null,t,u,"crm/export/start.json",null,i),!0},cg=function(i){n(null,null,t,"crm/export/partial/status.json",null,i)},lg=function(t){n(null,null,i,"crm/export/partial/cancel.json",null,t)},ag=function(t,i){return n(null,null,u,"crm/export/partial/"+t.entityType+"/start.json",t,i),!0},vg=function(i,r){return n(null,i,t,"crm/voip/numbers/available.json",null,r),!0},yg=function(i,r){return n(null,i,t,"crm/voip/numbers/existing.json",null,r),!0},pg=function(i,r){return n(null,i,t,"crm/voip/numbers/unlinked.json",null,r),!0},wg=function(i,r){return n(null,i,t,"crm/voip/numbers/current.json",null,r),!0},bg=function(t,i,r){return n(null,t,u,"crm/voip/numbers.json",i,r),!0},kg=function(t,i,r){return n(null,t,u,"crm/voip/numbers/link.json",i,r),!0},dg=function(t,i,r){return n(null,t,f,"crm/voip/numbers/"+i+".json",null,r),!0},gg=function(t,r,u,f){return n(null,t,i,"crm/voip/numbers/"+r+"/settings.json",u,f),!0},nn=function(t,r,u){return n(null,t,i,"crm/voip/numbers/settings.json",r,u),!0},tn=function(i,r){return n(null,i,t,"crm/voip/numbers/settings.json",null,r),!0},rn=function(i,r,u){return n(null,i,t,"crm/voip/numbers/"+r+"/oper.json",null,u),!0},un=function(t,r,u,f){return n(null,t,i,"crm/voip/numbers/"+r+"/oper.json",u,f),!0},fn=function(t,r,u,f){return n(null,t,i,"crm/voip/opers/"+r+".json",u,f),!0},en=function(t,i,r,u){return n(null,t,f,"crm/voip/numbers/"+i+"/oper.json",r,u),!0},on=function(t,i,r){return n(null,t,u,"crm/voip/call.json",i,r),!0},sn=function(t,i,r){return n(null,t,u,"crm/voip/call/"+i+"/answer.json",i,r),!0},hn=function(t,i,r){return n(null,t,u,"crm/voip/call/"+i+"/reject.json",i,r),!0},cn=function(t,i,r,f){return n(null,t,u,"crm/voip/call/"+i+"/redirect.json",r,f),!0},ln=function(t,i,r,f){return n(null,t,u,"crm/voip/call/"+i+".json",r,f),!0},an=function(t,i,r){return n(null,t,u,"crm/voip/price/"+i+".json",null,r),!0},vn=function(i,r){n(null,i,t,"crm/voip/call/missed.json",null,r)},yn=function(i,r,u){n(null,i,t,"crm/voip/call.json",r,u)},pn=function(i,r,u){n(null,i,t,"crm/voip/call/"+r+".json",null,u)},wn=function(i,r){return n(null,i,t,"crm/voip/token.json",null,r),!0},bn=function(i,r){return n(null,i,t,"crm/voip/uploads.json",null,r),!0},kn=function(t,i,r){return n(null,t,f,"crm/voip/uploads.json",i,r),!0},dn=function(i,r){return n(null,i,t,"crm/report/files.json",null,r)},gn=function(t,i,r){return n(null,t,f,"crm/report/file/"+i+".json",null,r),!0},ntt=function(i){n(null,null,t,"crm/report/status.json",null,i)},ttt=function(i){n(null,null,t,"crm/report/terminate.json",null,i)},itt=function(t,i){n(null,null,u,"crm/report/check.json",t,i)},rtt=function(t,i){n(null,null,u,"crm/report/generate.json",t,i)},utt=function(i,u,f){return n(r.getMailFilteredMessages,i,t,"mail/messages.json",u,f)},ftt=function(i,u){return n(r.getMailFolders,i,t,"mail/folders.json",null,u)},ett=function(i,u){return n(r.getAccounts,i,t,"mail/accounts.json",null,u)},ott=function(i,u){return n(r.getMailTags,i,t,"mail/tags.json",null,u)},stt=function(i,u,f,e){return n(r.getMailMessage,i,t,"mail/messages/"+u+".json",f,e)},htt=function(i,u,f,e){return n(r.getMailboxSignature,i,t,"mail/signature/"+u+".json",f,e)},ctt=function(t,i,f,e){return n(r.updateMailboxSignature,t,u,"mail/signature/update/"+i+".json",f,e)},ltt=function(t,i,f,e){return n(r.updateMailboxAutoreply,t,u,"mail/autoreply/update/"+i+".json",f,e)},att=function(i,u,f){return n(r.getLinkedCrmEntitiesInfo,i,t,"mail/crm/linked/entities.json",u,f)},vtt=function(i,u,f,e){return n(r.getNextMailMessageId,i,t,"mail/messages/"+u+"/next.json"+(f?"?"+jq.param(f):""),null,e)},ytt=function(i,u,f,e){return n(r.getPrevMailMessageId,i,t,"mail/messages/"+u+"/prev.json"+(f?"?"+jq.param(f):""),f,e)},ptt=function(i,u,f,e){return n(r.getMailConversation,i,t,"mail/conversation/"+u+".json",f,e)},wtt=function(i,u,f,e){return n(r.getNextMailConversationId,i,t,"mail/conversation/"+u+"/next.json"+(f?"?"+jq.param(f):""),f,e)},btt=function(i,u,f,e){return n(r.getPrevMailConversationId,i,t,"mail/conversation/"+u+"/prev.json"+(f?"?"+jq.param(f):""),f,e)},ktt=function(t,i,u){return n(r.removeMailFolderMessages,t,f,"mail/folders/"+i+"/messages.json",null,u)},dtt=function(t,u,f){return n(r.restoreMailMessages,t,i,"mail/messages/restore.json",u,f)},gtt=function(t,u,f,e,o){return n(r.moveMailMessages,t,i,"mail/messages/move.json",{ids:u,folder:f,userFolderId:e},o)},nit=function(t,u,f){return n(r.removeMailMessages,t,i,"mail/messages/remove.json",{ids:u},f)},tit=function(t,u,f,e){return n(r.markMailMessages,t,i,"mail/messages/mark.json",{ids:u,status:f},e)},iit=function(t,i,f,e,o){return n(r.createMailTag,t,u,"mail/tags.json",{name:i,style:f,addresses:e},o)},rit=function(t,u,f,e,o,s){return n(r.updateMailTag,t,i,"mail/tags/"+u+".json",{name:f,style:e,addresses:o},s)},uit=function(t,i,u){return n(r.removeMailTag,t,f,"mail/tags/"+i+".json",null,u)},fit=function(t,u,f,e){return n(r.setMailTag,t,i,"mail/tags/"+f+"/set.json",{messages:u},e)},eit=function(t,u,f,e){return n(r.setMailConversationsTag,t,i,"mail/conversations/tag/"+f+"/set.json",{messages:u},e)},oit=function(t,u,f,e){return n(r.unsetMailTag,t,i,"mail/tags/"+f+"/unset.json",{messages:u},e)},sit=function(t,u,f,e){return n(r.unsetMailConversationsTag,t,i,"mail/conversations/tag/"+f+"/unset.json",{messages:u},e)},hit=function(t,i,f,e){return n(r.addMailDocument,t,u,"mail/messages/"+i+"/document.json",f,e)},cit=function(t,i,u){return n(r.removeMailMailbox,t,f,"mail/accounts.json",{email:i},u)},lit=function(i,u,f){return n(r.getMailDefaultMailboxSettings,i,t,"mail/accounts/setups.json",{email:u,action:i.action},f)},ait=function(i,u,f){return n(r.getMailMailbox,i,t,"mail/accounts/single.json",{email:u},f)},vit=function(t,u,f,e){return n(r.setDefaultAccount,t,i,"mail/accounts/default.json",{email:f,isDefault:u},e)},yit=function(t,i,f,e){return n(r.createMailMailboxSimple,t,u,"mail/accounts/simple.json",{email:i,password:f},e)},pit=function(t,i,f,e){return n(r.createMailMailboxOAuth,t,u,"mail/accounts/oauth.json",{code:i,type:f},e)},wit=function(t,u,f,e,o){return n(r.updateMailMailboxOAuth,t,i,"mail/accounts/oauth.json",{code:u,type:f,mailboxId:e},o)},bit=function(t,i,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){var tt={name:i,email:f,account:e,password:o,port:s,server:h,smtp_account:c,smtp_password:l,smtp_port:a,smtp_server:v,smtp_auth:y,imap:p,restrict:w,incoming_encryption_type:b,outcoming_encryption_type:k,auth_type_in:d,auth_type_smtp:g};return n(r.createMailMailbox,t,u,"mail/accounts.json",tt,nt)},kit=function(t,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){var nt={name:u,email:f,account:e,password:o,port:s,server:h,smtp_account:c,smtp_password:l,smtp_port:a,smtp_server:v,smtp_auth:y,restrict:p,incoming_encryption_type:w,outcoming_encryption_type:b,auth_type_in:k,auth_type_smtp:d};return n(r.updateMailMailbox,t,i,"mail/accounts.json",nt,g)},dit=function(t,u,f,e){return n(r.setMailMailboxState,t,i,"mail/accounts/state.json",{email:u,state:f},e)},git=function(t,i,u,e){return n(r.removeMailMessageAttachment,t,f,"mail/messages/"+i+"/attachments/"+u+".json",null,e)},nrt=function(t,u,f){return(u instanceof ASC.Mail.Message)?n(r.sendMailMessage,t,i,"mail/messages/send.json",u.ToData(),f):(console.error("Unsupported message format"),null)},trt=function(t,u,f){return n(r.sendMailReceipt,t,i,"mail/messages/simpleSend.json",u.ToData(),f)},irt=function(t,u,f){return(u instanceof ASC.Mail.Message)?n(r.saveMailMessage,t,i,"mail/drafts/save.json",u.ToData(),f):(console.error("Unsupported message format"),null)},rrt=function(t,u,f){return(u instanceof ASC.Mail.Message)?n(r.saveMailTemplate,t,i,"mail/templates/save.json",u.ToData(),f):(console.error("Unsupported message format"),null)},urt=function(t,u,f,e){return n(r.reassignMailMessages,t,i,"mail/messages/reassign.json",{folder:u,email:f},e)},frt=function(i,u,f){return n(r.searchEmails,i,t,"mail/emails/search.json",u,f)},ert=function(i,u,f){return n(r.getMailContacts,i,t,"mail/contacts.json",u,f)},ort=function(i,u,f){return n(r.getMailContactsByInfo,i,t,"mail/contacts/bycontactinfo.json",u,f)},srt=function(t,i,f,e,o,s){return n(r.createMailContact,t,u,"mail/contact/add.json",{name:i,description:f,emails:e,phoneNumbers:o},s)},hrt=function(t,u,f){return n(r.deleteMailContacts,t,i,"mail/contacts/remove.json",{ids:u},f)},crt=function(t,u,f,e,o,s,h){return n(r.updateMailContact,t,i,"mail/contact/update.json",{id:u,name:f,description:e,emails:o,phoneNumbers:s},h)},lrt=function(i,u){return n(r.getMailAlerts,i,t,"mail/alert.json",null,u)},art=function(t,i,u){return n(r.deleteMailAlert,t,f,"mail/alert/"+i+".json",null,u)},vrt=function(i,u,f){return n(r.getMailFilteredConversations,i,t,"mail/conversations.json",u,f)},yrt=function(t,u,f,e,o){return n(r.moveMailConversations,t,i,"mail/conversations/move.json",{ids:u,folder:f,userFolderId:e},o)},prt=function(t,u,f){return n(r.restoreMailConversations,t,i,"mail/conversations/restore.json",u,f)},wrt=function(t,u,f){return n(r.removeMailConversations,t,i,"mail/conversations/remove.json",{ids:u},f)},brt=function(t,u,f,e){return n(r.markMailConversations,t,i,"mail/conversations/mark.json",{ids:u,status:f},e)},krt=function(i,u){return n(r.getMailDisplayImagesAddresses,i,t,"mail/display_images/addresses.json",null,u)},drt=function(t,i,f){return n(r.createDisplayImagesAddress,t,u,"mail/display_images/address.json",{address:i},f)},grt=function(t,i,u){return n(r.removeDisplayImagesAddress,t,f,"mail/display_images/address.json",{address:i},u)},nut=function(t,u,f,e){return n(r.linkChainToCrm,t,i,"mail/conversations/crm/link.json",{id_message:u,crm_contact_ids:f},e)},tut=function(t,u,f,e){return n(r.markChainAsCrmLinked,t,i,"mail/conversations/crm/mark.json",{id_message:u,crm_contact_ids:f},e)},iut=function(t,u,f,e){return n(r.unmarkChainAsCrmLinked,t,i,"mail/conversations/crm/unmark.json",{id_message:u,crm_contact_ids:f},e)},rut=function(t,u,f,e){return n(r.exportMessageToCrm,t,i,"mail/messages/crm/export.json",{id_message:u,crm_contact_ids:f},e)},uut=function(i,u,f){return n(r.isConversationLinkedWithCrm,i,t,"mail/conversations/link/crm/status.json",{message_id:u},f)},fut=function(i,u){return n(r.getMailHelpCenterHtml,i,t,"mail/helpcenter.json",null,u)},eut=function(t,u,f){return n(r.exportAllAttachmentsToMyDocuments,t,i,"mail/messages/attachments/export.json",{id_message:u},f)},out=function(t,u,f,e){return n(r.exportAllAttachmentsToDocuments,t,i,"mail/messages/attachments/export.json",{id_message:u,id_folder:f},e)},sut=function(t,u,f){return n(r.exportAttachmentToMyDocuments,t,i,"mail/messages/attachment/export.json",{id_attachment:u},f)},hut=function(t,u,f,e){return n(r.exportAttachmentToDocuments,t,i,"mail/messages/attachment/export.json",{id_attachment:u,id_folder:f},e)},cut=function(t,u,f){return n(r.downloadAttachmentsAll,t,i,"mail/messages/attachment/downloadall/"+u+".json",null,f)},lut=function(t,u,f,e){return n(r.setEMailInFolder,t,i,"mail/accounts/emailinfolder.json",{mailbox_id:u,email_in_folder:f},e)},aut=function(i,u){return n(r.getMailServer,i,t,"mailserver/server.json",null,u)},vut=function(i,u){return n(r.getMailServerFullInfo,i,t,"mailserver/serverinfo/get.json",null,u)},yut=function(i,u){return n(r.getMailServerFreeDns,i,t,"mailserver/freedns/get.json",null,u)},put=function(i,u){return n(r.getMailDomains,i,t,"mailserver/domains/get.json",null,u)},wut=function(i,u){return n(r.getCommonMailDomain,i,t,"mailserver/domains/common.json",null,u)},but=function(t,i,f,e){return n(r.addMailDomain,t,u,"mailserver/domains/add.json",{name:i,id_dns:f},e)},kut=function(t,i,u){return n(r.removeMailDomain,t,f,"mailserver/domains/remove/"+i+".json",null,u)},dut=function(t,i,f,e,o,s,h,c){return n(r.addMailbox,t,u,"mailserver/mailboxes/add.json",{name:i,local_part:f,domain_id:e,user_id:o,notifyCurrent:s,notifyProfile:h},c)},gut=function(t,i,f){return n(r.addMyMailbox,t,u,"mailserver/mailboxes/addmy.json",{name:i},f)},nft=function(t,u,f,e){return n(r.changeMailboxPassword,t,i,"mailserver/mailboxes/changepwd.json",{mailbox_id:u,password:f},e)},tft=function(i,u){return n(r.getRandomPassword,i,t,"portal/randompwd.json",null,u)},ift=function(i,u){return n(r.getMailboxes,i,t,"mailserver/mailboxes/get.json",null,u)},rft=function(t,i,u){return n(r.removeMailbox,t,f,"mailserver/mailboxes/remove/"+i+".json",null,u)},uft=function(t,u,f,e){return n(r.updateMailbox,t,i,"mailserver/mailboxes/update.json",{mailbox_id:u,name:f},e)},fft=function(t,u,f,e){return n(r.addMailBoxAlias,t,i,"mailserver/mailboxes/alias/add.json",{mailbox_id:u,alias_name:f},e)},eft=function(t,u,f,e){return n(r.removeMailBoxAlias,t,i,"mailserver/mailboxes/alias/remove.json",{mailbox_id:u,address_id:f},e)},oft=function(t,i,f,e,o){return n(r.addMailGroup,t,u,"mailserver/groupaddress/add.json",{name:i,domain_id:f,address_ids:e},o)},sft=function(t,u,f,e){return n(r.addMailGroupAddress,t,i,"mailserver/groupaddress/address/add.json",{mailgroup_id:u,address_id:f},e)},hft=function(t,i,u,e){return n(r.removeMailGroupAddress,t,f,"mailserver/groupaddress/addresses/remove.json",{mailgroup_id:i,address_id:u},e)},cft=function(i,u){return n(r.getMailGroups,i,t,"mailserver/groupaddress/get.json",null,u)},lft=function(t,i,u){return n(r.removeMailGroup,t,f,"mailserver/groupaddress/remove/"+i+".json",null,u)},aft=function(i,u,f){return n(r.isDomainExists,i,t,"mailserver/domains/exists.json",{name:u},f)},vft=function(i,u,f){return n(r.checkDomainOwnership,i,t,"mailserver/domains/ownership/check.json",{name:u},f)},yft=function(i,u,f){return n(r.getDomainDnsSettings,i,t,"mailserver/domains/dns/get.json",{id:u},f)},pft=function(t,i,f,e,o){return n(r.createNotificationAddress,t,u,"mailserver/notification/address/add.json",{name:i,password:f,domain_id:e},o)},wft=function(t,i,u){return n(r.removeNotificationAddress,t,f,"mailserver/notification/address/remove.json",{address:i},u)},bft=function(t,i,f,e){return n(r.addCalendarBody,t,u,"mail/messages/calendarbody/add",{id_message:i,ical_body:f},e)},kft=function(t,u,f){return n(r.setMailConversationEnabledFlag,t,i,"mail/settings/conversationsEnabled",{enabled:u},f)},dft=function(t,u,f){return n(r.setMailAlwaysDisplayImagesFlag,t,i,"mail/settings/alwaysDisplayImages",{enabled:u},f)},gft=function(t,u,f){return n(r.setMailCacheUnreadMessagesFlag,t,i,"mail/settings/cacheMessagesEnabled",{enabled:u},f)},net=function(t,u,f){return n(r.setMailEnableGoNextAfterMove,t,i,"mail/settings/goNextAfterMoveEnabled",{enabled:u},f)},tet=function(t,u,f){return n(r.setMailEnableGoNextAfterMove,t,i,"mail/settings/replaceMessageBody",{enabled:u},f)},iet=function(i,r){return n(null,i,t,"mail/mailservice/get.json",null,r)},ret=function(t,i,r,f,e,o,s){return n(null,t,u,"mail/mailservice/connect.json",{ip:i,sqlip:r,database:f,user:e,password:o},s)},uet=function(t,i,r,f,e,o,s,h,c){return n(null,t,u,"mail/mailservice/save.json",{ip:i,sqlip:r,database:f,user:e,password:o,token:s,host:h},c)},fet=function(i,u,f){return n(r.getMailOperationStatus,null,t,"mail/operations/"+u+".json",null,f)},eet=function(t,i,f,e){return n(r.createMailFolder,t,u,"mail/userfolders.json",{name:i,parentId:f},e)},oet=function(t,u,f,e,o){return n(r.updateMailFolder,t,i,"mail/userfolders/"+u+".json",{name:f,parentId:e},o)},set=function(t,i,u){return n(r.removeMailFolder,t,f,"mail/userfolders/"+i+".json",null,u)},het=function(i,u,f,e){var o={};return u&&(o.parentId=u),f&&(o.ids=f),n(r.getMailUserFolders,i,t,"mail/userfolders.json",o,e)},cet=function(i,u,f,e){return n(r.isMailServerAddressExists,null,t,"mailserver/mailboxes/alias/exists.json",{local_part:u,domain_id:f},e)},aet=function(i,u,f,e){return n(r.isMailServerAddressValid,null,t,"mailserver/mailboxes/alias/valid.json",{local_part:u,domain_id:f},e)},vet=function(i,u){return n(r.getMailFilters,i,t,"mail/filters.json",{},u)},yet=function(t,i,f){return n(r.createMailFilter,t,u,"mail/filters.json",{filter:i},f)},pet=function(t,u,f){return n(r.updateMailFilter,t,i,"mail/filters.json",{filter:u},f)},wet=function(t,i,u){return n(r.deleteMailFilter,t,f,"mail/filters/"+i+".json",null,u)},bet=function(i,u,f,e,o){return n(r.checkMailFilter,i,t,"mail/filters/check.json",{filter:u,page:f,pageSize:e},o)},ket=function(i,u,f){return n(r.applyMailFilter,i,t,"mail/filters/"+u+"/apply.json",null,f)},det=function(i,r,u){return n(null,i,t,"settings/security.json",typeof r=="number"||typeof r=="string"?{ids:[r]}:r,u)},get=function(i,r){return n(null,i,t,"settings/security/modules.json",null,r)},not=function(i,r){return n(null,i,t,"settings/security/password.json",null,r)},tot=function(t,r,u){return n(null,t,i,"settings/security.json",r,u)},iot=function(t,r,u){return n(null,t,i,"settings/security/access.json",r,u)},rot=function(t,r,u){return n(null,t,i,"settings/security/administrator.json",r,u)},uot=function(i,r,u){return n(null,i,t,"settings/security/administrator.json",r,u)},fot=function(i,r){return n(null,i,t,"settings.json",null,r)},eot=function(i,r){return n(null,i,t,"settings/logo.json",null,r)},oot=function(i){return n(null,null,t,"settings/iprestrictions.json",null,i)},sot=function(t,r){return n(null,null,i,"settings/iprestrictions.json",t,r)},hot=function(t,r){return n(null,null,i,"settings/iprestrictions/settings.json",t,r)},cot=function(t,r){return n(null,null,i,"settings/tips.json",t,r)},lot=function(t){return n(null,null,i,"settings/tips/change/subscription.json",null,t)},aot=function(t,r){return n(null,null,i,"settings/tfaapp.json",{type:t},r)},vot=function(i){return n(null,null,t,"settings/tfaappcodes.json",null,i)},yot=function(t){return n(null,null,i,"settings/tfaappnewcodes.json",null,t)},pot=function(t,r){return n(null,null,i,"settings/tfaappnewapp.json",{id:t},r)},wot=function(i){return n(null,null,t,"settings/telegramlink.json",null,i)},bot=function(i){return n(null,null,t,"settings/telegramisconnected.json",null,i)},kot=function(t){return n(null,null,f,"settings/telegramdisconnect.json",null,t)},dot=function(){return n(null,null,i,"settings/welcome/close.json",null,null)},got=function(t){return n(null,null,i,"settings/closeadminhelper.json",null,t)},nst=function(t,r,u){return n(null,t,i,"settings/colortheme.json",{theme:r},u)},tst=function(t,r,u){return n(null,null,i,"settings/timeandlanguage.json",{lng:t,timeZoneID:r},u)},ist=function(t,r,u){return n(null,t,i,"settings/defaultpage.json",{defaultProductID:r},u)},rst=function(t,i,r){return n(null,t,u,"settings/smtp.json",{smtpSettings:i},r)},ust=function(t,i){return n(null,t,f,"settings/smtp.json",null,i)},fst=function(i,r){return n(null,i,t,"settings/smtp/test.json",null,r)},est=function(i,r){return n(null,i,t,"settings/smtp/test/status.json",null,r)},ost=function(t,r,u){return n(null,t,i,"privacyroom.json",{enable:r},u)},sst=function(t,r,u){return n(null,t,i,"privacyroom/keys.json",r,u)},hst=function(i,r,u){return n(null,i,t,"privacyroom/access/"+r+".json",null,u)},cst=function(t,i,r){return n(null,t,u,"settings/ldap.json",i,r),!0},lst=function(i,r){return n(null,i,t,"settings/ldap.json",null,r),!0},ast=function(i,r){return n(null,i,t,"settings/ldap/cron.json",null,r),!0},vst=function(t,i,r){return n(null,t,u,"settings/ldap/cron.json",i,r),!0},yst=function(i,r){return n(null,i,t,"settings/ldap/default.json",null,r),!0},pst=function(i,r){return n(null,i,t,"settings/ldap/status.json",null,r),!0},wst=function(i,r){return n(null,i,t,"settings/ldap/sync.json",null,r),!0},bst=function(n,t,i){jq.ajax({type:"get",url:"sso/generatecert",complete:n,error:t}).always(i)},kst=function(n,t,i,r){jq.ajax({type:"post",data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8",url:"sso/validatecerts",complete:t,error:i}).always(r)},dst=function(n,t,i,r){jq.ajax({type:"post",data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8",url:"sso/loadmetadata",complete:t,error:i}).always(r)},gst=function(t,i,r){return n(null,t,u,"settings/ssov2.json",i,r),!0},nht=function(t){return n(null,null,f,"settings/ssov2.json",null,t),!0},tht=function(t,r){return n(null,null,i,"settings/emailactivation.json",t,r)},iht=function(i,r,u){return n(null,i,t,"settings/statistics/spaceusage/"+r+".json",null,u),!0},rht=function(i,r,u,f){return n(null,i,t,"settings/statistics/visit.json",{fromDate:r,toDate:u},f),!0},uht=function(i,r){return n(null,i,t,"settings/storage.json",null,r),!0},fht=function(i,r){return n(null,i,t,"settings/storage/cdn.json",null,r),!0},eht=function(t,r,u){return n(null,t,i,"settings/storage.json",r,u),!0},oht=function(t,r,u){return n(null,t,i,"settings/storage/cdn.json",r,u),!0},sht=function(t,i){return n(null,t,f,"settings/storage/cdn.json",null,i),!0},hht=function(t,i){return n(null,t,f,"settings/storage.json",null,i),!0},wlt=function(t,i){return n(null,t,f,"settings/storage.json",null,i),!0},cht=function(i,r){return n(null,i,t,"settings/storage/progress.json",null,r)},lht=function(i,r){return n(null,i,t,"settings/encryption/progress.json",null,r)},aht=function(i){return n(null,null,t,"security/audit/login/last.json",null,i)},vht=function(i,r,u){return n(null,i,t,"security/audit/events/last.json",null,u)},yht=function(t,i){return n(null,t,u,"security/audit/login/report.json",null,i)},pht=function(t,i){return n(null,t,u,"security/audit/events/report.json",null,i)},wht=function(i,r){return n(null,i,t,"security/audit/settings/lifetime.json",null,r)},bht=function(t,i,r,f){return n(null,t,u,"security/audit/settings/lifetime.json",{settings:{LoginHistoryLifeTime:i,AuditTrailLifeTime:r}},f)},kht=function(i,r){return n(null,null,t,"security/activeconnections.json",null,r)},dht=function(t,r){return n(null,t,i,"security/activeconnections/logoutallchangepassword.json",null,r)},ght=function(t,r,u){return n(null,t,i,"security/activeconnections/logoutall/"+r+".json",{userId:r},u)},nct=function(t,r){return n(null,t,i,"security/activeconnections/logoutallexceptthis.json",null,r)},tct=function(t,r,u){return n(null,t,i,"security/activeconnections/logout/"+r+".json",{loginEventId:r},u)},ict=function(i,u){return n(r.getTalkUnreadMessages,i,t,"portal/talk/unreadmessages.json",null,u),!0},rct=function(t,i){return n(null,null,u,"authentication/register.json",t,i),!0},uct=function(t,i,r){return n(null,t,u,"settings/whitelabel/save.json",i,r),!0},fct=function(t,r){return n(null,t,i,"settings/whitelabel/restore.json",null,r),!0},ect=function(i,r){return n(null,i,t,"settings/customnavigation/getall.json",null,r),!0},oct=function(i,r){return n(null,i,t,"settings/customnavigation/getsample.json",null,r),!0},sct=function(i,r,u){return n(null,i,t,"settings/customnavigation/get/"+r+".json",null,u),!0},hct=function(t,i,r){return n(null,t,u,"settings/customnavigation/create.json",i,r),!0},cct=function(t,i,r){return n(null,t,f,"settings/customnavigation/delete/"+i+".json",null,r),!0},lct=function(i,r,u,f){var e=r instanceof Date?Teamlab.serializeTimestamp(r,!0):r,o=u instanceof Date?Teamlab.serializeTimestamp(u,!0):u;return n(null,i,t,"calendar/calendars/"+e+"/"+o+".json",null,f),!0},act=function(i,r,u){return n(null,i,t,"calendar/events/{0}/historybyuid.json".format(r),null,u),!0},vct=function(i,r,u){return n(null,i,t,"calendar/events/{0}/historybyid.json".format(r),null,u),!0},yct=function(t,i,r,f){return n(null,t,u,"calendar/importIcs.json",{iCalString:r,calendarId:i},f),!0},pct=function(i,r,u){return n(null,i,t,"portal/bar/promotions.json",{desktop:Boolean(r),domain:window.location.hostname,page:window.location.pathname+window.location.search},u)},wct=function(t,i,r){return n(null,t,u,"portal/bar/promotions/mark/{0}.json".format(i),{id:i},r)},bct=function(i,r,u){return n(null,i,t,"portal/bar/tips.json",{desktop:Boolean(r),domain:window.location.hostname,page:window.location.pathname+window.location.search+window.location.hash,productAdmin:ASC.Resources.Master.IsProductAdmin},u)},kct=function(t,i,r){return n(null,t,u,"portal/bar/tips/mark/{0}.json".format(i),{id:i},r)},dct=function(t,i){return n(r.removeNotificationAddress,t,f,"portal/bar/tips.json",null,i)},gct=function(t,i,r){return n(null,t,u,"portal/startbackup.json",i,r),!0},nlt=function(i,r){return n(null,i,t,"portal/getbackupprogress.json",null,r),!0},tlt=function(i,r){return n(null,i,t,"portal/getbackupschedule.json",null,r),!0},ilt=function(t,i,r){return n(null,t,u,"portal/createbackupschedule.json",i,r),!0},rlt=function(t,i){return n(null,t,f,"portal/deletebackupschedule.json",null,i),!0},ult=function(t,i){return n(null,t,f,"portal/deletebackupschedule.json",null,i),!0},flt=function(i,r){return n(null,i,t,"portal/getbackuphistory.json",null,r),!0},elt=function(t,i,r){return n(null,t,f,"portal/deletebackup/"+i+".json",null,r),!0},olt=function(t,i,r){return n(null,t,u,"portal/startrestore.json",i,r),!0},slt=function(i,r){return n(null,i,t,"settings/storage/backup.json",null,r),!0},hlt=function(i,r,u){return n(null,i,t,"people/reassign/progress.json",{userId:r},u),!0},clt=function(t,r,u){return n(null,t,i,"people/reassign/terminate.json",{userId:r},u),!0},llt=function(t,i,r,f,e){return n(null,t,u,"people/reassign/start.json",{fromUserId:i,toUserId:r,deleteProfile:f},e),!0},alt=function(i,r,u){return n(null,i,t,"people/remove/progress.json",{userId:r},u),!0},vlt=function(t,r,u){return n(null,t,i,"people/remove/terminate.json",{userId:r},u),!0},ylt=function(t,i,r){return n(null,t,u,"people/remove/start.json",{userId:i},r),!0},plt=function(t,i){return n(null,t,u,"portal/gift/mark.json",null,i),!0};return{events:r,profile:ServiceFactory.profile,constants:{dateFormats:ServiceFactory.dateFormats,contactTypes:ServiceFactory.contactTypes,nameCollections:ServiceFactory.nameCollections},create:ServiceFactory.create,formattingDate:ServiceFactory.formattingDate,serializeDate:ServiceFactory.serializeDate,serializeTimestamp:ServiceFactory.serializeTimestamp,getDisplayTime:ServiceFactory.getDisplayTime,getDisplayDate:ServiceFactory.getDisplayDate,getDisplayDatetime:ServiceFactory.getDisplayDatetime,sortCommentsByTree:ServiceFactory.sortCommentsByTree,joint:b,start:k,init:ut,bind:ft,unbind:et,call:w,getQuotas:ct,recalculateQuota:lt,checkRecalculateQuota:at,remindPwd:vt,thirdPartyLinkAccount:yt,thirdPartyUnLinkAccount:pt,addProfile:wt,getProfile:dt,getProfiles:gt,getProfilesByFilter:ni,getSimpleProfilesByFilter:ti,subscribePeopleBirthday:ii,addGroup:ri,updateGroup:ei,getGroup:ui,getGroups:fi,deleteGroup:oi,updateProfile:si,updateUserType:hi,updateUserStatus:ci,getUserPhoto:li,updateUserPhoto:ai,removeUserPhoto:vi,createUserPhotoThumbnails:yi,sendInvite:pi,removeUser:wi,removeUsers:bi,getUserGroups:ki,removeSelf:di,addCmtBlog:gi,getCmtBlog:nr,getCmtBlogs:tr,addCmtForumTopic:ir,getCmtForumTopic:rr,getCmtForumTopics:ur,getCmtForumCategories:fr,addCmtForumToCategory:er,addCmtEvent:or,getCmtEvent:sr,getCmtEvents:hr,addCmtBookmark:cr,getCmtBookmark:lr,getCmtBookmarks:ar,addCmtForumTopicPost:vr,addCmtBlogComment:yr,getCmtBlogComments:pr,addCmtEventComment:wr,getCmtEventComments:br,subscribeCmtEventComment:kr,addCmtBookmarkComment:dr,getCmtBookmarkComments:gr,getCmtPreview:nu,subscribeProject:tu,getFeeds:iu,getNewFeedsCount:ru,readFeeds:uu,getPrjTags:au,getPrjTagsByName:yu,getPrjComments:pu,addPrjTaskComment:yo,getPrjTaskComments:po,addPrjDiscussionComment:wo,getPrjDiscussionComments:d,getPrjDiscussionPreview:bo,getPrjCommentPreview:ko,getWikiCommentPreview:go,getBlogCommentPreview:ns,getNewsCommentPreview:ts,getBookmarksCommentPreview:is,removePrjComment:rs,removeWikiComment:us,removeBlogComment:fs,removeNewsComment:es,removeBookmarksComment:os,addPrjComment:ss,addWikiComment:hs,addBlogComment:cs,addNewsComment:ls,addBookmarksComment:as,updatePrjComment:vs,updateWikiComment:ys,updateBlogComment:ps,updateNewsComment:ws,updateBookmarksComment:bs,fckeRemoveCommentComplete:ks,fckeCancelCommentComplete:ds,fckeEditCommentComplete:gs,getShortenLink:nh,updatePortalName:th,getPrjStatuses:ou,removePrjStatus:su,addPrjStatus:hu,updatePrjStatus:cu,updatePrjStatuses:lu,updatePrjSettings:fu,getPrjSettings:eu,getPrjSecurityinfo:vu,addPrjEntityFiles:ie,uploadFilesToPrjEntity:vc,removePrjEntityFiles:re,getPrjEntityFiles:ue,addPrjSubtask:wu,copyPrjSubtask:bu,movePrjSubtask:ku,updatePrjSubtask:du,updatePrjTask:uf,updatePrjTasksStatus:ef,updatePrjTasksMilestone:ff,removePrjSubtask:gu,addPrjTask:nf,copyPrjTask:tf,getPrjTask:cf,addPrjTaskByMessage:rf,getPrjTasks:af,getPrjTasksSimpleFilter:vf,getPrjTasksById:lf,addPrjMilestone:fe,updatePrjMilestone:ee,removePrjMilestone:oe,removePrjMilestones:se,getPrjMilestone:he,getPrjMilestones:ce,addPrjDiscussion:le,updatePrjDiscussion:ae,updatePrjDiscussionStatus:ve,removePrjDiscussion:ye,getPrjDiscussion:pe,getPrjDiscussions:we,subscribeToPrjDiscussion:be,getSubscribesToPrjDiscussion:ke,addPrjProject:de,updatePrjProject:ge,updatePrjProjectStatus:no,updatePrjProjectTags:to,removePrjProject:fo,removePrjProjects:eo,followingPrjProject:oo,getPrjProject:so,getPrjProjects:y,getPrjTaskFiles:yf,subscribeToPrjTask:pf,notifyPrjTaskResponsible:wf,addPrjTaskLink:bf,removePrjTaskLink:kf,getPrjGanttIndex:eh,setPrjGanttIndex:oh,getPrjProjectFolder:te,getPrjSelfProjects:ho,getPrjFollowProjects:co,getProjectsForCrmContact:lo,addProjectForCrmContact:ao,removeProjectFromCrmContact:vo,getPrjTeam:v,getProjectTeamExcluded:df,updatePrjTeam:gf,addPrjProjectTeamPerson:ih,removePrjProjectTeamPerson:rh,getPrjProjectTeamPersons:uh,setTeamSecurity:ne,getPrjProjectFiles:fh,addPrjTime:sh,getPrjTime:hh,getPrjTaskTime:g,getPrjTimeById:ch,getTotalTimeByFilter:lh,updatePrjTime:ah,removePrjTime:yh,changePaymentStatus:vh,getPrjTemplates:ph,getPrjTemplate:wh,updatePrjTemplate:bh,createPrjTemplate:kh,removePrjTemplate:dh,getPrjActivities:gh,addPrjImport:tc,getPrjImport:ic,getPrjImportProjects:rc,checkPrjImportQuota:nc,getPrjReportTemplate:uc,addPrjReportTemplate:fc,updatePrjReportTemplate:ec,deletePrjReportTemplate:oc,generateProjectsReport:sc,getProjectsReportStatus:cc,terminateProjectsReport:hc,getProjectsReports:lc,removeProjectsReport:ac,addPrjTag:yc,createDocUploadFile:pc,addDocFile:wc,updateFileStream:bc,removeDocFile:nl,getDocFile:kc,addDocFolder:dc,getDocFolder:gc,createDocUploadSession:tl,getFolderPath:il,getFileSecurityInfo:rl,generateSharedLink:ul,copyBatchItems:fl,getOperationStatuses:el,saveDocServiceUrl:ol,filesStoreOriginal:sl,hideConfirmConvert:hl,filesDisplayFavorites:ll,filesDisplayRecent:cl,addFilesFavorites:al,removeFilesFavorites:vl,filesDisplayTemplates:yl,addFilesTemplates:pl,removeFilesTemplates:wl,createThumbnails:bl,createFile:kl,filesDownloadTarGz:dl,changeAutomaticallyCleanUp:gl,filesChangeDafaultAccessRightsSetting:na,copyDocFileAs:ua,getFileProperties:ta,setFileProperties:ia,setFilesProperties:ra,createCrmUploadFile:fa,getCrmContactInfo:ea,addCrmContactInfo:oa,updateCrmContactInfo:sa,deleteCrmContactInfo:ha,addCrmContactData:ca,updateCrmContactData:la,addCrmContactTwitter:aa,addCrmEntityNote:va,addCrmContact:ya,addCrmCompany:nt,updateCrmCompany:pa,updateCrmContactContactStatus:ka,updateCrmCompanyContactStatus:wa,updateCrmPersonContactStatus:ba,addCrmPerson:tt,updateCrmPerson:da,removeCrmContact:ga,mergeCrmContacts:nv,addCrmTag:iv,addCrmContactTagToGroup:rv,deleteCrmContactTagFromGroup:uv,addCrmEntityTag:sv,removeCrmTag:fv,removeCrmEntityTag:hv,removeCrmUnusedTag:cv,getCrmCustomFields:lv,addCrmCustomField:av,updateCrmCustomField:vv,removeCrmCustomField:yv,reorderCrmCustomFields:pv,getCrmDealMilestones:wv,addCrmDealMilestone:bv,updateCrmDealMilestone:kv,updateCrmDealMilestoneColor:dv,removeCrmDealMilestone:gv,reorderCrmDealMilestones:ny,addCrmContactStatus:ty,updateCrmContactStatus:iy,updateCrmContactStatusColor:ry,removeCrmContactStatus:uy,addCrmContactType:fy,updateCrmContactType:ey,removeCrmContactType:oy,getCrmListItem:sy,addCrmListItem:hy,updateCrmListItem:cy,updateCrmListItemIcon:ly,removeCrmListItem:ay,reorderCrmListItems:vy,removePrjTask:sf,removePrjTasks:hf,removeCaldavProjectCalendar:l,getCalendarCaldavUrl:io,getCardDavLink:ro,deleteCardDavLink:uo,addCrmTask:yy,addCrmTaskGroup:py,getCrmTask:wy,addCrmEntityMember:cp,addCrmContactsForProject:gy,removeCrmEntityMember:lp,addCrmDealForContact:tp,removeCrmDealFromContact:ip,updateCrmTask:by,removeCrmTask:ky,getCrmCases:ap,getCrmCasesByPrefix:vp,removeCrmCase:yp,updateCrmCase:pp,getCrmContacts:wp,getCrmSimpleContacts:bp,getCrmContactsForMail:kp,getCrmContactsByPrefix:dp,getCrmContact:gp,getCrmTags:ev,getCrmEntityTags:ov,getCrmEntityMembers:hp,getCrmTasks:nw,getCrmOpportunity:tw,getCrmOpportunities:uw,getCrmOpportunitiesByContact:fw,getCrmOpportunitiesByPrefix:ew,removeCrmOpportunity:ow,updateCrmOpportunityMilestone:sw,getCrmCurrencyConvertion:hw,getCrmCurrencySummaryTable:cw,updateCrmCurrency:lw,setCrmCurrencyRates:aw,addCrmCurrencyRates:vw,updateCRMContactStatusSettings:yw,updateCRMContactTagSettings:pw,updateCRMContactMailToHistorySettings:ww,updateOrganisationSettingsCompanyName:bw,updateOrganisationSettingsAddresses:kw,updateOrganisationSettingsLogo:dw,getOrganisationSettingsLogo:gw,updateWebToLeadFormKey:nb,sendSMTPMailToContacts:tb,getPreviewSMTPMailToContacts:ib,getStatusSMTPMailToContacts:rb,cancelSMTPMailToContacts:ub,addCrmHistoryEvent:fb,removeCrmHistoryEvent:eb,getCrmHistoryEvents:ob,removeCrmFile:sb,getCrmFolder:hb,getCrmContactRights:cb,updateCrmContactRights:lb,updateCrmCaseRights:ab,updateCrmOpportunityRights:vb,addCrmEntityFiles:yb,removeCrmEntityFiles:pb,getCrmEntityFiles:wb,getCrmTaskCategories:bb,getCrmCase:iw,getContactsByContactInfo:rw,getCrmInvoices:ok,getCrmEntityInvoices:sk,updateCrmInvoicesStatusBatch:hk,getCrmInvoiceByNumber:ck,getCrmInvoiceByNumberExistence:lk,getCrmInvoiceItems:ak,addCrmInvoiceItem:vk,updateCrmInvoiceItem:yk,removeCrmInvoiceItem:pk,getCrmInvoiceTaxes:wk,addCrmInvoiceTax:bk,updateCrmInvoiceTax:kk,removeCrmInvoiceTax:dk,getCrmInvoice:gk,getCrmInvoiceSample:nd,getCrmInvoiceJsonData:td,addCrmInvoice:id,updateCrmInvoice:rd,removeCrmInvoice:ud,getInvoicePdfExistingOrCreate:fd,getInvoiceConverterData:ed,addCrmInvoiceLine:od,updateCrmInvoiceLine:sd,removeCrmInvoiceLine:hd,getCrmInvoiceSettings:cd,updateCrmInvoiceSettingsName:ld,updateCrmInvoiceSettingsTerms:ad,getCrmCurrencyRates:vd,getCrmCurrencyRateById:yd,getCrmCurrencyRateByCurrencies:pd,addCrmCurrencyRate:wd,updateCrmCurrencyRate:bd,removeCrmCurrencyRate:kd,getCrmContactTweets:dd,getCrmContactTwitterProfiles:gd,removeCrmContactAvatar:ng,updateCrmContactAvatar:tg,getCrmContactSocialMediaAvatar:ig,startCrmImportFromCSV:rg,getStatusCrmImportFromCSV:ug,getCrmImportFromCSVSampleRow:fg,uploadFakeCrmImportFromCSV:eg,getStatusExportToCSV:og,cancelExportToCSV:sg,startCrmExportToCSV:hg,getCrmPartialExportStatus:cg,cancelCrmCancelPartialExport:lg,startCrmPartialExport:ag,addCrmEntityTaskTemplateContainer:kb,updateCrmEntityTaskTemplateContainer:db,removeCrmEntityTaskTemplateContainer:gb,getCrmEntityTaskTemplateContainer:nk,getCrmEntityTaskTemplateContainers:tk,addCrmEntityTaskTemplate:ik,updateCrmEntityTaskTemplate:rk,removeCrmEntityTaskTemplate:uk,getCrmEntityTaskTemplate:fk,getCrmEntityTaskTemplates:ek,getCrmContactsForProject:tv,getCrmVoipAvailableNumbers:vg,getCrmVoipExistingNumbers:yg,getCrmVoipUnlinkedNumbers:pg,getCrmCurrentVoipNumber:wg,createCrmVoipNumber:bg,linkCrmVoipNumber:kg,removeCrmVoipNumber:dg,updateCrmVoipNumberSettings:gg,updateCrmVoipSettings:nn,getCrmVoipSettings:tn,addCrmVoipNumberOperators:un,updateCrmVoipOperator:fn,removeCrmVoipNumberOperators:en,getCrmVoipNumberOperators:rn,callVoipNumber:on,answerVoipCall:sn,rejectVoipCall:hn,redirectVoipCall:cn,saveVoipCall:ln,saveVoipCallPrice:an,getVoipCalls:yn,getVoipMissedCalls:vn,getVoipCall:pn,getVoipToken:wn,getVoipUploads:bn,deleteVoipUploads:kn,getCrmReportFiles:dn,removeCrmReportFile:gn,getCrmReportStatus:ntt,terminateCrmReport:ttt,checkCrmReport:itt,generateCrmReport:rtt,getMailFilteredMessages:utt,getMailFolders:ftt,getAccounts:ett,getMailTags:ott,getMailMessage:stt,getNextMailMessageId:vtt,getPrevMailMessageId:ytt,getMailConversation:ptt,getNextMailConversationId:wtt,getPrevMailConversationId:btt,removeMailFolderMessages:ktt,restoreMailMessages:dtt,moveMailMessages:gtt,removeMailMessages:nit,markMailMessages:tit,createMailTag:iit,updateMailTag:rit,removeMailTag:uit,setMailTag:fit,setMailConversationsTag:eit,unsetMailTag:oit,unsetMailConversationsTag:sit,addMailDocument:hit,removeMailMailbox:cit,getMailDefaultMailboxSettings:lit,getMailMailbox:ait,setDefaultAccount:vit,createMailMailboxSimple:yit,createMailMailboxOAuth:pit,updateMailMailboxOAuth:wit,createMailMailbox:bit,updateMailMailbox:kit,setMailMailboxState:dit,removeMailMessageAttachment:git,sendMailMessage:nrt,simpleMailSend:trt,saveMailMessage:irt,saveMailTemplate:rrt,reassignMailMessages:urt,searchEmails:frt,getMailContacts:ert,getMailContactsByInfo:ort,createMailContact:srt,deleteMailContacts:hrt,updateMailContact:crt,getMailAlerts:lrt,deleteMailAlert:art,getMailFilteredConversations:vrt,moveMailConversations:yrt,restoreMailConversations:prt,removeMailConversations:wrt,markMailConversations:brt,getMailDisplayImagesAddresses:krt,createDisplayImagesAddress:drt,removeDisplayImagesAddress:grt,linkChainToCrm:nut,markChainAsCrmLinked:tut,unmarkChainAsCrmLinked:iut,exportMessageToCrm:rut,getLinkedCrmEntitiesInfo:att,isConversationLinkedWithCrm:uut,getMailHelpCenterHtml:fut,getMailboxSignature:htt,updateMailboxSignature:ctt,updateMailboxAutoreply:ltt,exportAllAttachmentsToMyDocuments:eut,exportAllAttachmentsToDocuments:out,exportAttachmentToMyDocuments:sut,exportAttachmentToDocuments:hut,downloadAttachmentsAll:cut,setEMailInFolder:lut,getMailServer:aut,getMailServerFullInfo:vut,getMailServerFreeDns:yut,getMailDomains:put,getCommonMailDomain:wut,addMailDomain:but,removeMailDomain:kut,addMailbox:dut,addMyMailbox:gut,changeMailboxPassword:nft,getRandomPassword:tft,getMailboxes:ift,removeMailbox:rft,addMailBoxAlias:fft,updateMailbox:uft,removeMailBoxAlias:eft,addMailGroup:oft,addMailGroupAddress:sft,removeMailGroupAddress:hft,getMailGroups:cft,removeMailGroup:lft,isDomainExists:aft,checkDomainOwnership:vft,getDomainDnsSettings:yft,createNotificationAddress:pft,removeNotificationAddress:wft,addCalendarBody:bft,setMailConversationEnabledFlag:kft,setMailAlwaysDisplayImagesFlag:dft,setMailCacheUnreadMessagesFlag:gft,setMailEnableGoNextAfterMove:net,setMailEnableReplaceMessageBody:tet,getMailServerInfo:iet,connectMailServerInfo:ret,saveMailServerInfo:uet,getMailOperationStatus:fet,getMailUserFolders:het,createMailFolder:eet,updateMailFolder:oet,removeMailFolder:set,isMailServerAddressExists:cet,isMailServerAddressValid:aet,getMailFilters:vet,createMailFilter:yet,updateMailFilter:pet,deleteMailFilter:wet,checkMailFilter:bet,applyMailFilter:ket,getWebItemSecurityInfo:det,getEnabledModules:get,getPortalPasswordSettings:not,setWebItemSecurity:tot,setAccessToWebItems:iot,setProductAdministrator:rot,isProductAdministrator:uot,getPortalSettings:fot,getPortalLogo:eot,savePortalSmtpSettings:rst,resetPortalSmtpSettings:ust,testPortalSmtpSettings:fst,getTestPortalSmtpSettingsResult:est,setPrivacyRoom:ost,setEncryptionKeys:sst,getEncryptionAccess:hst,getAuditEvents:vht,getLoginEvents:aht,createLoginHistoryReport:yht,createAuditTrailReport:pht,getLoginEventsForProfile:kht,logoutAllActiveConnectionsWithChangePassword:dht,logoutAllActiveConnectionsForUser:ght,logoutAllActiveConnectionsExceptThis:nct,logoutActiveConnection:tct,getAuditSettings:wht,setAuditSettings:bht,getIpRestrictions:oot,saveIpRestrictions:sot,updateIpRestrictionsSettings:hot,updateTipsSettings:cot,updateTipsSubscription:lot,tfaAppAuthSettings:aot,tfaappcodes:vot,tfaAppRequestNewCodes:yot,tfaAppNewApp:pot,telegramLink:wot,telegramIsConnected:bot,telegramDisconnect:kot,closeWelcomePopup:dot,closeAdminHelper:got,setColorTheme:nst,setTimaAndLanguage:tst,setDefaultpage:ist,getTalkUnreadMessages:ict,registerUserOnPersonal:rct,saveWhiteLabelSettings:uct,restoreWhiteLabelSettings:fct,getCustomNavigationItems:ect,getCustomNavigationItemSample:oct,getCustomNavigationItem:sct,createCustomNavigationItem:hct,deleteCustomNavigationItem:cct,getCalendars:lct,getCalendarEventByUid:act,getCalendarEventById:vct,importCalendarEventIcs:yct,saveLdapSettings:cst,getLdapSettings:lst,getLdapCronSettings:ast,setLdapCronSettings:vst,getLdapDefaultSettings:yst,getLdapStatus:pst,syncLdap:wst,ssoGenerateCert:bst,ssoValidateCerts:kst,ssoLoadMetadata:dst,saveSsoSettings:gst,deleteSsoSettings:nht,updateEmailActivationSettings:tht,getSpaceUsageStatistics:iht,getVisitStatistics:rht,getAllStorages:uht,getAllCdnStorages:fht,updateStorage:eht,updateCdnStorage:oht,resetToDefaultCdn:sht,resetToDefaultStorage:hht,getStorageProgress:cht,getEncryptionProgress:lht,getBarPromotions:pct,markBarPromotion:wct,getBarTips:bct,markBarTip:kct,deleteBarTips:dct,startbackup:gct,getBackupProgress:nlt,getBackupSchedule:tlt,getBackupStorages:slt,createBackupSchedule:ilt,deleteBackupSchedule:rlt,deleteBackupHistory:ult,getBackupHistory:flt,deleteBackup:elt,startRestore:olt,getReassignProgress:hlt,terminateReassign:clt,startReassign:llt,getRemoveProgress:alt,terminateRemove:vlt,startRemove:ylt,addImportUser:bt,getImportStatus:kt,markGiftAsReaded:plt}}();
(function(t){function f(n){var r=[],t=0,u,i;for(n=encodeURI(n).split(""),u=n.length;t<u;)i=n[t],t+=1,"%"!==i?r.push(i.charCodeAt(0)):(i=n[t]+n[t+1],r.push(parseInt(i,16)),t+=2);return r}function e(n){for(var r=[],t=0,e=n.length,i,u,f;t<e;)i=n[t],u=n[t+1],f=n[t+2],128>i?(r.push(String.fromCharCode(i)),t+=1):191<i&&i<224?(r.push(String.fromCharCode((i&31)<<6|u&63)),t+=2):(r.push(String.fromCharCode((i&15)<<12|(u&63)<<6|f&63)),t+=3);return r.join("")}function o(t){var o="",e=f(t),s=e.length,u;for(u=0,n=s-2;u<n;u+=3)o+=i[e[u]>>2],o+=i[((e[u]&3)<<4)+(e[u+1]>>4)],o+=i[((e[u+1]&15)<<2)+(e[u+2]>>6)],o+=i[e[u+2]&63];return s%3&&(u=s-s%3,o+=i[e[u]>>2],s%3==2?(o+=i[((e[u]&3)<<4)+(e[u+1]>>4)],o+=i[(e[u+1]&15)<<2],o+=r):(o+=i[(e[u]&3)<<4],o+=r+r)),o}function s(n){var o,s,i=0,h=[],t=0,f=0;for(i=0,idxCnt=n.length;i<idxCnt;i++)s=n.charCodeAt(i),o=u[s&127],o!==-1&&(f=f<<6|o,t+=6,t>=8&&(t-=8,r!==n.charAt(i)&&h.push(f>>t&255),f&=(1<<t)-1));return t?"":e(h)}var r="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),u=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];t.base64=t.Base64={encode:o,decode:s}})(jQuery);
(function(n,t,i){function u(n){var t=document.createElement("textarea");return t.innerHTML=n,t.value}function e(n){var t=n.val(),i=0,r="";if(t=typeof t=="string"?[t]:t||[],r=[].concat([""],t,[""]).join("xyu"),r.indexOf("xyu-1xyu")!==-1){for(i=t.length;i--;)if(t[i]==-1){t.splice(i,1);break}n.val(t)}}function r(t){var i=t?jQuery(t.target):n();if(i.is("select")){jQuery(document.body).off("click",arguments.callee);jQuery(document.body).one("click",arguments.callee);return undefined}jQuery("span.custom-combobox").removeClass("showed-options").find("div.combobox-container:first").hide()}function o(n){f(n)}function s(){r();jQuery(document.body).off("click",r)}function h(){var s=jQuery(this),i=s.parents("span.custom-combobox:first"),t="",h=null,e=s.val(),b="",r=[],c=[],l=null,o=null,k=s.find("option"),f=i.find("li.option-item"),n=0,a=0,v=!1;for(e=typeof e=="string"?[e]:e||[],b=[].concat([""],e,[""]).join("xyu"),a=k.length;a--;){if(o=k[a],t=o.getAttribute("value"),t==-1){h=o;continue}for(v=!1,b.indexOf("xyu"+t+"xyu")!==-1&&(v=!0,l=o,r.unshift(l.innerHTML),c.unshift(l.className)),n=f.length;n--;)if(f[n].getAttribute("data-value")===t){jQuery(f[n]).find("input").prop("checked",v===!0);break}}h&&r.length===0&&r.unshift(h.innerHTML);for(var y="",p=i.attr("class").split(/\s+/),w=0,w=p?p.length:0;w--;)y=p[w],y.indexOf("select-value-")===0&&i.removeClass(y);for(i.removeClass(i.attr("data-optclass")||" ").find("span.combobox-title-inner-text:first").text(u(r.length===1?r[0]:r.join(", "))),i.attr("data-value",t).attr("data-optclass",c.join(" ")).addClass(c.join(" ")).addClass("select-value-"+t),n=f.length;n--;)if(f[n].getAttribute("data-value")===t){jQuery(f[n]).addClass("selected-item").siblings().removeClass("selected-item");break}}function f(t){var i=n(t.target).parents("span.custom-combobox:first");if(i.hasClass("showed-options"))return undefined;r();jQuery(document.body).off("click",r);e(i.find("select"));i.addClass("showed-options").find("div.combobox-container:first").show();setTimeout(y,1)}function c(n){var i=jQuery(this).parents("span.custom-combobox:first"),r=i.find("select:first"),u=jQuery(n.target),t=u.attr("data-value");t&&r.val(t).trigger("change")}function l(){for(var i=jQuery(this).parents("span.custom-combobox:first"),f=i.find("select:first"),r=i.find("input:checked"),n=null,t=[],u=r.length;u--;)n=r[u].parentNode.getAttribute("data-value"),n&&n!=-1&&t.unshift(n);t&&f.val(t).trigger("change")}function a(n,t){var s=[],r=null,y=null,h=[],nt=n.className,c=jQuery(n).val(),tt="",p="",e=[],l=[],w=-1,b=!1,it=n.multiple===!0,k=null,a,rt,o;for(c=typeof c=="string"?[c]:c||[],tt=[].concat([""],c,[""]).join("xyu"),a=0,rt=t.length;a<rt;a++)r=t[a],r.value==-1&&(y=r),b=!1,r.value!=-1&&tt.indexOf("xyu"+r.value+"xyu")!==-1&&(b=!0,k=r,e.unshift(k.title),l.unshift(k.classname)),p=Math.floor(Math.random()*1e6),w=a,h.push({value:r.value,title:u(r.title)}),s=s.concat(["<li",' class="option-item',r.classname?" "+r.classname:"",r.selected===!0?" selected-item":"",'"',' data-value="'+(h.length-1)+'"',' title=""',">",it?'<input id="option-'+p+'" type="checkbox"'+(b===!0?' checked="checked"':"")+' /><label for="option-'+p+'">'+r.title+"<\/label>":r.title,"<\/li>"]);y&&e.length===0&&e.unshift(y.title);s=['<span class="combobox-title">','<span class="inner-text combobox-title-inner-text">',e.length>0?e.length===1?e[0]:e.join(", ")||"":"","<\/span>","<\/span>",'<span class="combobox-wrapper">','<div class="combobox-container">','<ul class="combobox-options'+(it?" is-multiple":"")+'">',s.join(""),"<\/ul>","<\/div>","<\/span>"];o=i.createElement("span");o.className="custom-combobox"+(w!==-1?" select-value-"+w:"")+(nt?" "+nt:"")+(l.length>0?" "+l.join(" "):"");l&&o.setAttribute("data-optclass",l.join(" "));o.innerHTML=s.join("");for(var ut=h.length,f=null,v=null,d=o.getElementsByTagName("li"),g=0,g=d?d.length:0;g--;)v=d[g],f=v.getAttribute("data-value"),f=isFinite(+f)?+f:-1,f>-1&&f<ut&&(v.setAttribute("title",h[f].title.trim()),v.setAttribute("data-value",h[f].value));return o}function v(n){for(var e=n.value,o=[],u=null,i=null,f=0,r=null,t,i=n.getElementsByTagName("option"),f=i?i.length:0;f--;)r=i[f],u=r.getAttribute("value"),o.unshift({classname:r.className,value:u,title:r.innerHTML,selected:u==e});return(t=a(n,o),t)?(n.parentNode.insertBefore(t,n),t.appendChild(n),t.setAttribute("data-value",e),t):null}function y(){jQuery(document.body).one("click",r)}function p(n,t){n.on("blur",s).on("focus",o).on("change",h);t.find("span.combobox-title:first").on("click",f);t.find("ul.combobox-options:first").on("click",c);t.find("input").on("click",l)}n.fn.advansedFilterCustomCombobox=function(){for(var i=null,r=null,u=n(this),f=0,t=null,f=u.length;f--;)(i=u[f],t=n(i),t.hasClass("custom-combobox"))||(r=v(i),p(n(i),n(r)),t.addClass("custom-combobox"),n(r).find("div.combobox-container:first").append(t),n.browser.mobile&&(t.addClass("mobile-mode"),t.parents(".custom-combobox:first").addClass("mobile-mode")));return u}})(jQuery,window,document,document.body);
(function(n,t,i){function s(n){return n?n.constructor.toString().indexOf("Array")!=-1:!1}function e(n,t){var i,r,u;if(n=typeof n=="string"?n:"",!n)return"";if(t===!0){for(i=[["&lt;","<"],["&gt;",">"],["&and;","\\^"],["&sim;","~"],["&amp;","&"]],r=i.length;r--;)n=n.replace(new RegExp(i[r][1],"g"),i[r][0]);return n}return u=document.createElement("textarea"),u.innerHTML=n,u.value}function st(t){for(var f=[],i=null,r="",u=0,e=t?t.length:0;u<e;u++)if(i=t[u],i.params){switch(i.type){case"sorter":r={id:i.id,type:i.type,params:{id:i.params.id,def:i.params.def,dsc:i.params.dsc,sortOrder:i.params.sortOrder}};break;case"daterange":r={id:i.id,type:i.type,params:{from:Teamlab.serializeTimestamp(new Date(i.params.from)),to:Teamlab.serializeTimestamp(new Date(i.params.to))}};break;default:r={id:i.id,type:i.type,params:i.params}}r.params=n.base64.encode(n.toJSON(r.params));f.push(n.toJSON(r))}return n.base64.encode(f.join(";"))}function k(){var n=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+location.pathname+location.search;return encodeURIComponent(n.charAt(n.length-1)==="/"?n+"Default.aspx":n)}function ht(n,t){n.some(function(n){return n.type!="sorter"})?t.addClass("has-filters"):t.removeClass("has-filters")}function ct(n,t){var i,r;if(w===!0&&(t.length===0||t.length===1&&t[0].id==="sorter"))return w=!1,undefined;if(n=n&&typeof n=="object"?n:{},w=!1,i=st(t),n.inhash===!0)try{ASC.Controls.AnchorController.safemove(i)}catch(u){}r=k();localStorageManager.setItem(r,i)}function lt(t){var u=null,f=k(),o,s;if(localStorageManager.getItem(f)&&(u=n.base64.decode(localStorageManager.getItem(f))),t&&typeof t=="object"&&t.inhash===!0&&(r=location.hash,r=r&&typeof r=="string"&&r.charAt(0)==="#"?r.substring(1):r,r.length===0&&(r=n.cookies.get(f),r=decodeURIComponent(r),r=r&&typeof r=="string"&&r.charAt(0)==="#"?r.substring(1):r),u=n.base64.decode(r),r&&r!=="null")){try{ASC.Controls.AnchorController.safemove(r)}catch(h){}n.cookies.set(f,r,{path:ot})}var i=null,e=[];for(u=typeof u=="string"&&u.length>0?u.split(";"):[],o=0,s=u.length;o<s;o++){try{i=JSON.parse(u[o]);i.params=JSON.parse(n.base64.decode(i.params))}catch(h){i=null}if(i)switch(i.type){case"sorter":e.push({id:i.id,selected:!0,params:i.params});break;case"daterange":e.push({id:i.id,params:{from:Teamlab.serializeDate(i.params.from),to:Teamlab.serializeDate(i.params.to)}});break;default:e.push({id:i.id,params:i.params})}}return e||[]}function ir(n){return st(n.data("filtervalues")||[])}function rr(n){var t=k();return localStorageManager.getItem(t)||ir(n)}function ur(n){return n.data("filtervalues")||[]}function fr(n,t){for(var i in t)t.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=t[i])}function at(n,t){for(var u=[],i=0,r=0,i=n.length;i--;){for(r=t.length;r--;)if(n[i]&&t[r]&&n[i].id===t[r].id){fr(n[i],t[r]);break}u.unshift(n[i])}for(r=t.length;r--;){for(i=n.length;i--;)if(t[r].id===n[i].id)break;u.unshift(t[r])}return u}function er(n,t){for(var i=n.find(".filter-item.filter-item-group > .selector-wrapper:first").data("items"),r=0,i=i?i:[],r=i.length;r--;)if(i[r].id==t)return i[r].title;return t}function or(n,t,i){for(var r=n.find(".filter-item.filter-item-person > .selector-wrapper:first").data("items"),u=0,r=r?r:[],u=r.length;u--;)if(r[u].id==t)return r[u].title;return typeof i=="string"&&i?i:t}function d(n,t){if(!t.title)return undefined;for(var i=0,i=n?n.length:0;i--;){if(t.groupid)if(n[i].id===t.groupid){n[i].items.push(t);break}else continue;if(n[i].title===t.group){n[i].items.push(t);break}}i===-1&&n.push({title:t.group||"",items:[t],id:t.groupid||""})}function vt(n,t,i,r,u){var f=n.datepicker({onSelect:function(n,t,i,r){return function(u,f){r(this,n,t,i,u,f)}}(t,i,r,g)}).on("click",function(n){n.stopPropagation()});return f.datepicker("setDate",u),f}function sr(n){return jQuery.tmpl(ut.filterItem,n)}function yt(n,t,i){var c=1,r=[],o=null,s=null,h="",u=0,v=0,f=0,a=0,l;for(c=n&&typeof n=="object"&&n.hasOwnProperty("colcount")&&isFinite(+n.colcount)?+n.colcount:c,u=0,v=t.length;u<v;u++)if(i==="filter"&&c>=1){if(u<c){for(r.push('<li class="item-group-col"><ul class="group-items">'),l=u;l<v;l+=c){for(s=t[l].items,o=[],f=0,a=s.length;f<a;f++)o.push(pt(s[f],i));h=e(t[l].title,!0);r=r.concat(["<li",' class="item-group '+i+"-group",'"',">",'<span class="title" title="'+h+'">',h,"<\/span>",'<ul class="filter-items">',o.join(""),"<\/ul>","<\/li>"])}r.push('<\/ul><div class="clear"><\/div><\/li>')}}else{for(s=t[u].items,o=[],f=0,a=s.length;f<a;f++)o.push(pt(s[f],i));h=e(t[u].title,!0);r=r.concat(["<li",' class="item-group '+i+"-group",i==="sorter"&&!t[u].title?" none-title":"",'"',">",'<span class="title" title="'+h+'">',h,"<\/span>","<\/li>",o.join("")])}return r.push('<li class="item-list-separator '+i+'-list-separator"><\/li>'),r.join("")}function pt(n,t){return["<li",' class="item-item '+t+"-item",n.def===!0?" selected":"",n.def===!0?(n.dsc=!!n.dsc)==!0?" dsc-sort":" asc-sort":"",n.dsc===!0||n.sortOrder==="descending"?" dsc-sort-default":"",'"',' title="'+e(n.title,!0)+'"',' data-id="'+n.id+'"',n.type?' data-type="'+n.type+'"':"",n.hashmask?' data-anchor="'+n.hashmask+'"':"",">",'<span class="inner-text">',e(n.title,!0),"<\/span>","<\/li>"].join("")}function hr(n,t){var u=null,r=null;return(r=jQuery.tmpl(ut.filterContainer,{filtervalues:n,sortervalues:t}),!r||r.length!=1)?null:(r=r[0],u=i.createElement("div"),u.className="clearFix",u.innerHTML=r.outerHTML,r)}function wt(t,i,r,u){for(var o=null,a=!1,e=[],s=0,r=[].concat(r),u=[].concat(u),f=0,c=0,v="",h=null,y=i.find("li.filter-item"),l=0,p=0,l=0,p=y.length;l<p;l++){for(h=n(y[l]),v=h.attr("data-id"),a=!1,f=0,c=r?r.length:0;f<c;f++)if(r[f].id===v){d(e,r[f]);r.splice(f,1);a=!0;break}a===!1&&d(e,{type:h.attr("data-type"),title:h.text(),group:"",hashmask:h.attr("data-anchor")})}for(f=0,c=r?r.length:0;f<c;f++)d(e,r[f]);for(s=e.length;s--;)if(e[s].title===""){e.push(e[s]);e.splice(s,1);break}return o=i.find("ul.filter-list:first").removeClass("multi-column").empty()[0]||null,o&&(t.colcount>=1&&(o.className+=" multi-column multi-column-"+t.colcount),o.innerHTML=yt(t,e,"filter")),o=i.find("ul.sorter-list:first").removeClass("multi-column").empty()[0]||null,o&&(o.innerHTML=yt(t,[{title:"",items:u}],"sorter")),o}function l(n,t,i){for(var t=t||null,e=n.data("filteroptions"),r=n.data("filtervalues"),f=r?r.length:0,u=[];f--;)r[f].isset===!0&&u.unshift(r[f]),t===null&&r[f].id==="sorter"&&(t=r[f]);ht(u,n);ct(e,u);i===!0&&n.trigger("resetallfilters",[n,t.id,u]);n.trigger("setfilter",[n,t,t!=null?t.params:null,u]);n.trigger("updatefilter",[n,t!=null?t.id:null,u])}function cr(n,t,i){for(var t=t||null,e=n.data("filteroptions"),r=n.data("filtervalues"),f=r?r.length:0,u=[];f--;)r[f].isset===!0&&u.unshift(r[f]),t===null&&r[f].id==="sorter"&&(t=r[f]);ht(u,n);ct(e,u);i===!0&&n.trigger("resetallfilters",[n,t.id,u]);n.trigger("resetfilter",[n,t,u]);n.trigger("updatefilter",[n,t.id,u])}function f(n,t,i,r,f){var b,k,w,e,a,h,v,p;if(n.trigger("adv-setFilterItem",[n,t,i,r,f]),u(!0),y(n,!0),n.length>0&&i&&i.id==="sorter"&&(b=n.find('li.sorter-item[data-id="'+r.id+'"]:first'),nt(n,r.title),k=n.find("div.advansed-filter-sort-container:first"),w=r.dsc===!0?"dsc-sort":"asc-sort",k.removeClass("asc-sort").removeClass("dsc-sort").addClass(w),b.addClass("selected").removeClass("asc-sort").removeClass("dsc-sort").addClass(w).siblings().removeClass("selected").removeClass("asc-sort").removeClass("dsc-sort")),n.length>0&&i){if(e=null,a=t&&t.length>0?t.attr("data-paramsid")||null:null,i.params||(i.params=i.multiselect===!0?[]:{}),i.multiselect===!0&&s(i.params)&&a){for(h=i.params,v=h?h.length:0;v--;)if(a==h[v].__id){e=h[v];break}e||(e={__id:a},i.params.push(e))}else e=i.params;for(p in r)r.hasOwnProperty(p)&&(e[p]=r[p]);i.isset=!0;c(n);f!==!0&&o===!1&&l(n,i)}}function a(n,t,i,r){var e,c,f,h;if(n.trigger("adv-unsetFilterItem",[n,t,i,r]),u(!0),y(n,!0),n.length>0&&i){if(e=!1,c=t&&t.length>0?t.attr("data-paramsid")||null:null,i.multiselect===!0&&s(i.params)&&c){for(f=i.params,h=f?f.length:0;h--;)if(c==f[h].__id){f.splice(h,1);break}f.length===0&&(e=!0)}else e=!0;e===!0&&(i.params=null,i.isset=!1);r!==!0&&o===!1&&cr(n,i)}}function lr(t){for(var i,u=t.find("li.item-group.filter-group"),r=0,f=u.length;r<f;r++)i=n(u[r]),i.removeClass("hidden-item"),i.find(".item-item:not(.hidden-item)").length===0&&i.addClass("hidden-item")}function y(n){var o=n.find("input.advansed-filter-input:first"),e=o.val(),t=null,i=n.data("filtervalues"),r=0,u,f;if(!i||i.length===0)return undefined;for(r=i.length;r--;)if(i[r].id==="text")break;if(r!==-1)if(t=i[r],typeof e=="string"&&e.length>0){u={value:e};t.params||(t.params={});for(f in u)u.hasOwnProperty(f)&&(t.params[f]=u[f]);t.isset=!0}else t.params=null,t.isset=!1}function ar(n){var u=n.find("input.advansed-filter-input:first"),r=null,t=n.data("filtervalues"),i=0;if(!t||t.length===0)return undefined;for(i=t.length;i--;)if(t[i].id==="text")break;u.val("");i!==-1&&(r=t[i],r.params=null,r.isset=!1);n.data("filtervalues",t)}function vr(n,t,i,r){n.length>0&&i&&f(n,t,i,{},r)}function yr(){return!0}function pr(n,t,i){return i.hasOwnProperty("defaultparams")?i.defaultparams:{}}function wr(){}function br(n,t,i){i&&i.hasOwnProperty("name")&&t.removeClass("default-value").find("span.group-selector:first span.custom-value:first").attr("title",i.name).find("span.value:first").text(i.name)}function bt(n,t,i,r,u){n.length>0&&t.length>0&&br(n,t,{id:r.id,name:e(r.title)});n.length>0&&i&&f(n,t,i,{id:r.id,value:r.id,name:e(r.title)},u)}function kr(n,t){if(n.hasClass("showed-groupselector"))return undefined;if(jQuery(n).find(".filter-item.filter-item-group > .advansed-filter-groupselector").length!=0)try{n.addClass("showed-groupselector").find(".filter-item.filter-item-group > .selector-wrapper:first").groupadvancedSelector("reset",!0)}catch(i){}jQuery(document.body).off("click",u);ii(n,t,n.find("div.advansed-filter-groupselector-container:first"));setTimeout(function(){jQuery(document.body).one("click",u)},1)}function dr(){}function gr(n,t,i){return t.id===i.id}function nu(n,t,i){if(jQuery(t).children(".advanced-selector-container").length==0){try{n.addClass("showed-groupselector");t.children(".selector-wrapper:first").groupadvancedSelector({inPopup:!0,onechosen:!0})}catch(r){}try{jQuery(t).children(".selector-wrapper:first").on("showList",function(n,t,i,r){return function(u,f){r(n,t,i,f)}}(n,t,i,bt));i.isset||i.bydefault||setTimeout(function(){t.hasClass("default-value")&&t.find(".selector-wrapper").trigger("click")},0)}catch(r){}}}function tu(n,t,i){i&&i.hasOwnProperty("name")&&t.removeClass("default-value").find("span.person-selector:first span.custom-value:first").attr("title",i.name).find("span.value:first").text(i.name)}function kt(n,t,i,r,u,o){n.length>0&&t.length>0&&tu(n,t,{id:r,name:e(u)});n.length>0&&i&&f(n,t,i,{id:r,value:r,name:e(u)},o)}function iu(n,t,i){return t.id===i.id}function ru(n,t,i){if(jQuery(t).children(".advansed-filter-userselector").length==0){try{var r=i.hasOwnProperty("showme")?Boolean(i.showme):!0;n.addClass("showed-userselector");t.children(".selector-wrapper:first").useradvancedSelector({showme:r,inPopup:!0,onechosen:!0,showGroups:!0,itemsDisabledIds:r?[]:[window.Teamlab.profile.id],showDisabled:window.Teamlab.profile.isAdmin})}catch(u){}try{jQuery(t).children(".selector-wrapper:first").on("showList",function(n,t,i,r){return function(u,f){r(n,t,i,f.id,f.title)}}(n,t,i,kt));i.isset||i.bydefault||setTimeout(function(){t.hasClass("default-value")&&t.find(".selector-wrapper").trigger("click")},0)}catch(u){}}}function uu(n,t){if(n.hasClass("showed-userselector"))return undefined;if(jQuery(n).find(".filter-item.filter-item-person > .advansed-filter-userselector").length!=0)try{n.addClass("showed-userselector").find(".filter-item.filter-item-person > .selector-wrapper:first").useradvancedSelector("reset",!0)}catch(i){}jQuery(document.body).off("click",u);ii(n,t,n.find("div.advansed-filter-userselector-container:first"));setTimeout(function(){jQuery(document.body).one("click",u)},1)}function fu(){}function g(n,t,i,r,u,e,o,s){var v=jQuery(n),h=e?e.input.datepicker("getDate"):s,c=v.parents("span.advansed-filter-dateselector-date:first"),a=null,l=!1;c.hasClass("dateselector-from-date")?(l=!0,a=c.parents(".filter-item-daterange:first").find("span.to-daterange-selector:first span.datepicker-container:first")):(l=!1,a=c.parents(".filter-item-daterange:first").find("span.from-daterange-selector:first span.datepicker-container:first"));t.length>0&&r&&(c.find("span.btn-show-datepicker-title:first").text(u),h&&(f(t,i,r,l?{from:h.getTime()}:{to:h.getTime()},o),a.datepicker("option",l?"minDate":"maxDate",h)))}function eu(n,t,i){return t.from==i.from&&t.to==i.to}function ou(t,i,r){var u=null,s=null,h=null,f=new Date,e,o;return e=new Date(f.getFullYear(),f.getMonth()-6,f.getDate(),0,0,0,0),o=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0),s=i.find("span.from-daterange-selector:first span.datepicker-container:first"),h=i.find("span.to-daterange-selector:first span.datepicker-container:first"),u=vt(s,t,i,r,e),u.datepicker("option","maxDate",o),i.find("span.from-daterange-selector:first span.btn-show-datepicker-title:first").text(n.datepicker.formatDate(u.datepicker("option","dateFormat"),u.datepicker("getDate"))),u=vt(h,t,i,r,o),u.datepicker("option","minDate",e),i.find("span.to-daterange-selector:first span.btn-show-datepicker-title:first").text(n.datepicker.formatDate(u.datepicker("option","dateFormat"),u.datepicker("getDate"))),{from:e.getTime(),to:o.getTime()}}function su(n,t,i,r){if(r.hasClass("showed-datepicker"))return undefined;jQuery(document.body).off("click",u);var f=r.addClass("showed-datepicker").find("span.advansed-filter-datepicker-container:first").css("display","block");f.removeClass("reverse-position");i.parents("div.hidden-filters-container:first").length===0&&t.width()-i[0].offsetLeft-i.parent()[0].offsetLeft-i.width()<f.width()&&f.addClass("reverse-position");setTimeout(function(){jQuery(document.body).one("click",u)},1)}function hu(){}function cu(n,t,i,r,u){var c=jQuery(n),e=c.val(),o,h;if(t.length>0&&r){if(s(e)){for(o=e,h=e.length;h--;)if(o[h]==-1){o.splice(h,1);break}e=o}i.removeClass("default-value");f(t,i,r,{value:e,title:c.find('option[value="'+(""+e).replace(/\"/g,'\\"')+'"]:first').text()},u)}}function lu(n,t,i){return t.value==i.value?!0:s(t.value)&&s(i.value)&&t.value.length===i.value.length?[].concat(t.value).sort().join("")==[].concat(i.value).sort().join(""):!1}function au(n,t,i){var e=t.find("select.advansed-filter-combobox:first"),r=e.val(),o=i.hasOwnProperty("defaultvalue")?i.defaultvalue:"-1",u,f;if(s(r)){for(u=r,f=r.length;f--;)if(u[f]==-1){u.splice(f,1);break}r=u}r=r==o?null:r;r=s(r)&&(r.length===0||r.length===1&&r[0]=="-1")?null:r;e.advansedFilterCustomCombobox().on("change",function(n,t,i,r){return function(){r(this,n,t,i)}}(n,t,i,cu));return i.isset||r!==null||setTimeout(function(){t.hasClass("default-value")&&t.find(".selector-wrapper .combobox-selector .combobox-title").trigger("click")},0),r?{value:r,title:e.find('option[value="'+(""+r).replace(/\"/g,'\\"')+'"]:first').text()}:null}function vu(){}function yu(n,t,i,r){var u=null;switch(t.type){case"flag":u=yr;break;case"group":u=gr;break;case"person":u=iu;break;case"daterange":u=eu;break;case"combobox":u=lu}return u!==null&&t.hasOwnProperty("params")?u(n,t.params,i,r):!1}function pu(n,t,i,r){var u=null,f;switch(i.type){case"flag":u=pr;break;case"group":u=nu;break;case"person":u=ru;break;case"daterange":u=ou;break;case"combobox":u=au}if(u!==null)return f=u(n,t,i,r),i.hasOwnProperty("bydefault")&&i.bydefault&&typeof i.bydefault=="object"?i.bydefault:f}function wu(n,t,i){var r=null;switch(i.type){case"flag":r=wr;break;case"group":r=dr;break;case"person":r=fu;break;case"daterange":r=hu;break;case"combobox":r=vu}r!==null&&r(n,t,i)}function dt(t,i,r,u,f){switch(r.type){case"flag":vr(t,i,r,f);break;case"group":bt(t,i,r,{id:u.id,title:er(t,u.id)},f);break;case"person":kt(t,i,r,u.id,or(t,u.id,u.name),f);break;case"daterange":var s=null,o=null,e=null;u.hasOwnProperty("from")&&(e=i.find("span.from-daterange-selector:first span.datepicker-container:first"),s=new Date(+u.from),o=e.datepicker("getDate"),e.length>0&&o&&s instanceof Date&&(e.datepicker("setDate",s),o=e.datepicker("getDate"),g(e,t,i,r,n.datepicker.formatDate(e.datepicker("option","dateFormat"),o),null,f,o)));u.hasOwnProperty("to")&&(e=i.find("span.to-daterange-selector:first span.datepicker-container:first"),s=new Date(+u.to),o=e.datepicker("getDate"),e.length>0&&o&&s instanceof Date&&(e.datepicker("setDate",s),o=e.datepicker("getDate"),g(e,t,i,r,n.datepicker.formatDate(e.datepicker("option","dateFormat"),o),null,f,o)));break;case"combobox":i.find("select").val(u.value).trigger("change");break;default:r.hasOwnProperty("process")&&typeof r.process=="function"?r.process(t,i,r,u,f):null}}function bu(n){n.hasClass("hidden-item")&&n.removeClass("hidden-item")}function ku(n,t,i,r){return i.hasClass("hidden-item")?!1:(i.addClass("hidden-item"),t.length>0?(h(n,t,r),!0):void 0)}function du(n){n.hasClass("disabled-item")&&n.removeClass("disabled-item")}function gu(n,t,i,r){return i.hasClass("disabled-item")?!1:(i.addClass("disabled-item"),t.length>0?(h(n,t,r),!0):void 0)}function nf(n,t,i){if(t.length>0)return h(n,t,i),!0}function gt(t,i,r,u){var e,l,b,a,k,v,d,g,nt,p,tt,w,o;if(typeof u=="undefined"&&typeof i.nonetrigger!="undefined"&&(u=i.nonetrigger),e=null,l=t.find("div.advansed-filter-filters:first"),l.length===0)return undefined;if(i.id==="text")return r&&typeof r=="object"&&r.hasOwnProperty("value")&&(b=t.find("input.advansed-filter-input:first"),b.val()!=r.value)?(b.val(r.value),y(t,u),!0):!1;if((e=l.find('div.filter-item[data-id="'+i.id+'"]:first')).length>0&&i.multiselect!==!0){if(!i.hasOwnProperty("groupby")&&(!r||yu(t,i,r,u)))return!1;h(t,e,!0)}for(a=i.hasOwnProperty("groupby")&&typeof i.groupby=="string"&&i.groupby.length>0?i.groupby:null,a!==null&&(k=l.find('div.filter-item[data-group="'+a+'"]:first'),t.length>0&&k.length>0&&h(t,k,!0)),v=t.data("customdata"),v&&(d=v.hasOwnProperty("maxfilters")?v.maxfilters:-1,d!==-1&&l.find("div.filter-item").length>=d&&(g=l.find("div.filter-item:first"),t.length>0&&g.length>0&&h(t,g,!0))),nt=s(r)?r:[r],p=0,tt=nt.length;p<tt;p++)r=nt[p],e=n((i.hasOwnProperty("create")&&typeof i.create=="function"?i.create:sr)(i)),e.length>0&&(l.append(e),i&&(w=r&&typeof r=="object"&&r.hasOwnProperty("__id")?r.__id:Math.floor(Math.random()*1e6),e.attr("data-id",i.id).attr("data-paramsid",w).attr("data-type",i.type).addClass("filter-item").addClass("filter-item-"+i.type),a!==null&&e.attr("data-group",a),o=(i.hasOwnProperty("customize")&&typeof i.customize=="function"?i.customize:pu)(t,e,i,u),o=o&&typeof o=="object"?o:null,o=i.hasOwnProperty("value")?i.value:o,o?o.__id=w:null,r=r&&typeof r=="object"?r:null,r?r.__id=w:null,o&&!r&&(f(t,e,i,o,u),dt(t,e,i,o,!0)),r&&(f(t,e,i,r,u),dt(t,e,i,r,u))));return c(t),!0}function ni(n,t,i,r){var u=n.find("div.advansed-filter-filters:first");if(u.length===0)return undefined;i.length>0&&(t&&((t.hasOwnProperty("destroy")&&typeof t.destroy=="function"?t.destroy:wu)(n,i,t),a(n,i,t,r)),i.find("div.advansed-filter-control").appendTo(n),i.remove());c(n)}function h(n,t,i){for(var f=t.attr("data-id"),u=n.data("filtervalues"),r=0,r=u?u.length:0;r--;)if(u[r].id===f)break;ni(n,r!==-1?u[r]:null,t,i)}function tf(n,t){var i=n.find("li.item-item.sorter-item");i.filter('[data-id="'+t+'"]').removeClass("hidden-item")}function rf(n,t,i){var u=n.find("li.item-item.sorter-item"),r=null;return r=u.filter('[data-id="'+t+'"]').addClass("hidden-item"),r.hasClass("selected")&&(r=u.not(".hidden-item").filter(":first"),r.length>0&&(t=r.attr("data-id"),t))?(v(n,t,{dsc:!1},i),!0):void 0}function v(n,t,i,r){var o=n.data("filtervalues")||[],u=-1,s=n.data("sortervalues")||[],e=-1;if(s.length>0)for(e=s.length;e--;)if(s[e].id===t)break;if(o.length>0)for(u=o.length;u--;)if(o[u].id==="sorter")break;return u!==-1&&e!==-1?o[u].params&&o[u].params.id===s[e].id&&o[u].params.dsc===i.dsc?!1:(s[e].dsc=i.dsc,s[e].sortOrder=i.dsc===!0?"descending":"ascending",f(n,null,o[u],s[e],r),!0):!1}function ti(n,t,i){var u=parseInt(n.find("div.advansed-filter-input input:first").css("min-width")||100)||100,s=parseInt(n.find("div.advansed-filter-input").css("margin-right")||0),r=t.children("div.filter-item:visible:last"),f=n.find(".advansed-filter-button.btn-show-filters:first"),e=f.length==1?f.width():0,o=0;return t.children("div:visible").each(function(){o+=jq(this).outerWidth()}),i.length===0||r.length===0?!1:i[0].offsetTop!==r[0].offsetTop||i[0].offsetHeight!==r[0].offsetHeight||n[0].offsetWidth<t[0].offsetWidth+t[0].offsetLeft+e+u||i.find("span.selector-wrapper:first")[0].offsetHeight!==r.find("span.selector-wrapper:first")[0].offsetHeight||n[0].offsetWidth<o+t[0].offsetLeft+e+u+s+10}function nt(n,t){var i=0,u=n.find("div.advansed-filter-container:first"),r=n.find("div.advansed-filter-sort-container:first");r.length>0&&(r.addClass("sorter-isset"),t&&r.find("span.value:first").text(t).attr("title",t),i=n.hasClass("disable-sorter-block")?0:r.width(),u.css("margin-right",(i>0?i+38:0)+22+"px"),n.find("div.advansed-filter-helper:first").css("margin-right",(i>0?i+38:0)+22+"px"),n.find("label.advansed-filter-state:first").css("left","auto").css("right",(i>0?i+38:0)+"px"),c(n))}function c(n){var tt=n.width(),s=n.find("div.advansed-filter-input:first"),p=n.find("div.advansed-filter-button:first"),t=n.find("div.advansed-filter-filters:first"),f=t.find("div.hidden-filters-container:first"),it=f.find("div.filter-item"),r,e,o;if(s.length===0||t.length===0||tt===0)return undefined;t.find("div.filter-item").length===0?(t.addClass("empty-list"),n.addClass("empty-filter-list")):(t.removeClass("empty-list"),n.removeClass("empty-filter-list"));t.removeClass("has-hidden-filters");it.removeClass("hidden-filter").insertAfter(f);for(var h=0,c=null,u=null,l=0,a=n.data("filteroptions"),w=n.find("div.advansed-filter-container:first"),i=t.find("div.filter-item:first"),b=t.find("div.filter-item"),k=!1,l=b.length;l--;)u=jQuery(b[l]),c=u.find("span.selector-wrapper:first"),h=u.find("span.title:first").width()+8,u.width(h+c.width()),c.css("left",h+"px");if(s[0].style.marginLeft="auto",k=ti(w,t,i),i.length&&k)for(t.addClass("has-hidden-filters"),i=t.find("div.filter-item:first:visible");i.length>0&&ti(w,t,i);)u=i,i=i.next("div.filter-item"),u.addClass("hidden-filter").appendTo(f);t.find("div.hidden-filter").length>0?t.addClass("has-hidden-filters"):t.removeClass("has-hidden-filters");for(var d=f.find("div.filter-item"),g=d.length,rt=0;g--;)d[g].style.zIndex=++rt;if(a&&typeof a=="object"&&a.colcount>1){if(r=n.find("ul.item-list.filter-list.multi-column:first"),r.addClass("show-item-list").height()>0&&!r.hasClass("is-render")){var v=0,nt=0,y=r.find("li.item-group-col");for(r.width("auto"),e=y.length;e--;)v=uf(y[e]),y[e].style.width=v+"px",nt+=v;r.addClass("is-render").width(nt+20+"px")}r.removeClass("show-item-list")}o=t.width()+2;p.css("left",o+"px");n.find("div.advansed-filter-list:first").css("left",o+"px");s[0].style.marginLeft=p[0].offsetWidth+o+"px"}function uf(n){var t=n.getBoundingClientRect();return Math.ceil(t.width)}function ii(n,t,i){if(i.addClass("reset-position").parents("div.advansed-filter-control:first").appendTo(t.parents("div.hidden-filters-container:first").length===0?t:t.parents("div.advansed-filter-filters:first").find("div.btn-show-hidden-filters:first")),t.parents("div.hidden-filters-container:first").length>0)return undefined;if(n.width()-t[0].offsetLeft-t.parent()[0].offsetLeft-t.width()<i.width()){var r=i.width()-(n.width()-t[0].offsetLeft-t.parent()[0].offsetLeft-t.width())+40,f=i.find("div.control-top:first")[0].offsetLeft||0,u=parseFloat(i.css("margin-left"));i.removeClass("reset-position").css("margin-left",-r+"px").find("div.control-top:first").css("left",f+r-(isFinite(u)?Math.abs(u):0)+"px")}}function tt(n){var u=n.find("div.advansed-filter-support:first"),f=n.find("label.advansed-filter-label:first"),i=n.find("input.advansed-filter-input:first"),e=n.find("div.advansed-filter-container:first"),o=n.find("div.advansed-filter-list:first"),r=i.attr("id")||Math.floor(Math.random()*1e6),t;i.attr("id",r);f.attr("for",r);t=u.innerWidth();e.css("margin-left",t+"px");o.css("margin-left",t+"px")}function ff(n,t){t===!0?n.removeClass("disable-sorter-block"):n.addClass("disable-sorter-block")}function ri(n,t){typeof n=="function"&&jQuery(function(n,t){return function(){setTimeout(function(){n.apply(window,t)},1)}}(n,t))}function ui(n,t){if(n=n.hasClass("advansed-filter")?n:n.find("div.advansed-filter:first"),n.length===0)return undefined;if(t.hasOwnProperty("anykey")&&t.anykey===!0){var i=t.hasOwnProperty("anykeytimeout")?t.anykeytimeout:rt;if(i=isFinite(+i)?+i:rt,i>0){et=i;n.find("input.advansed-filter-input:first").off("keyup paste",yi).on("keyup paste",yi)}else n.find("input.advansed-filter-input:first").off("keyup paste",p).on("keyup paste",p)}else n.find("input.advansed-filter-input:first").off("keyup paste",pi).on("keyup paste",pi);n.find("input.advansed-filter-input:first").off("keyup paste input",fi).on("keyup paste input",fi);n.find(".btn-start-filter:first").off("click",wi).on("click",wi);n.find("label.btn-reset-filter:first").off("click",bi).on("click",bi);n.find("ul.filter-list:first").off("click",hi).on("click",hi);n.find("ul.sorter-list:first").off("click",ci).on("click",ci);n.find("div.btn-show-filters:first").off("click",ei).on("click",ei);n.find("span.btn-toggle-sorter:first").off("click",si).on("click",si);n.find("div.advansed-filter-sort-container:first span.title:first").off("click",oi).on("click",oi);n.find("div.advansed-filter-filters:first").off("click",li).on("click",li);n.find("div.advansed-filter-userselector:first").off("click",ai).on("click",ai);n.find("div.advansed-filter-groupselector:first").off("click",vi).on("click",vi)}function u(n){var t=n&&typeof n=="object"?jQuery(n.target):null;if(t&&t.is("span.btn-show-datepicker")&&t.parents("div.hidden-filters-container:first").length>0||t&&t.is("span.combobox-title")&&t.parents("div.hidden-filters-container:first").length>0||t&&t.is("span.combobox-title-inner-text")&&t.parents("div.hidden-filters-container:first").length>0){jQuery(document.body).off("click",arguments.callee);jQuery(document.body).one("click",arguments.callee);return jQuery("div.advansed-filter").find("span.advansed-filter-dateselector-date").removeClass("showed-datepicker").find("span.advansed-filter-datepicker-container").hide(),undefined}n===!0&&jQuery(document.body).trigger("click");jQuery("div.advansed-filter").removeClass("showed-filters").find("ul.filter-list:first").hide();jQuery("div.advansed-filter").removeClass("showed-sorters").find("ul.sorter-list:first").hide();jQuery("div.advansed-filter").removeClass("showed-hidden-filters").find("div.hidden-filters-container:first").hide();jQuery("div.advansed-filter").removeClass("showed-userselector").find("div.advansed-filter-userselector-container:first").hide();jQuery("div.advansed-filter").removeClass("showed-groupselector").find("div.advansed-filter-groupselector-container:first").hide();jQuery("div.advansed-filter").find("span.advansed-filter-dateselector-date").removeClass("showed-datepicker").find("span.advansed-filter-datepicker-container").hide()}function fi(){this.value?this.parentNode.classList.add("has-value"):this.parentNode.classList.remove("has-value")}function ei(n){var t=jQuery(this).parents("div.advansed-filter:first");if(t.hasClass("showed-filters"))return undefined;u(n);jQuery(document.body).off("click",u);t.addClass("showed-filters").find("ul.filter-list:first").show();setTimeout(function(){jQuery(document.body).one("click",u)},1)}function oi(n){var t=jQuery(this).parents("div.advansed-filter:first");if(t.hasClass("disable-sorter-block")||t.find("div.advansed-filter-sort-container:first").hasClass("sorter-nochange")||t.hasClass("showed-sorters"))return undefined;u(n);jQuery(document.body).off("click",u);t.addClass("showed-sorters").find("ul.sorter-list:first").show();setTimeout(function(){jQuery(document.body).one("click",u)},1)}function si(){var n=jQuery(this).parents("div.advansed-filter:first"),t,i;if(n.hasClass("disable-sorter-block")||(t=n.find("li.sorter-item.selected:first"),n.length===0||t.length===0))return undefined;i=t.attr("data-id")||null;i&&v(n,i,{dsc:t.hasClass("asc-sort")})}function hi(n){var t=jQuery(n.target),r;if(t.hasClass("filter-item")||(t=t.parents("li.filter-item:first")),r=t.parents("div.advansed-filter:first"),r.length===0||t.length===0||t.hasClass("hidden-item")||t.hasClass("disabled-item"))return undefined;for(var u=r.data("filtervalues"),f=0,e=t.attr("data-id")||"",i=null,f=u?u.length:0;f--;)if(u[f].id===e){i=u[f];break}i.params||(i.params=i.multiselect===!0?[]:{});i!=null&&gt(r,i)}function ci(n){var t=jQuery(n.target),i,r,u;if(t.hasClass("sorter-item")||(t=t.parents("li.sorter-item:first")),i=t.parents("div.advansed-filter:first"),i.length===0||t.length===0)return undefined;r=t.attr("data-id")||null;r&&(u=t.hasClass("asc-sort"),t.hasClass("asc-sort")||t.hasClass("dsc-sort")||!t.hasClass("dsc-sort-default")||(u=!0),v(i,r,{dsc:u}))}function li(n){var i=null,r=null,t=jQuery(n.target),o,s;if(i=t.parents("div.advansed-filter:first"),r=t.hasClass("filter-item")?t:t.parents("div.filter-item:first"),t.hasClass("btn-show-hidden-filters"))return(o=jQuery(this).parents("div.advansed-filter:first"),o.hasClass("showed-hidden-filters"))?undefined:(u(n),jQuery(document.body).off("click",u),o.addClass("showed-hidden-filters").find("div.hidden-filters-container:first").show(),setTimeout(function(){jQuery(document.body).one("click",u)},1),undefined);if(t.hasClass("btn-show-datepicker"))return s=t.parents("span.advansed-filter-dateselector-date:first"),su(n,i,r,s),undefined;if(i.length===0||r.length===0)return undefined;if(t.hasClass("btn-delete")){for(var h=r.attr("data-id"),e=i.data("filtervalues"),f=0,f=e?e.length:0;f--;)if(e[f].id===h)break;return ni(i,f!==-1?e[f]:null,r),undefined}(t.hasClass("group-selector")||t.parents("span.group-selector:first").length>0)&&kr(i,r);(t.hasClass("person-selector")||t.parents("span.person-selector:first").length>0)&&uu(i,r)}function ai(n){var t=null,i=jQuery(n.target);if(t=i.parents("div.advansed-filter:first"),t.length===0)return undefined;n.stopPropagation()}function vi(n){var t=null,i=jQuery(n.target);if(t=i.parents("div.advansed-filter:first"),t.length===0)return undefined;n.stopPropagation()}function p(n){if(ef(n.keyCode)){var e=jQuery(this),r=e.val(),u=e.parents("div.advansed-filter:first"),t=u.data("filtervalues"),i;if(t&&t.length!==0){for(i=t.length;i--;)if(t[i].id==="text")break;i!==-1&&(t[i].params||r)&&(r?f(u,null,t[i],{value:r}):a(u,null,t[i]))}}}function yi(n){clearTimeout(ft);ft=setTimeout(function(){p.call(n.target,n)},et)}function pi(n){switch(n.keyCode){case 13:p.call(n.target,n)}}function ef(n){return![9,16,17,18,19,20,27,33,34,35,36,37,38,39,40,44,45,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145].includes(n)}function wi(){var u=jQuery(this),i=u.parents("div.advansed-filter:first"),r=i.find("input.advansed-filter-input:first").val(),n=i.data("filtervalues"),t=0;if(!n||n.length===0)return undefined;for(t=n.length;t--;)if(n[t].id==="text")break;t!==-1&&(typeof r=="string"&&r.length>0?f(i,null,n[t],{value:r}):a(i,null,n[t]))}function bi(){var n=jQuery(this).parents("div.advansed-filter:first"),i=n.data("filtervalues"),v=n.data("sortervalues"),r=0,t=null,c=null,e=n.find("div.filter-item"),s=null,u=0,f=!1;for(o=!0,n.removeClass("has-filters").find("div.advansed-filter-input:first").removeClass("has-value").find("input.advansed-filter-input:first").val(""),r=i?i.length:0;r--;)t=i[r],t.id==="text"&&t.isset===!0&&(f=!0,a(n,null,t)),t.id==="sorter"&&(c=t);for(u=e.length;u--;)f=!0,s=jQuery(e[u]),h(n,s,!0);o=!1;f===!0&&l(n,null,!0)}function sf(n,t,i){r!==i&&ki(n,t,undefined,!0)}function ki(n,t,i,r){var s=t.length>0?t.data("filtervalues")||[]:[],u=lt(n,t);if(r===!0)for(var h=null,f=null,o=0,e=0,o=s.length;o--;){for(f=s[o],h=f.id,e=u.length;e--;)if(u[e].id==h)break;e===-1&&u.push({id:f.id,type:f.type,reset:!0})}u.length>0&&it(null,t,u,null,i)}function it(n,t,i,r,f){var nt=!1,it=!1,et=!1,w=!1,s=t.filter(":first"),b=s.length>0?s.data("filtervalues")||[]:[],lt=s.length>0?s.data("sortervalues")||[]:[],a=0,e=null,h=null,d,ot,st,ht,ct,y,rt,g,ut,k,ft,p;if(et=!1,n&&((!s.hasClass("no-button")&&n.hasButton===!1||s.hasClass("no-button")&&(typeof n.hasButton=="undefined"||n.hasButton===!0))&&(et=!0),s[n.hasButton===!1?"addClass":"removeClass"]("no-button")),r===null)for(r=[],d=i.length;d--;)if(i[d].id==="sorter"&&i[d].params){e=i[d];h={id:e.params.id,title:e.params.title,dsc:e.params.dsc,sortOrder:e.params.sortOrder,selected:e.selected===!0};r.push(h);break}for(n=n||{},o=!0,nt=!1,it=!1,ot=r.find(function(n){return n.selected}),y=0,rt=r.length;y<rt;y++){if(h=r[y],h.visible===!0&&tf(s,h.id,!0),h.visible===!1&&rf(s,h.id,!0)&&(it=!0),h.selected===!0&&v(s,h.id,{dsc:h.dsc===!0||h.sortOrder==="descending"},!0)){it=!0;break}ot||h.def!==!0||v(s,h.id,{dsc:h.dsc===!0||h.sortOrder==="descending"},!0)}for(st=s.find("li.item-item.sorter-item").not(".hidden-item"),st.length===1&&s.find(".advansed-filter-sort-container:first").addClass("sorter-nochange"),w=!1,ht=s.find("li.item-item.filter-item"),ct=s.find("div.advansed-filter-filters:first div.filter-item"),y=0,rt=i.length;y<rt;y++){if(e=i[y],(e.hasOwnProperty("visible")||e.hasOwnProperty("enable")||e.hasOwnProperty("reset")||e.hasOwnProperty("params"))&&(g=ht.filter('[data-id="'+e.id+'"]'),ut=ct.filter('[data-id="'+e.id+'"]')),e.visible===!0?bu(g):e.visible===!1&&ku(s,ut,g,!0)&&(w=!0),e.enable===!0?du(g):e.enable===!1&&gu(s,ut,g,!0)&&(w=!0),e.type==="combobox"&&e.hasOwnProperty("options")){for(a=b.length;a--;)if(e.id===b[a].id)break;a!==-1&&(k=b[a],k.options=e.options.slice(0),ft="-1",p=null,ft=typeof e.defaultvalue=="string"&&e.defaultvalue.length>0?e.defaultvalue:ft,p=typeof e.defaulttitle=="string"&&e.defaulttitle.length>0?e.defaulttitle:p,p=typeof k.defaulttitle=="string"&&k.defaulttitle.length>0?k.defaulttitle:p,p&&k.options.unshift({value:ft,classname:"default-value",title:p,def:!0}))}if(e.visible!==!1&&e.hasOwnProperty("params")&&e.params){for(a=b.length;a--;)if(e.id!=="sorter"&&e.id==b[a].id)break;a!==-1&&gt(s,b[a],e.params,!0)&&(w=!0)}(e.reset===!0||e.hasOwnProperty("params")&&e.params===null)&&nf(s,ut,!0)&&(w=!0)}if((e.hasOwnProperty("visible")||e.hasOwnProperty("enable"))&&lr(s),n.store===!0&&!s.hasClass("is-init")&&(ki(n,s,!0),n.inhash===!0))try{ASC.Controls.AnchorController.bind(function(n,t){return function(i){sf(n,t,i)}}(n,s))}catch(at){}o=!1;s.hasClass("is-init")||f!==!0&&(tt(s),s.addClass("is-init"),l(s),nt=!0);et==!0&&(u(!0),c(s));f!==!0&&nt!==!0&&(w===!0||it===!0)&&(nt=!0,l(s));s.trigger("adv-ready",[s,n,f])}function hf(n,t,i){for(var u=n.filter(":first"),e=u.length>0?u.data("filtervalues")||[]:[],r=0,r=e.length;r--;)if(t==e[r].id)break;r!==-1&&f(u,null,e[r],i)}function cf(n){var u=n.filter(":first"),t=u.data("filtervalues"),i=0,r=[];if(!t||t.length===0)return r;for(y(u,!0),i=t.length;i--;)t[i].isset===!0&&r.unshift(t[i]);return r}function lf(n){var i=!1,t=n.filter(":first"),r=t.length>0?t.data("filtervalues")||[]:[],e=t.find("div.advansed-filter-filters:first div.filter-item"),s=null,u=0,f=0;for(o=!0,t.removeClass("has-filters").find("div.advansed-filter-input:first").removeClass("has-value").find("input.advansed-filter-input:first").val(""),f=r?r.length:0;f--;)filtervalue=r[f],filtervalue.id==="text"&&filtervalue.isset===!0&&(i=!0,t.find("input.advansed-filter-input:first").val(""),a(t,null,filtervalue));for(u=e.length;u--;)i=!0,s=jQuery(e[u]),h(t,s,!0);o=!1;i===!0&&l(t)}function di(n,t){var i=Math.floor(Math.random()*1e6);n.find("div.advansed-filter-hint-popup:first").attr("id",i).html(t);n.addClass("has-hint").find("label.advansed-filter-hint:first").attr("data-popupid",i).on("click",function(){jQuery(this).helper({BlockHelperID:jQuery(this).attr("data-popupid")});var n=jQuery("#"+jQuery(this).attr("data-popupid")),t=n.offset().top;n.offset().top>n.outerHeight()+20?n.removeClass("valign-bottom").addClass("valign-top").parents("div.advansed-filter-hint-popup-helper:first").removeClass("valign-bottom").addClass("valign-top").find("div.cornerHelpBlock:first").removeClass("pos_bottom").addClass("pos_top"):n.removeClass("valign-top").addClass("valign-bottom").parents("div.advansed-filter-hint-popup-helper:first").removeClass("valign-top").addClass("valign-bottom").find("div.cornerHelpBlock:first").removeClass("pos_top").addClass("pos_bottom")})}function af(t,i,r,u,f){var l=u.hasOwnProperty("zindex")?u.zindex===!0:!1,h=null,c=n(),e=null,s=0,o=null;for(h=n(hr(i,r,u)),wt(u,h,i,r),ui(h,u),f=f&&typeof f=="object"?f:null,s=t.length;s--;){if(o=n(t[s]).val(""),(e=o.is("div.advansed-filter")?o:o.parents("div.advansed-filter:first")).length>0){l===!0&&e.css("z-index",100-s);continue}e=h.clone(!0);e.insertBefore(o).attr("id",o.attr("id")||null);o.remove();e=e.hasClass("advansed-filter")?e:e.find("div.advansed-filter:first");l===!0&&e.css("z-index",100-s);e.addClass("has-events").data("filtervalues",i).data("sortervalues",r).data("customdata",f).data("filteroptions",u);u.hasOwnProperty("help")&&e.addClass("has-help").find("div.advansed-filter-helper:first").html(['<label class="advansed-filter-helper-label"><\/label>',u.help].join(""));!u.hintDefaultDisable&&u.hasOwnProperty("hint")&&di(e,u.hint);c=c.add(e)}return c}function vf(t,i,r,u,f){var c=u.hasOwnProperty("zindex")?u.zindex===!0:!1,h=n(),e=null,o=0,s=null;for(f=f&&typeof f=="object"?f:null,o=t.length;o--;)(s=n(t[o]).val(""),(e=s.is("div.advansed-filter")?s:s.parents("div.advansed-filter:first")).length!==0)&&(e.hasClass("has-events")||(e.find("input.advansed-filter:first").val("").attr("maxlength",u.hasOwnProperty("maxlength")?u.maxlength:null),wt(u,e,i,r),ui(e,u),c===!0&&e.css("z-index",100-o),e.addClass("has-events").data("filtervalues",i).data("sortervalues",r).data("customdata",f).data("filteroptions",u),u.hasOwnProperty("help")&&e.addClass("has-help").find("div.advansed-filter-helper:first").html(['<label class="advansed-filter-helper-label"><\/label>',u.help].join("")),!u.hintDefaultDisable&&u.hasOwnProperty("hint")&&di(e,u.hint)),h=h.add(e));return h}var rt=500,r="",ut={filterContainer:"template-filter-container",filterItem:"template-filter-item"},w=!0,o=!1,ft=0,et=0,gi={},nr=[{type:"sorter",id:"sorter",hashmask:"sorter/{0}"},{type:"text",id:"text",hashmask:"text/{0}"}],tr=[],ot="/",b=location.pathname.split("/");b.splice(b.length-1,1);ot=b.join("/");n.fn.advansedFilter=n.fn.advansedfilter=function(t){var a,i,s;if(arguments.length===0)return cf(n(this));if(t===null)return lf(n(this));if(t&&typeof t=="string"){a=t;i=n(this).filter(":first");switch(a){case"sort":return ff(i,arguments.length>1?arguments[1]===!0:!0),nt(i),tt(i),c(i),undefined;case"filters":return ur(i);case"hash":return rr(i);case"storage":return lt();case"resetText":return ar(i);case"resize":return i.is(":visible")&&(u(),nt(i),tt(i),c(i)),undefined;default:return hf(i,arguments[0],arguments[1])}return undefined}var h=null,t=t&&typeof t=="object"?t:{},r=t.hasOwnProperty("filters")?t.filters:[],f=t.hasOwnProperty("sorters")?t.sorters:[],l=t.hasOwnProperty("resources")?t.resources:{},v=t.hasOwnProperty("maxfilters")?isFinite(+t.maxfilters)&&+t.maxfilters>=-1?+t.maxfilters:-1:-1,e=null,o=n(this);if(o.length===0)return o;for(s in l)l.hasOwnProperty(s)&&(gi[s]=l[s]);return(t.colcount=t.hasOwnProperty("colcount")&&isFinite(+t.colcount)?+t.colcount:1,t.colcount=t.colcount>4?4:t.colcount,!t.hintDefaultDisable&&ASC.Resources.Master.FilterHelpCenterLink&&(t.hint=t.hasOwnProperty("hint")?t.hint:ASC.Resources.Master.ResourceJS.AdvansedFilterInfoText.format("<b>","<\/b>",'<br/><br/><a href="'+ASC.Resources.Master.FilterHelpCenterLink+'" target="_blank">',"<\/a>")),h={maxfilters:v},r=at(r,JSON.parse(jQuery.toJSON(nr))),f=at(f,JSON.parse(jQuery.toJSON(tr))),(e=vf(o,r,f,t,h)).length===o.length)?(ri(it,[t,e,r,f,t.nonetrigger]),e):(e=af(o,r,f,t,h),ri(it,[t,e,r,f,t.nonetrigger]),e)}})(jQuery,window,document,document.body);
(function(n){function c(n){var t=n.getAttribute("data-id");return{item:jq(n),id:t}}function e(n,t){return t=t||this.$itemsListSelector,Array.from(t.find("li"+(n||""))).map(c)}function t(n,t,i){for(var f,s,u,e=Array.from(this.$itemsListSelector.find("li"+(i||""))),o={},r=0;r<e.length;r++)f=c(e[r]),o[f.id]=f;for(r=0,s=n.length;r<s;r++)u=o[n[r]],u&&u.item.length&&t(u.item)}function ut(){var t=this,f=t.$element,r=t.options;r.isInitializeItems&&"initAdvSelectorData"in t&&(t.initAdvSelectorData.call(t),t.options.showGroups&&(t.options.groupsChoose.length?t.rewriteObjectGroup.call(t,t.options.groupsChoose):"initAdvSelectorGroupsData"in t&&t.initAdvSelectorGroupsData.call(t)));f.on("click",st.bind(t));if(r.canadd)t.$advancedSelector.find(".advanced-selector-add-new-link").on("click",vt.bind(t));n(document.body).on("keyup",et.bind(t));t.$advancedSelector.find(".advanced-selector-block-list .advanced-selector-all-select div").on("click",d.bind(t));t.$advancedSelector.find(".advanced-selector-block-list .advanced-selector-all-select").on("click",bt.bind(t));t.$advancedSelector.find(".advanced-selector-search-field").on("keyup",ot.bind(t));t.$advancedSelector.find(".advanced-selector-search-field").on("mousedown",function(){jq(this).addClass("selection")});t.$advancedSelector.find(".advanced-selector-search-field").on("mouseup",function(){jq(this).removeClass("selection")});t.$advancedSelector.find(".advanced-selector-search-field").on("blur",function(){jq(this).removeClass("selection")});t.$advancedSelector.find(".advanced-selector-search-btn").on("click",t.options.isTempLoad?t.onSearchItemsTempLoad.bind(t):t.onSearchItems.bind(t));t.$advancedSelector.find(".advanced-selector-reset-btn").on("click",u.bind(t));t.$advancedSelector.on("click",r.onechosen?".advanced-selector-list-items li":".advanced-selector-btn-action",rt.bind(t));t.$advancedSelector.on("click",".advanced-selector-list-block .advanced-selector-btn-cancel",ht.bind(t));n(document.body).on("click",ft.bind(t));jq(window).on("resizeWinTimerWithMaxDelay",function(){l.call(t)});n(document).on("keyup",function(n){var u,r;t.$advancedSelector.is(":visible")&&(r||(r=n),r.keyCode?u=r.keyCode:r.which&&(u=r.which),u==27&&i.call(t))})}function ft(n){var t=this,u=n&&typeof n=="object"?jQuery(n.target):null,r;if(t.$advancedSelector.is(":visible")||t.$advancedSelector.hide(),u.closest(t.$advancedSelector).length===0&&t.$advancedSelector.is(":visible")&&u.closest(t.$element).siblings(".advanced-selector-container").length===0){if(r=t.$advancedSelector.find(".advanced-selector-search-field.selection"),r.length){r.removeClass("selection");return}i.call(t)}}function et(n){var t=this,i=t.$itemsListSelector.find("li:visible");t.$advancedSelector.is(":visible")&&!t.$advancedSelector.find(".advanced-selector-add-new-block").is(":visible")&&p(n,i)}function p(t,i){function f(t){i.parent().find("li.active").removeClass("active");switch(t){case"up":r=r<=0?i.length-1:--r;break;case"down":r=r==i.length-1?0:++r}n(i[r]).addClass("active");var u=n(i[r]).position().top;i.parent().scrollTop(u-i.position().top)}var t=t||window.event,u=t.keyCode||t.charCode,r=i.index(i.filter(".active"));if(i.length!=0&&(u==40||u==38||u==13)){t.preventDefault();t.stopPropagation();switch(u){case 38:f("up");break;case 40:f("down");break;case 13:n(i[r]).trigger("click")}}}function ot(t){var i=this,f=n(t.target),u=f.siblings(".advanced-selector-search-btn"),e=f.siblings(".advanced-selector-reset-btn"),o=i.$itemsListSelector.find("li:not(.disabled)"),s=i.$advancedSelector.find(".advanced-selector-no-results"),r=i.$advancedSelector.find(".advanced-selector-all-select");i.options.showGroups?r.hasClass("chosen")||r.find("label").trigger("click"):r=i.$itemsListSelector.siblings(".advanced-selector-all-select");f.val()!==""?(u.trigger("click"),u.hide(),e.show(),i.options.showGroups||r.hide()):(s.hide(),o.show(),u.show(),e.hide(),i.options.isTempLoad?i.initAdvSelectorDataTempLoad.call(i):u.trigger("click"),i.options.showGroups||r.show())}function u(){var n=this,t=n.$advancedSelector.find(".advanced-selector-search .advanced-selector-reset-btn"),r=t.siblings(".advanced-selector-search-btn"),u=n.$itemsListSelector.find("li:not(.disabled)"),f=n.$advancedSelector.find(".advanced-selector-no-results"),i=n.$advancedSelector.find(".advanced-selector-all-select"),e=n.$advancedSelector.find(".advanced-selector-no-items");n.options.onechosen&&n.options.showGroups&&(n.$groupsListSelector.find("ul li").removeClass("chosen"),n.$groupsListSelector.siblings(".advanced-selector-all-select").addClass("chosen"));n.options.showGroups?i.hasClass("chosen")||i.find("label").trigger("click"):i.show();t.siblings("input").val("");f.hide();e.hide();u.show();t.hide();r.show();n.options.isTempLoad?n.initAdvSelectorDataTempLoad.call(n):n.options.isTempLoad?n.onSearchItemsTempLoad.call(n):n.onSearchItems.call(n)}function st(){var n=this,t=n.$itemsListSelector.find(".advanced-selector-list li");n.$element.hasClass("disabled")||(n.$element.trigger("additionalClickEvent"),n.$advancedSelector.is(":visible")?i.call(n):(l.call(n),n.$advancedSelector.show(),w.call(n)),t.length===0&&(n.options.itemsChoose.length?n.rewriteObjectItem.call(n,n.options.itemsChoose):!n.options.isInitializeItems&&"initAdvSelectorData"in n&&n.initAdvSelectorData.call(n),n.options.showGroups&&(n.options.groupsChoose.length?n.rewriteObjectGroup.call(n,n.options.groupsChoose):"initAdvSelectorGroupsData"in n&&n.initAdvSelectorGroupsData.call(n))),n.$itemsListSelector.find(".advanced-selector-list li").filter(":visible").length?n.$advancedSelector.find(".advanced-selector-empty-list").hide():n.$advancedSelector.find(".advanced-selector-empty-list").show())}function l(){if(this.$element.length){var t=this,i=t.$element,r=t.options.inPopup?i.position():i.offset(),u=r.left,f=r.top+i.outerHeight()+4,e=t.options.$parent||n(window),c=e.width(),l=e.height(),a=e.scrollTop(),v=e.scrollLeft(),o=t.$advancedSelector.find(".advanced-selector-add-new-block"),h=t.$advancedSelector.widthCounted+parseInt(t.$advancedSelector.css("border-left-width"),10)+parseInt(t.$advancedSelector.css("border-right-width"),10),s=t.$advancedSelector.heightCounted+parseInt(t.$advancedSelector.css("border-top-width"),10)+parseInt(t.$advancedSelector.css("border-bottom-width"),10);i.offset().left+h-(o.length&&!o.hasClass("right-position")?o.outerWidth():0)>v+c&&(u=Math.max(0,u+t.$element.outerWidth()-h));o.is(":visible")&&(u-=t.widthAddBlock);!jq.browser.mobile&&f+s>l+a&&(f=r.top-s);t.options.$parent&&i.offset().top+s>t.options.$parent.offset().top+t.options.$parent.height()&&(f=r.top-s-4);t.$advancedSelector.css({top:f,left:u})}}function w(){var n=this;n.$advancedSelector.find(".advanced-selector-search-field").trigger("focus")}function ht(){i.call(this);ct.call(this)}function i(){var n=this;u.call(n);n.$advancedSelector.hide();o.call(n);n.$itemsListSelector.find("ul li").removeClass("active");n.$itemsListSelector.find("ul").scrollTop(0)}function ct(){var n=this,i,t,r;for(n.$advancedSelector.find(".advanced-selector-list-items li").removeClass("selected selected-before"),n.$advancedSelector.find(".advanced-selector-all-select div").removeClass("checked").removeClass("indeterminate"),i=e.call(n),t=0,r=i.length;t<r;t++)i[t].item[0].getElementsByTagName("div")[0].classList.remove("checked");n.options.showGroups&&(n.$advancedSelector.find(".advanced-selector-list-groups li").removeClass("selected"),n.$advancedSelector.find(".advanced-selector-list-groups div").removeClass("checked").removeClass("indeterminate"));n.itemsSelectedIds=n.options.itemsSelectedIds;u.call(n);nt.call(n,Object.keys(n.options.itemsSelectedIds))}function b(n){var i=this;t.call(i,n,function(n){n.addClass("selected-before")},":not(.disabled)");nt.call(i,n)}function lt(){for(var o,u,i,f,t=this,e={},n=0,r=t.items.length;n<r;n++)e[t.items[n].id]=undefined;for(n=0,o=t.groups.length;n<o;n++)for(u=window.GroupManager.getGroupItems(t.groups[n].id),t.groups[n].items=[],i=0,r=u.length;i<r;i++)f=u[i],e.hasOwnProperty(f)&&t.groups[n].items.push(f)}function a(n){for(var i=this,t=0,r=i.groups.length;t<r;t++)if(n==i.groups[t].id)return i.groups[t].items;return[]}function at(n,t){for(var i=0,r=t.length;i<r;i++)if(n==t[i].id)return t[i];return null}function v(n){var t=this,i,r;n&&(i=t.$groupsListSelector.find("li.chosen"),r=t.$advancedSelector.find(".advanced-selector-all-select").hasClass("chosen"),i&&i.length?t.$advancedSelector.find(".advanced-selector-add-new-block .advanced-selector-field-wrapper."+n+" .advanced-selector-field-list li[data-id="+i.attr("data-id")+"]").trigger("click"):r&&t.$advancedSelector.find(".advanced-selector-add-new-block .advanced-selector-field-wrapper."+n+" .advanced-selector-reset-btn").trigger("click"))}function vt(){var n=this,t=n.$advancedSelector.find(".advanced-selector-add-new-block"),i=n.options.inPopup?n.$advancedSelector.position().left:n.$advancedSelector.offset().left;t.length?t.is(":visible")?o.call(n):(t.show(),t.hasClass("right-position")||n.$advancedSelector.css({left:i-n.widthAddBlock}),n.$advancedSelector.css({width:n.widthAddBlock+(n.options.showGroups?n.widthSelector*2:n.widthSelector+5)+"px"}),k.call(n)):("initCreationBlock"in n&&n.initCreationBlock.call(n,{items:n.items,groups:n.groups}),yt.call(n),k.call(n))}function o(){var n=this;n.$advancedSelector.find(".advanced-selector-add-new-block").hide();n.$advancedSelector.css({width:(n.options.showGroups?n.widthSelector*2:n.widthSelector+5)+"px"});l.call(n)}function yt(){var i=this,t=i.$advancedSelector.find(".advanced-selector-add-new-block");t.find(".advanced-selector-btn-cancel").on("click",o.bind(i));t.find(".advanced-selector-btn-add").on("click",pt.bind(i));n(document).on("keyup",function(n){var r,i;t.is(":visible")&&(i||(i=n),i.keyCode?r=i.keyCode:i.which&&(r=i.which),r==13&&t.find(".advanced-selector-btn-add").trigger("click"))})}function k(){var n=this;n.$advancedSelector.find(".advanced-selector-add-new-block input[type=text]").first().trigger("focus")}function pt(t){var i=this,r=n(t.target),u=i.$advancedSelector.find(".advanced-selector-add-new-block");u.find(".advanced-selector-field-wrapper").removeClass("error");i.hideServerError(r);"createNewItemFn"in i&&i.createNewItemFn.call(i)}function wt(n){if(n){var t=this.$groupsListSelector.find(".advanced-selector-list li[data-id="+n+"]");t.find("div").addClass("indeterminate").removeClass("checked");t.length&&!t.hasClass("chosen")&&t.find("label").trigger("click")}}function d(t){var i=this,y=n(t.target).closest(".advanced-selector-all-select"),h=y.find("div"),c=h.hasClass("checked"),l,v,p,o,a,s,w;if(i.options.onechosen){y.trigger("click");return}for(n(t.target).is("div")||(c=h.hasClass("checked")),h.removeClass("indeterminate"),i.itemsSelectedIds={},l=i.items,o=0,a=l.length;o<a;o++)(v=l[o].id,i.options.itemsDisabledIds.find(function(n){return n===v}))||(c?delete i.itemsSelectedIds[v]:i.itemsSelectedIds[v]=undefined);for(f.call(i,l),p=e.call(i,null,i.$groupsListSelector),o=0,a=p.length;o<a;o++)s=p[o].item[0],w=s.getElementsByTagName("div")[0],w.classList.remove("indeterminate"),c?(s.classList.remove("selected"),w.classList.remove("checked")):(s.classList.remove("chosen"),s.classList.add("selected"),s.getElementsByTagName("div")[0].classList.add("checked"));c?h.removeClass("checked"):h.addClass("checked");y.toggleClass("chosen",!c);i.$advancedSelector.find(".advanced-selector-no-items").hide();u.call(i);r.call(i,i.$itemsListSelector.find("li:not(.disabled)"));t.stopPropagation()}function bt(t){var i=this,r=n(t.target).closest(".advanced-selector-all-select"),u=n(t.target).closest("div");if(!i.options.showGroups&&!t.target.isEqualNode(u[0])){d.call(i,t);return}r.hasClass("chosen")||(i.$advancedSelector.find(".advanced-selector-no-items").hide(),f.call(i,i.items),i.$groupsListSelector&&i.$groupsListSelector.find("li").removeClass("chosen"),r.addClass("chosen"),v.call(i,i.nameSimpleSelectorGroup))}function r(n){var t=Object.keys(this.itemsSelectedIds).length,i=n.parents(".advanced-selector-block").find(".advanced-selector-selected-count");t>0?i.text(t+" "+ASC.Resources.Master.ResourceJS.SelectorSelectedItems).show():i.text("").hide()}function kt(n,t){if(n.length>t.length)return!1;for(var i=0;i<n.length;i++)if(t.indexOf(n[i])===-1)return!1;return!0}function g(t,i){var u=this,h,e,o,c,f;if(i?(h=t.item,e=h,o=h[0].getElementsByTagName("div"),f=t.id):(h=n(t.target),e=n(t.target).closest("li"),o=e[0].getElementsByTagName("div"),f=e[0].getAttribute("data-id")),c=o[0]&&o[0].classList.contains("checked"),!e.hasClass("disabled"))return u.options.onechosen?(u.$itemsListSelector.find("li.selected").removeClass("selected"),e.addClass("selected"),u.itemsSelectedIds={},u.itemsSelectedIds[f]=undefined):(c?(o[0].classList.remove("checked"),delete u.itemsSelectedIds[f],e[0].classList.remove("selected")):(o[0].classList.add("checked"),e[0].classList.add("selected"),u.itemsSelectedIds[f]=undefined),i||(s.call(u,u.$itemsListSelector),r.call(u,u.$itemsListSelector))),c?delete u.itemsSelectedIds[f]:u.itemsSelectedIds[f]=undefined,i||u.$groupsListSelector&&u.$groupsListSelector.length&&y.call(u,[f],!c),f}function dt(n){for(var t,u=[],i=0,f=n.length;i<f;i++)u.push(g.call(this,n[i],!0));t=this;t.options.onechosen||(s.call(t,t.$itemsListSelector),r.call(t,t.$itemsListSelector));t.$groupsListSelector&&t.$groupsListSelector.length&&y.call(t,u,!0)}function nt(i){var u=this,c=[],e=[],v=[],o,y,l,h,p,f;if(t.call(u,i,function(n){n[0].classList.add("selected");var t=n[0].getElementsByTagName("div")[0];t&&!t.classList.contains("checked")&&t.classList.add("checked")},":not(.disabled)"),u.$groupsListSelector&&u.$groupsListSelector.length)for(c=n.grep(u.items,function(t){return n.inArray(t.id,i)!=-1}),c.forEach(function(n){e=e.concat(n.groups).unique()}),c.forEach(function(n){v.push(n.id)}),o=0,y=e.length;o<y;o++)l=u.$groupsListSelector.find("li[data-id="+e[o].id+"]"),h=a.call(u,e[o].id),h=n.grep(h,function(t){return n.inArray(t,u.options.itemsDisabledIds)==-1}),n(l).length&&(p=kt(h,v)?!0:!1,f=l.find("div")[0],f&&(p?(f.classList.add("checked"),f.classList.remove("indeterminate")):(f.classList.add("indeterminate"),f.classList.remove("checked"))));s.call(u,u.$itemsListSelector);r.call(u,u.$itemsListSelector)}function s(){var r=Object.keys(this.itemsSelectedIds).length,n=this.$advancedSelector.find(".advanced-selector-all-select"),i,t;r===0?(i=!1,t=!1):(t=!0,r===this.items.length-this.options.itemsDisabledIds.length&&(i=!0,t=!1));i?n.find("div").addClass("checked"):n.find("div").removeClass("checked");t?n.find("div").addClass("indeterminate"):n.find("div").removeClass("indeterminate");i||t||n.removeClass("chosen")}function y(t,i){function w(n){return function(t){return t.id===n}}for(var f,o,v,s,y,u=this,h={},e,r,l=0,p=t.length;l<p;l++)if(f=UserManager.getUser(t[l]),f&&f.groups)for(o=0;o<f.groups.length;o++)h[f.groups[o]]=undefined;v=Array.from(u.$groupsListSelector.find("li")).map(c);for(s in h)h.hasOwnProperty(s)&&(r=v.find(w(s)),r)&&(r=r.item.find("div"),e=a.call(u,s),i?tt.call(u,e)?(r.removeClass("indeterminate").addClass("checked"),r.closest("li").not(".selected").addClass("selected")):r.addClass("indeterminate"):tt.call(u,e)||(y=Object.keys(u.itemsSelectedIds).some(function(t){return n.inArray(t,e)!==-1}),r.removeClass("checked").removeClass("indeterminate"),r.closest("li").removeClass("selected"),y&&r.addClass("indeterminate")))}function tt(n){var t,r,i;if(!n.length)return!1;for(t=0,r=n.length;t<r;t++)if((i=n[t],!(this.options.itemsDisabledIds.indexOf(i)>-1))&&!this.itemsSelectedIds.hasOwnProperty(i))return!1;return!0}function gt(t){function d(n){return n===p}var i=this,o=n(t.target),c=o.closest("li"),u=o[0].classList.contains("checked"),b=[],p,w,l,k,f,v,h;if(it.call(this,t),i.options.onechosen){c.trigger("click");return}for(i.$advancedSelector.find(".advanced-selector-search-field").val(""),u?c.removeClass("selected"):(i.$advancedSelector.find(".advanced-selector-all-select").removeClass("chosen"),c.addClass("selected")),o.removeClass("indeterminate"),u?o.removeClass("checked"):o.addClass("checked"),p=c.attr("data-id"),b=a.call(i,p),w=e.call(i,":not(.disabled)"),l=0,k=w.length;l<k;l++)(f=w[l],v=UserManager.getUser(f.id),v&&v.groups&&v.groups.some(d))&&(i.options.itemsDisabledIds.hasOwnProperty(f.id)||(h=f.item,u?delete i.itemsSelectedIds[f.id]:i.itemsSelectedIds[f.id]=undefined,u?h[0].classList.remove("selected"):h[0].classList.add("selected"),u?h[0].getElementsByTagName("div")[0].classList.remove("checked"):h[0].getElementsByTagName("div")[0].classList.add("checked")));y.call(i,b,!u,i.$advancedSelector);s.call(i,i.$itemsListSelector);r.call(i,i.$itemsListSelector);t.stopPropagation()}function it(t){function l(n){return n===o}var i=this,u=n(t.target).closest("li"),o=u.attr("data-id"),s=i.$groupsListSelector.find("li"),h=i.$groupsListSelector.siblings(".advanced-selector-all-select"),e=i.$advancedSelector.find(".advanced-selector-no-items"),c=i.$advancedSelector.find(".advanced-selector-no-results"),r;h.removeClass("chosen");s.removeClass("chosen");u.addClass("chosen");e.hide();c.hide();r=i.items.filter(function(n){var t=UserManager.getUser(n.id);return t&&t.groups&&t.groups.some(l)});f.call(i,r);r.length===0&&e.show();v.call(i,i.nameSimpleSelectorGroup)}function rt(t){var r=this,o=n(t.target),s=r.itemsSelectedIds,u=[],h,f,e;r.options.itemsSelectedIds=jq.extend({},r.itemsSelectedIds);for(f in s)s.hasOwnProperty(f)&&(e=at(f,r.items),e!==null&&u.push(e));if(r.options.onechosen&&o.hasClass("selected-before")){o.removeClass("selected-before");i.call(r);return}r.selectedItems=u;i.call(r);h=r.options.onechosen?u:[u];r.$element.trigger("showList",h);delete r.selectedItems}function ni(){var n=this;n.$groupsListSelector.off("click").on("click","ul li div",gt.bind(n)).on("click","ul li",it.bind(n))}jQuery.expr.pseudos.icontains=function(n,t,i){return jQuery(n).text().toUpperCase().indexOf(i[3].toUpperCase())>=0};Array.prototype.unique=function(){for(var t,n=this.concat(),i=0;i<n.length;++i)for(t=i+1;t<n.length;++t)n[i]===n[t]&&n.splice(t--,1);return n};Array.prototype.chunkArray=function(n){for(var r,i=[],t=0;t<this.length;t+=n)r=this.slice(t,t+n),i.push(r);return i};var ti=function(t){function o(n){var t=n&&typeof n=="object"?jQuery(n.target):null;t.closest(".advanced-selector-field-search").length===0&&(i.hide(),i.find("li.active").removeClass("active"),i.scrollTop(0))}function s(t){var i=r.find("li:visible");n(i).parent().is(":visible")&&p(t,i)}function h(n){var n=n||window.event,h=n.keyCode||n.charCode;if(h!=13){var t=r.find("input").val(),o=i.find('li:icontains("'+t+'")'),s=r.parents(".advanced-selector-field-wrapper");i.hide();i.find("li.selected").removeClass("selected");r.find("input").attr("data-id","");i.find("li").removeClass("chosen").hide();o.length?(i.show(),o.addClass("chosen").show(),s.removeClass("error")):u.showErrorField.call(u,{field:s,error:""});t.length?(f.show(),e.hide()):(f.hide(),e.show())}}function c(t){var r=n(t.target),o=r.parent().siblings(".advanced-selector-field");i.find("li.selected").removeClass("selected");r.addClass("selected");o.val(r.text());o.attr("data-id",r.attr("data-id"));i.hide();f.show();e.hide();"onChooseItemSimpleSelector"in u&&u.onChooseItemSimpleSelector.call(this,{id:r.attr("data-id")})}function l(){var n=t.find(".advanced-selector-field-search:first"),i=n.find(".advanced-selector-field-list");n.parents(".advanced-selector-field-wrapper").removeClass("error");n.find("input").val("").removeAttr("data-id");i.find("li").removeClass("selected").show();i.hide();f.hide();e.show()}var u=this,r=t.find(".advanced-selector-field-search:first"),i=r.find(".advanced-selector-field-list"),f=t.find(".advanced-selector-reset-btn"),e=t.find(".advanced-selector-search-btn");r.find("input").on("keyup",h).on("focus",function(){n(this).hasClass("disabled")||(i.find("li.chosen").length||r.find("input").val()=="")&&i.show()});r.find("li").on("click",c.bind(u));u.$advancedSelector.on("click",o);f.on("click",l);n(document.body).on("keyup",s.bind(u))},ii=function(n){var r=this,e,l,i,o,s,h,c;if(r.options.showme)for(e={},i=0,l=n.length;i<l;i++)if(n[i].id==Teamlab.profile.id){e=n[i];e.title=ASC.Resources.Master.ResourceJS.MeLabel;n.splice(i,1);n.unshift(e);break}var a=document.createDocumentFragment(),y=document.createElement("li"),p=document.createElement("div"),w=document.createElement("img"),b=document.createElement("label"),k=!r.options.onechosen,d=Math.ceil(r.heightListWithoutCreate/r.heightListItem);for(i=0;i<n.length;i++){var t=n[i],v=typeof t.title=="string"?Encoder.htmlDecode(t.title):t.title,u=y.cloneNode(!1),f="";u.title=t.tooltip||v;o=document.createAttribute("data-id");o.value=t.id;u.setAttributeNode(o);t.status&&(f+=" "+t.status);t.type&&(f+=" "+t.type);r.itemsSelectedIds.hasOwnProperty(t.id)&&(f+=" selected");r.options.itemsDisabledIds.indexOf(t.id)>-1&&(f+=" disabled");f&&(u.className=f);k&&(s=p.cloneNode(!1),r.itemsSelectedIds.hasOwnProperty(t.id)&&(s.className="checked"),u.append(s));t.avatarSmall&&(h=w.cloneNode(!1),h.setAttribute(i>d?"data-src":"src",t.avatarSmall),u.append(h));c=b.cloneNode(!1);c.innerText=v;u.append(c);a.append(u)}return a},f=function(n){var t=this,i,u,r;(!t.options.canadd&&t.options.showGroups||t.options.isTempLoad)&&(i=184);t.options.onechosen&&(i=t.options.canadd?t.heightListChooseOne:t.heightListWithoutCreate);t.options.onechosen||!t.options.canadd||t.options.showGroups||(i=124);t.options.height&&(i=t.options.height);u=t.$itemsListSelector.find(".advanced-selector-list")[0];u.style.display="none";r=document.createElement("ul");r.className=u.className;r.appendChild(ii.call(t,n));i&&(t.$itemsListSelector.height(i),r.style.height=i+"px");jq(u).replaceWith(r);r.addEventListener("scroll",ri);u.style.display=""},ri=function(){var n=jq(this),t=n.offset().top,i=t+n.height();n.find("img[data-src]").each(function(){var n=jq(this),r=n.offset().top,f=r+n.height(),u;if(r>i)return!1;if(f<t)return!0;u=n.attr("data-src");n.removeAttr("data-src").attr("src",u)})},h=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.advancedSelector.defaults,i);this.init()};h.prototype={constructor:h,init:function(){var t=this,u,i,s,f,e,r,o,h,c;if(t.heightListWithoutCreate=226,t.heightListChooseOne=196,t.heightListItem=30,t.widthSelector=t.options.width?t.options.width:211,t.widthAddBlock=216,t.items=[],t.groups=[],t.nameSimpleSelectorGroup="",t.cache={},t.itemsSelectedIds={},Array.isArray(t.options.itemsSelectedIds))for(u=t.options.itemsSelectedIds.concat([]),t.options.itemsSelectedIds={},i=0,s=u.length;i<s;i++)t.options.itemsSelectedIds[u[i]]=undefined,t.itemsSelectedIds[u[i]]=undefined;f=5;e=n.tmpl(t.options.templates.selectorContainer,{opts:t.options});t.options&&t.$element.after(e);t.$advancedSelector=e;t.$itemsListSelector=t.$advancedSelector.find(".advanced-selector-list-items");t.options.showGroups&&(t.$groupsListSelector=t.$advancedSelector.find(".advanced-selector-list-groups"));t.$advancedSelector.widthCounted=t.options.showGroups?t.widthSelector*2:t.widthSelector+f;t.$advancedSelector.css({width:t.$advancedSelector.widthCounted});(t.options.height||t.options.width)&&(r=t.$advancedSelector.find(".advanced-selector-list-block"),t.options.height&&(o=r.innerHeight()-r.height(),t.$advancedSelector.css({height:t.options.height+o}),t.$advancedSelector.heightCounted=t.options.height+o),t.options.width&&(h=r.innerWidth()-r.width(),c=(t.options.showGroups?t.widthSelector:t.widthSelector+f)-h,t.$advancedSelector.find(".advanced-selector-block-list").css({width:c+"px"})));t.options.height||(t.$advancedSelector.heightCounted=t.$advancedSelector.outerHeight());ut.call(t)},displayAddItemBlock:function(t){var i=this,e=i.$advancedSelector.find(".advanced-selector-add-new-block"),u=n(window).scrollLeft(),f=i.options.inPopup?i.$advancedSelector.position().left:i.$advancedSelector.offset().left,r=n.tmpl(i.options.templates.addNewPanel,{fields:t.newoptions,btnTitle:t.newbtn});u+i.$advancedSelector.offset().left<i.widthAddBlock?(i.$advancedSelector.append(r),i.$advancedSelector.find(".advanced-selector-add-new-block").addClass("right-position")):(i.$advancedSelector.prepend(r),i.$advancedSelector.css({left:f-i.widthAddBlock}));i.$advancedSelector.css({width:i.widthAddBlock+(i.options.showGroups?i.widthSelector*2:i.widthSelector+5)+"px"})},displayLoadingBtn:function(n){var t=n.btn.parents(".advanced-selector-btn-cnt"),i='<div class="advanced-selector-loader">'+n.text+"<\/div>";t.find("button").addClass("disable");t.append(i);this.$advancedSelector.find(".advanced-selector-add-new-block input").attr("disabled","disabled")},hideLoadingBtn:function(t){var i=n(t).parents(".advanced-selector-btn-cnt");i.find("button").removeClass("disable");i.find(".advanced-selector-loader").remove();this.$advancedSelector.find(".advanced-selector-add-new-block input").prop("disabled",!1)},showErrorField:function(t){n(t.field).addClass("error");n(t.field).find(".advanced-selector-field-error").text(t.error)},showServerError:function(t){var i='<div class="advanced-selector-server-error" title="{0}">{0}<\/div>'.format(Encoder.htmlEncode(t.error));n(t.field).parents(".advanced-selector-btn-cnt").append(i)},hideServerError:function(n){n.parents(".advanced-selector-btn-cnt").find(".advanced-selector-server-error").remove()},actionsAfterCreateItem:function(t){var i=this,u=t.newitem,r=t.response,e=t.nameProperty,s,f,c,h;if(r.hasOwnProperty(e)){for(s=Array.isArray(r[e])?r[e][0].id:r[e],f=0,c=i.groups.length;f<c;f++)s==i.groups[f].id&&i.groups[f].items.push(r.id);u.groups=r.groups}i.items.push(u);h=n.tmpl(i.options.templates.itemList,{Items:[u],isJustList:i.options.onechosen});(i.options.showme||i.options.withadmin)&&i.$itemsListSelector.find("li").not(".disabled").length?i.$itemsListSelector.find(".advanced-selector-list li:not(.disabled)").first().after(h):i.$itemsListSelector.find(".advanced-selector-list").prepend(h);i.select.call(i,[u.id]);i.$advancedSelector.find(".advanced-selector-add-new-block input").val("");i.$advancedSelector.find(".advanced-selector-no-results, .advanced-selector-no-items, .advanced-selector-empty-list").hide();i.options.onechosen||i.$advancedSelector.find(".advanced-selector-all-select").show();i.options.showSearch&&i.$advancedSelector.find(".advanced-selector-search").show();i.options.showGroups&&wt.call(i,s);i.$element.trigger("afterCreate",u);o.call(i)},disableDefaultItemsIds:function(n){var i=this;t.call(i,n,function(n){n.addClass("disabled")})},onSearchItems:function(){var n=this,i;if(n.$advancedSelector.find(".advanced-selector-loader-list").is(":visible")){setTimeout(function(){n.onSearchItems.call(n)},100);return}var r=n.$advancedSelector.find(".advanced-selector-search-field"),t=r.length!==0?r.val().trim():"",u=n.$advancedSelector.find(".advanced-selector-no-results");u.hide();t=t.toLowerCase();i=n.items;t&&(i=i.filter(function(n){return Encoder.htmlDecode(n.title).toLowerCase().indexOf(t)>-1}));f.call(n,i);t&&!i.length&&u.show()},initDataSimpleSelector:function(t){var i=this,r=t.tag,f=n.tmpl(i.options.templates.addNewItems,{Items:t.items}),u=i.$advancedSelector.find(".advanced-selector-field-wrapper."+r);i.nameSimpleSelectorGroup=r;u.find(".advanced-selector-field-list").html(f);ti.call(i,u);i.options.showGroups&&v.call(i,r)},showLoaderSimpleSelector:function(n){var t=this.$advancedSelector.find(".advanced-selector-field-wrapper."+n+" .advanced-selector-field-search");t.append('<div class="advanced-selector-field-loader"><\/div>')},hideLoaderSimpleSelector:function(n){var t=this.$advancedSelector.find(".advanced-selector-field-wrapper."+n+" .advanced-selector-field-search");t.find(".advanced-selector-field-loader").remove()},rewriteObjectItem:function(n){var r=this,t,u,i;for(r.items=[],t=0,u=n.length;t<u;t++)i={},i.title=n[t].displayName||n[t].title||n[t].name||n[t].Name,n[t].hasOwnProperty("id")?i.id=n[t].id:n[t].hasOwnProperty("Id")&&(i.id=n[t].Id),n[t].hasOwnProperty("isPending")&&(i.status=n[t].isPending||n[t].isActivated===!1?ASC.Resources.Master.ResourceJS.UserPending:""),(n[t].hasOwnProperty("groups")||n[t].hasOwnProperty("projectId"))&&(i.groups=n[t].groups||[{id:n[t].projectId.toString()}],n[t].groups&&n[t].groups.length&&!n[t].groups[0].id&&i.groups.map(function(n){n.id=n.ID})),n[t].hasOwnProperty("contactclass")&&(i.type=n[t].contactclass),n[t].hasOwnProperty("isPrivate")&&(i.data=n[t].isPrivate),r.items.push(i);r.items=r.items.sort(r.options.sortMethod||SortData);r.$element.data("items",r.items);r.showItemsListAdvSelector.call(r)},rewriteObjectGroup:function(n){var t=this,i,u,r;for(t.groups=[],i=0,u=n.length;i<u;i++)r={},r.title=n[i].name||n[i].title,r.id=n[i].id,r.items=n[i].items||[],t.groups.push(r);t.groups=t.groups.sort(SortData);t.options.showGroups&&t.showGroupsListAdvSelector.call(t)},showItemsListAdvSelector:function(){var n=this;f.call(n,n.items);n.$itemsListSelector.off("click").on("click","li",g.bind(n));n.$itemsListSelector.find("li:not(.disabled)").length?(n.$advancedSelector.find(".advanced-selector-empty-list").hide(),n.options.showSearch&&n.$advancedSelector.find(".advanced-selector-search").show(),n.$advancedSelector.find(".advanced-selector-all-select").show()):(n.$advancedSelector.find(".advanced-selector-empty-list").show(),n.$advancedSelector.find(".advanced-selector-search").hide(),n.$advancedSelector.find(".advanced-selector-all-select").hide());n.options.showGroups?ni.call(n):b.call(n,Object.keys(n.options.itemsSelectedIds));w.call(n)},showGroupsListAdvSelector:function(){var t=this,i,r;t.groups.length?(i=[],t.groups.chunkArray(1e3).forEach(function(r){i.push(n.tmpl(t.options.templates.groupList,{Items:r,isJustList:t.options.onechosen}))}),t.$groupsListSelector.find(".advanced-selector-list").html(i)):t.$groupsListSelector.find(".advanced-selector-no-groups").show();t.options.onechosen&&(r=t.options.canadd?t.heightListChooseOne:t.heightListWithoutCreate-t.heightListItem,t.$groupsListSelector.find(".advanced-selector-list").height(r));lt.call(t);b.call(t,Object.keys(t.itemsSelectedIds))},showLoaderListAdvSelector:function(n){var t=this,i;switch(n){case"items":i=t.$itemsListSelector;break;case"groups":if(!t.$groupsListSelector)return;i=t.$groupsListSelector}t.$advancedSelector.find(".advanced-selector-add-new, .advanced-selector-all-select").hide();i.append('<div class="advanced-selector-loader-list"><\/div>')},hideLoaderListAdvSelector:function(){this.$advancedSelector.find(".advanced-selector-add-new, .advanced-selector-all-select").show();this.$advancedSelector.find(".advanced-selector-loader-list").hide()},reset:function(n){var t=this,f=n||!1,i=t.$itemsListSelector.find("ul li");i.filter(".selected,.selected-before").removeClass("selected selected-before");f||i.removeClass("disabled");t.$advancedSelector.find(".advanced-selector-list li div, .advanced-selector-all-select div").removeClass("checked").removeClass("indeterminate");t.options.showGroups&&(t.$advancedSelector.find(".advanced-selector-list-groups li").removeClass("selected"),t.$advancedSelector.find(".advanced-selector-list-groups div").removeClass("checked").removeClass("indeterminate"));t.itemsSelectedIds={};t.options.itemsSelectedIds={};u.call(t);r.call(t,t.$itemsListSelector)},select:function(n){for(var o,u,f,i=this,s=i.options.itemsSelectedIds,t=0,r=n.length;t<r;t++)s[n[t]]=undefined;if(o=e.call(i),o.length){for(u=[],t=0,r=o.length;t<r;t++)(f=o[t],i.itemsSelectedIds.hasOwnProperty(f.id))||i.options.itemsDisabledIds.hasOwnProperty(f.id)||s.hasOwnProperty(f.id)&&u.push(f);if(dt.call(this,u),i.options.onechosen)for(t=0,r=u.length;t<r;t++)rt.call(i,{target:u[t].item})}},unselect:function(n){for(var i=this,u=i.options.itemsSelectedIds,r=0,f=n.length;r<f;r++)delete u[n[r]];t.call(i,n,function(n){i.options.onechosen&&n.removeClass("selected");var t=n[0].getElementsByTagName("div");t&&t.length&&t[0].classList.contains("checked")&&n.trigger("click")})},disable:function(n){var i=this;i.unselect.call(i,n);i.options.itemsDisabledIds=i.options.itemsDisabledIds.concat(n).unique();t.call(i,n,function(n){n.addClass("disabled").hide()})},undisable:function(i){var r=this;r.options.itemsDisabledIds=n.grep(r.options.itemsDisabledIds,function(t){return n.inArray(t,i)==-1});t.call(r,i,function(n){n.removeClass("disabled").show()})},add:function(t){var i=this,u=n.grep(i.items,function(n){return n.id==t.id}).length,r;u?(r=i.$itemsListSelector.find("ul li[data-id="+t.id+"]"),r.hasClass("disabled")&&r.removeClass("disabled")):"addNewItemObj"in i&&i.$itemsListSelector.find("ul li").length&&i.addNewItemObj.call(i,t)},rewriteItemList:function(n,t){var i=this,r;if(n=n||[],t=t||[],i.$itemsListSelector.find("ul li").length)i.rewriteObjectItem.call(i,n),i.select.call(i,t);else for(i.options.itemsChoose=n,i.itemsSelectedIds={},i.options.itemsSelectedIds={},r=0;r<t.length;r++)i.itemsSelectedIds[t[r]]=undefined,i.options.itemsSelectedIds[t[r]]=undefined},selectBeforeShow:function(n){this.$element.trigger("showList",arguments);this.select([n.id])}};n.fn.advancedSelector=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var u=n(this),r=u.data("advancedSelector"),f=n.extend({},n.fn.advancedSelector.defaults,u.data(),typeof t=="object"&&t);r||u.data("advancedSelector",r=new h(this,f));typeof t=="string"&&r[t].apply(r,i)})};n.fn.advancedSelector.defaults={itemsChoose:[],groupsChoose:[],itemsSelectedIds:[],itemsDisabledIds:[],showGroups:!1,onechosen:!1,canadd:!1,showme:!1,showSearch:!0,inPopup:!1,isInitializeItems:!1,isTempLoad:!1,$parent:null,templates:{selectorContainer:"template-selector-container",itemList:"template-selector-items-list",groupList:"template-selector-groups-list",addNewPanel:"template-selector-add-new-item",selectedItemsList:"template-selector-selected-items",addNewItems:"template-selector-add-new-list-items",addNewItemsSelect:"template-selector-add-new-select-items"}};n.fn.advancedSelector.Constructor=h})(jQuery,window,document,document.body);
(function(n){var t=ASC.Resources.Master.ResourceJS,i=Teamlab,r=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.useradvancedSelector.defaults,i);this.init()};r.prototype=n.extend({},n.fn.advancedSelector.Constructor.prototype,{constructor:r,initCreationBlock:function(n){for(var o,r=this,f={},s=[],e=n.groups,u=0,h=e.length;u<h;u++)s.push({title:e[u].title,id:e[u].id});f.newoptions=[{title:t.SelectorType,type:"choice",tag:"type",items:[{type:"user",title:t.SelectorUser},{type:"visitor",title:t.SelectorVisitor}]},{title:t.SelectorFirstName,type:"input",tag:"first-name"},{title:t.SelectorLastName,type:"input",tag:"last-name"},{title:t.SelectorEmail,type:"input",tag:"email"},{title:t.SelectorGroup,type:"select",tag:"group"}];f.newbtn=t.InviteButton;r.displayAddItemBlock.call(r,f);r.initDataSimpleSelector.call(r,{tag:"group",items:s});o=r.$advancedSelector.find(".advanced-selector-add-new-block");r.options.withGuests?i.getQuotas({},{success:function(n,t){t.availableUsersCount==0&&o.find(".type select").val("visitor").prop("disabled",!0)},error:function(){}}):o.find(".type").hide()},getTooltip:function(n){var t=Encoder.htmlDecode(n.displayName)+"\n"+n.email;return(n.isPending||n.isActivated===!1)&&(t+=" ("+ASC.Resources.Master.ResourceJS.UserPending+")"),t},initAdvSelectorData:function(){var t=this,u=[],i=window.UserManager.getAllUsers(!t.options.showDisabled),r,n,f;for(r in i)i.hasOwnProperty(r)&&(n=i[r],t.options.withGuests||!n.isVisitor)&&(f={title:n.displayName,id:n.id,isVisitor:n.isVisitor,status:n.isPending||n.isActivated===!1?"pending":"",groups:window.GroupManager.getGroups(n.groups),avatarSmall:n.avatarSmall,tooltip:t.getTooltip(n)},u.push(f));t.rewriteObjectItem.call(t,u.sort(SortData))},initAdvSelectorGroupsData:function(){var n=this,t;n.rewriteObjectGroup.call(n,window.GroupManager.getGroupsArray());n.options.isAdmin&&(t=[],n.$groupsListSelector.find(".advanced-selector-list li").hide(),n.items.forEach(function(n){t=t.concat(n.groups).unique()}),t.forEach(function(t){n.$groupsListSelector.find(".advanced-selector-list li[data-id="+t.id+"]").show()}))},rewriteObjectItem:function(n){var t=this;t.items=n;t.$element.data("items",t.items);t.showItemsListAdvSelector.call(t)},createNewItemFn:function(){var n=this,r=n.$advancedSelector.find(".advanced-selector-add-new-block"),e=r.find(".advanced-selector-btn-add"),f,o,s,u;if(n.options.withGuests)switch(r.find(".type select").val()){case"user":o=!1;break;case"visitor":o=!0}else o=!1;if(s=r.find(".group input").attr("data-id"),u={isVisitor:o,firstname:r.find(".first-name input").val().trim(),lastname:r.find(".last-name input").val().trim(),email:r.find(".email input").val().trim(),department:s&&s.length?[s]:[]},u.firstname||(n.showErrorField.call(n,{field:r.find(".first-name"),error:t.ErrorEmptyUserFirstName}),f=!0),u.lastname||(n.showErrorField.call(n,{field:r.find(".last-name"),error:t.ErrorEmptyUserLastName}),f=!0),u.firstname&&u.firstname.length>64&&(n.showErrorField.call(n,{field:r.find(".first-name"),error:t.ErrorMesLongField64}),f=!0),u.lastname&&u.lastname.length>64&&(n.showErrorField.call(n,{field:r.find(".last-name"),error:t.ErrorMesLongField64}),f=!0),jq.isValidEmail(u.email)||(n.showErrorField.call(n,{field:r.find(".email"),error:t.ErrorNotCorrectEmail}),f=!0),!u.department.length&&r.find(".group input").val()&&(n.showErrorField.call(n,{field:r.find(".group"),error:t.ErrorGroupNotExist}),f=!0),f){r.find(".error input").first().trigger("focus");return}i.getQuotas({},{success:function(r,f){if(f.availableUsersCount==0&&!u.isVisitor){n.showServerError.call(n,{field:e,error:t.UserSelectorErrorLimitUsers+" "+f.maxUsersCount});return}i.addProfile({},u,{before:function(){n.displayLoadingBtn.call(n,{btn:e,text:t.LoadingProcessing})},success:function(i,r){r=this.__responses[0];var u={id:r.id,title:r.displayName,isVisitor:r.isVisitor,isPending:!0,status:"pending",groups:[],avatarSmall:r.avatarSmall,tooltip:n.getTooltip(r)},f=Object.assign({},r);f.groups=(r.groups||[]).map(function(n){return n.id});UserManager.addNewUser(f);toastr.success(t.UserSelectorAddSuccess.format("<b>"+u.title+"<\/b>"));n.actionsAfterCreateItem.call(n,{newitem:u,response:r,nameProperty:"groups"})},error:function(){n.showServerError.call(n,{field:e,error:this.__errors[0]})},after:function(){n.hideLoadingBtn.call(n,e)}})},error:function(){}})},addNewItemObj:function(n){var t={id:n.id,title:n.displayName,isVisitor:n.isVisitor,status:n.isPending||n.isActivated===!1?"pending":"",groups:[],avatarSmall:profile.avatarSmall,tooltip:that.getTooltip(profile)};this.actionsAfterCreateItem.call(this,{newitem:t,response:n,nameProperty:"groups"})}});n.fn.useradvancedSelector=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var f=n(this),u=f.data("useradvancedSelector"),e=n.extend({},n.fn.useradvancedSelector.defaults,f.data(),typeof t=="object"&&t);u||f.data("useradvancedSelector",u=new r(this,e));typeof t=="string"&&u[t].apply(u,i)})};n.fn.useradvancedSelector.defaults=n.extend({},n.fn.advancedSelector.defaults,{showme:!0,addtext:t.UserSelectorAddText,noresults:t.UserSelectorNoResults,noitems:t.UserSelectorNoItems,nogroups:t.UserSelectorNoGroups,emptylist:t.UserSelectorEmptyList,isAdmin:!1,withGuests:!0,showDisabled:!1,isInitializeItems:!0})})(jQuery);
(function(n){var t=ASC.Resources.Master.ResourceJS,i=Teamlab,r=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.groupadvancedSelector.defaults,i);this.init()};r.prototype=n.extend({},n.fn.advancedSelector.Constructor.prototype,{constructor:r,initCreationBlock:function(){var n=this,r={},u=[],f;r.newoptions=[{title:t.SelectorTitle,type:"input",tag:"title"},{title:t.SelectorHead,type:"select",tag:"manager"}];r.newbtn=t.CreateButton;n.displayAddItemBlock.call(n,r);f={employeeStatus:1,employeeType:1};i.getSimpleProfilesByFilter({},{before:n.showLoaderSimpleSelector.call(n,"manager"),filter:f,success:function(r,f){for(var e=0,o=f.length;e<o;e++)f[e].id==i.profile.id?u.unshift({title:t.MeLabel,id:f[e].id}):u.push({title:f[e].displayName,id:f[e].id});n.initDataSimpleSelector.call(n,{tag:"manager",items:u});n.hideLoaderSimpleSelector.call(n,"manager")},error:function(n,t){toastr.error(t)}})},initAdvSelectorData:function(){var n=this;n.rewriteObjectItem.call(n,window.GroupManager.getGroupsArray())},rewriteObjectItem:function(n){var t=this,i,e,r,u,f;for(t.items=[],i=0,e=n.length;i<e;i++)r={},r.title=n[i].name,r.id=n[i].id,t.items.push(r);t.items=t.items.sort(SortData);t.options.withadmin&&(u=ASC.Resources.Master.GroupSelector_WithGroupAdmin,t.items.unshift({id:u.Id,title:u.Name}));t.options.witheveryone&&(f=ASC.Resources.Master.GroupSelector_WithGroupEveryone,t.items.unshift({id:f.Id,title:f.Name}));t.$element.data("items",t.items);t.showItemsListAdvSelector.call(t)},createNewItemFn:function(){var n=this,r=n.$advancedSelector.find(".advanced-selector-add-new-block"),e=r.find(".advanced-selector-btn-add"),f,o=r.find(".manager input").attr("data-id"),u={groupName:r.find(".title input").val().trim(),groupManager:o&&o.length?o:"00000000-0000-0000-0000-000000000000",groupId:null,members:[]};if(u.groupName||(n.showErrorField.call(n,{field:r.find(".title"),error:t.ErrorEmptyGroupTitle}),f=!0),u.groupName&&u.groupName.length>64&&(n.showErrorField.call(n,{field:r.find(".title"),error:t.ErrorMesLongField64}),f=!0),u.groupManager=="00000000-0000-0000-0000-000000000000"&&r.find(".manager input").val().trim()&&(n.showErrorField.call(n,{field:r.find(".manager"),error:t.ErrorHeadNotExist}),f=!0),f){r.find(".error input").first().trigger("focus");return}i.addGroup(null,u,{before:function(){n.displayLoadingBtn.call(n,{btn:e,text:t.LoadingProcessing})},after:function(){n.hideLoadingBtn.call(n,e)},error:function(){n.showServerError.call(n,{field:e,error:this.__errors[0]})},success:function(i,r){r=this.__responses[0];var u={id:r.id,title:r.name,head:r.manager};toastr.success(t.GroupSelectorAddSuccess.format("<b>"+Encoder.htmlEncode(u.title)+"<\/b>"));n.actionsAfterCreateItem.call(n,{newitem:u,response:r})}})},addNewItemObj:function(n){var t=this,i={id:n.id,title:n.name,head:n.manager};t.actionsAfterCreateItem.call(t,{newitem:i,response:n})}});n.fn.groupadvancedSelector=function(t,i){return this.each(function(){var u=n(this),f=u.data("groupadvancedSelector"),e=n.extend({},n.fn.groupadvancedSelector.defaults,u.data(),typeof t=="object"&&t);f||u.data("groupadvancedSelector",f=new r(this,e));typeof t=="string"&&f[t](i)})};n.fn.groupadvancedSelector.defaults=n.extend({},n.fn.advancedSelector.defaults,{addtext:t.GroupSelectorAddText,noresults:t.GroupSelectorNoResults,emptylist:t.GroupSelectorEmptyList,witheveryone:!1,withadmin:!1,isInitializeItems:!0})})(jQuery);
(function(n){var t=ASC.Resources.Master.ResourceJS,i=Teamlab,r=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.contactadvancedSelector.defaults,i);this.init()};r.prototype=n.extend({},n.fn.advancedSelector.Constructor.prototype,{constructor:r,initCreationBlock:function(n){var i=this,e={},o=[],u=n.items,f,r,s;e.newoptions=[{title:t.SelectorContactType,type:"choice",tag:"type",items:[{type:"person",title:t.SelectorPerson},{type:"company",title:t.SelectorCompany}]},{title:t.SelectorFirstName,type:"input",tag:"first-name"},{title:t.SelectorLastName,type:"input",tag:"last-name"},{title:t.SelectorCompany,type:"select",tag:"company"},{title:t.SelectorCompanyName,type:"input",tag:"title"}];e.newbtn=t.CreateButton;i.displayAddItemBlock.call(i,e);f=i.$advancedSelector.find(".advanced-selector-field-wrapper.type .advanced-selector-field");f.on("change",function(){var n=f.val();switch(n){case"person":i.$advancedSelector.find(".advanced-selector-field-wrapper.first-name, .advanced-selector-field-wrapper.last-name, .advanced-selector-field-wrapper.company").show();i.$advancedSelector.find(".advanced-selector-field-wrapper.title").hide();break;case"company":i.$advancedSelector.find(".advanced-selector-field-wrapper.first-name, .advanced-selector-field-wrapper.last-name, .advanced-selector-field-wrapper.company").hide();i.$advancedSelector.find(".advanced-selector-field-wrapper.title").show()}});for(f.trigger("change"),r=0,s=u.length;r<s;r++)u[r].type=="company"&&o.push({title:u[r].title,id:u[r].id});i.initDataSimpleSelector.call(i,{tag:"company",items:o});i.hideLoaderSimpleSelector.call(i,"company")},initAdvSelectorDataTempLoad:function(){function u(n,i){var u,f,r,e,o;if(t.options.withPhoneOnly&&(i=i.filter(function(n){return n.commonData&&n.commonData.some(function(n){return n.infoType==0})||n.phone})),t.selectedItems)for(r=0;r<t.selectedItems.length;r++)u=t.selectedItems[r],i.find(function(n){return n.id==u.id})||i.push(u);for(t.cache[""]=i,t.rewriteObjectItem.call(t,i),f=Object.keys(t.itemsSelectedIds),r=0,e=f.length;r<e;r++)o=t.$itemsListSelector.find(".advanced-selector-list"),i.forEach(function(n){n.id==f[r]&&o.find("li[data-id="+n.id+"]").not(".selected").remove()})}function f(n,t){toastr.error(t)}var t=this,r=0;t.cache[""]?u(null,t.cache[""]):i.getCrmContacts({},{filter:{startIndex:r,Count:15},before:function(){t.showLoaderListAdvSelector.call(t,"items")},after:function(){t.hideLoaderListAdvSelector.call(t,"items")},success:u,error:f});t.$advancedSelector.find(".advanced-selector-list").off("scroll").on("scroll",function(){var u=n(this);u.innerHeight()+u.scrollTop()>=u.prop("scrollHeight")&&t.options.showSearch&&t.$advancedSelector.find(".advanced-selector-search-field")&&(r+=15,i.getCrmContacts({},{filter:{startIndex:r,Count:15},success:function(n,i){var u,r,f,e;for(i.length&&i.forEach(function(n){t.cache[""].push(n)}),t.displayPartialList.call(t,n,i),u=Object.keys(t.itemsSelectedIds),r=0,f=u.length;r<f;r++)e=t.$itemsListSelector.find(".advanced-selector-list"),i.forEach(function(n){n.id==u[r]&&e.find("li[data-id="+n.id+"]").not(".selected").remove()});t.pushNewItemsInList.call(t,i)},error:function(n,t){toastr.error(t)}}))})},initAdvSelectorData:function(){var n=this;n.options.isTempLoad?n.initAdvSelectorDataTempLoad.call(n):i.getCrmContacts({},{before:function(){n.showLoaderListAdvSelector.call(n,"items")},after:function(){n.hideLoaderListAdvSelector.call(n,"items")},success:function(t,i){n.rewriteObjectItem.call(n,i)},error:function(n,t){toastr.error(t)}})},onSearchItemsTempLoad:function(){function o(i,r){var u,f;t.options.withPhoneOnly&&(r=r.filter(function(n){return n.commonData&&n.commonData.some(function(n){return n.infoType==0})||n.phone}));i&&(t.cache[i.__filter.prefix]=r);u=t.$advancedSelector.find(".advanced-selector-no-results");t.$itemsListSelector.find(".advanced-selector-list").html("");r.length==0?u.show():(u.hide(),t.displayPartialList.call(t,i,r),f=[],Object.keys(t.itemsSelectedIds).forEach(function(n){f.push(n)}),t.$itemsListSelector.find(".advanced-selector-list li").each(function(){var t=n(this);n.inArray(t.attr("data-id"),f)!=-1&&t.addClass("selected").find("input").prop("checked",!0)}),t.disableDefaultItemsIds.call(t,t.options.itemsDisabledIds))}function s(n,t){toastr.error(t)}var t=this,f=0,r=null,u={prefix:t.$advancedSelector.find(".advanced-selector-search-field").val(),searchType:-1,entityID:0,startIndex:f,Count:15},e;if(u.prefix in t.cache)r=t.cache[u.prefix];else for(e in t.cache)t.cache[e].length==0&&u.prefix.indexOf(e)==0&&(r=[]);if(r==null?i.getCrmContactsByPrefix({},{filter:u,success:o,error:s}):o(null,r),r==null||r.scrolled==!1)t.$advancedSelector.find(".advanced-selector-list").off("scroll").on("scroll",function(){var r=n(this);r.innerHeight()+r.scrollTop()>=r.prop("scrollHeight")&&t.options.showSearch&&t.$advancedSelector.find(".advanced-selector-search-field")&&(f+=15,i.getCrmContactsByPrefix({},{filter:{startIndex:f,Count:15,prefix:t.$advancedSelector.find(".advanced-selector-search-field").val(),searchType:-1,entityID:0},success:function(n,i){i.length&&i.forEach(function(i){t.cache[n.__filter.prefix].push(i)});t.displayPartialList.call(t,n,i)},error:s}))})},displayPartialList:function(t,i){for(var f,s,u=this,e=[],o=[],r=0,h=i.length;r<h;r++)f={},f.title=i[r].displayName||i[r].title||i[r].name||i[r].Name,f.id=i[r].id&&i[r].id.toString(),f.phone=i[r].phone?[i[r].phone]:i[r].commonData&&i[r].commonData.filter(function(n){return n.infoType==0}),i[r].hasOwnProperty("contactclass")&&(f.type=i[r].contactclass),e.push(f),u.items.forEach(function(n){o.push(n.id)}),n.inArray(f.id,o)==-1&&u.items.push(f);s=n.tmpl(u.options.templates.itemList,{Items:e,isJustList:u.options.onechosen});u.$itemsListSelector.find(".advanced-selector-list").append(s);u.disableDefaultItemsIds.call(u,u.options.itemsDisabledIds)},createNewItemFn:function(){var n=this,r=n.$advancedSelector.find(".advanced-selector-add-new-block"),o=r.find(".advanced-selector-btn-add"),e,f=r.find(".type select").val()=="company"?!0:!1,u={};if(f?u.companyName=r.find(".title input").val().trim():(u.firstName=r.find(".first-name input").val().trim(),u.lastName=r.find(".last-name input").val().trim(),u.companyId=r.find(".company input").attr("data-id")),f&&!u.companyName&&(n.showErrorField.call(n,{field:r.find(".title"),error:t.ContactSelectorEmptyNameError}),e=!0),f||u.firstName||(n.showErrorField.call(n,{field:r.find(".first-name"),error:t.ErrorEmptyUserFirstName}),e=!0),f||u.lastName||(n.showErrorField.call(n,{field:r.find(".last-name"),error:t.ErrorEmptyUserLastName}),e=!0),f||u.companyId||!r.find(".company input").val()||(n.showErrorField.call(n,{field:r.find(".company"),error:t.ContactSelectorNotFoundError}),e=!0),e){r.find(".error input").first().trigger("focus");return}i.addCrmContact({},f,u,{before:function(){n.displayLoadingBtn.call(n,{btn:o,text:t.LoadingProcessing})},error:function(t,i){n.showServerError.call(n,{field:o,error:i})},success:function(t,i){var r={id:i.id,title:i.displayName,phone:i.commonData&&i.commonData.filter(function(n){return n.infoType==0})};n.actionsAfterCreateItem.call(n,{newitem:r,response:i})},after:function(){n.hideLoadingBtn.call(n,o)}})},rewriteObjectItem:function(n){var t=this;t.items=[];t.pushNewItemsInList.call(t,n);t.options.isTempLoad||(t.items=t.items.sort(SortData));t.showItemsListAdvSelector.call(t)},pushNewItemsInList:function(n){for(var i,r=this,t=0,u=n.length;t<u;t++)i={},i.title=n[t].displayName||n[t].title||n[t].name||n[t].Name,i.id=n[t].id&&n[t].id.toString(),i.phone=n[t].commonData&&n[t].commonData.filter(function(n){return n.infoType==0}),n[t].hasOwnProperty("contactclass")&&(i.type=n[t].contactclass),r.items.push(i)}});n.fn.contactadvancedSelector=function(t,i){return this.each(function(){var u=n(this),f=u.data("contactadvancedSelector"),e=n.extend({},n.fn.contactadvancedSelector.defaults,u.data(),typeof t=="object"&&t);f||u.data("contactadvancedSelector",f=new r(this,e));typeof t=="string"&&f[t](i)})};n.fn.contactadvancedSelector.defaults=n.extend({},n.fn.advancedSelector.defaults,{showme:!0,addtext:t.ContactSelectorAddText,noresults:t.ContactSelectorNoResult,noitems:t.ContactSelectorNoItems,emptylist:t.ContactSelectorEmptyList,withPhoneOnly:!1})})(jQuery);
(function(n){function i(i){var r=null;return n.each(t,function(n,t){return i.is(t.obj)?(r=t,!1):!0}),r}function u(i){n.each(t,function(n,r){return i.is(r.obj)?(t.splice(n,1),!1):!0})}function f(t,i){var r=this;this.obj=t;this.input=this.obj.find(".emailselector-input");this.buffer=this.obj.find(".emailSelector-input-buffer");this.hiddenInput=n("<input>").attr("type","text").addClass("emailselector-hidden-input").insertBefore(this.input);this.settings=i||{};this.cache=[];this.firstFailTerm="";this.history=[];this.editedValue="";this.historyStep=0;this.selectionMode=null;this.ctrlKeyPressed=!1;this.parseEmails=function(t){var r,i;return t?(r=[],typeof t=="string"&&(r=ASC.Mail.Utility.ParseAddresses(t).addresses),Array.isArray(t)&&(r=t),i=[],n.each(r,function(n,t){typeof t=="object"&&i.push(t);typeof t=="string"&&(i=i.concat(ASC.Mail.Utility.ParseAddresses(t).addresses))}),i):[]};this.addItem=function(n,t){var i=r.parseEmails(n),u;i.length&&(u=r.drawItems(i,r.input),r.input.val("").css("width",""),r.input.insertBefore(r.buffer),r.closeSelector(),u&&(r.updateHistoryStep(!0,!0),r.settings.onChangeCallback&&t&&r.settings.onChangeCallback()),r.input.trigger("focus"))};this.drawItems=function(t,i){if(!t.length)return!1;var u=n.map(r.getItems(),function(n){return n.email}),f=!1;return n.each(t,function(t,e){if(e&&n.inArray(e.email,u)<0&&(n.tmpl("template-emailselector-item",e).data("item-data",e).insertBefore(i),u.push(e.email),f=!0,r.settings.maxCount)){if(u.length>=r.settings.maxCount){r.obj.find(".emailselector-input").prop("disabled",!0);return}r.obj.find(".emailselector-input").prop("disabled",!1)}}),f};this.getItems=function(t){return n.map(r.obj.find(".emailselector-item"+(t?".selected":"")),function(t){var i=n(t).data("item-data");return new ASC.Mail.Address(i.name,i.email,i.isValid)})};this.getString=function(t){var i=n.map(r.getItems(t),function(n){return n.ToString()});return i.join(", ")};this.closeSelector=function(){var n=r.input.data("ui-autocomplete");n&&n.close()};this.clearItems=function(){r.obj.find(".emailselector-item").remove();r.obj.find(".emailselector-input").prop("disabled",!1)};this.updateHistoryStep=function(t,i){var u=r.getItems();t?i?(r.historyStep++,r.history=n.grep(r.history,function(n){return n.step<r.historyStep}),r.history.push({data:u,step:r.historyStep})):r.historyStep<r.history.length&&r.historyStep++:r.historyStep>0&&r.historyStep--;r.settings.maxCount&&(u.length>=r.settings.maxCount?r.obj.find(".emailselector-input").prop("disabled",!0):r.obj.find(".emailselector-input").prop("disabled",!1))};this.showHistoryStep=function(){var t=n.grep(r.history,function(n){return n.step===r.historyStep});r.clearItems();t.length&&r.drawItems(t[0].data,r.input)};this.setBindings=function(){var t={A:65,C:67,X:88,V:86,Z:90,Y:89,enter:13,backspace:8,del:46,left:37,right:39,ctrl:17};r.obj.on("click",function(){r.input.trigger("focus")});r.obj.on("scroll",function(){r.hiddenInput.css("top",r.obj.scrollTop()+"px")});r.obj.on("click",".emailselector-item-close",function(t){n(t.target).parent().remove();r.updateHistoryStep(!0,!0);r.settings.onChangeCallback&&r.settings.onChangeCallback();r.input.trigger("focus");t.stopPropagation()});r.obj.on("click",".emailselector-item",function(t){var i=n(t.target);i.is(".emailselector-item-text")&&(i=i.parent());t.ctrlKey?(i.toggleClass("selected"),r.ctrlKeyPressed=!0):t.shiftKey?i.toggleClass("selected"):(r.obj.find(".emailselector-item").removeClass("selected"),i.addClass("selected"));r.hiddenInput.val(r.getString(!0)).trigger("focus").trigger("select");t.stopPropagation()});r.obj.on("mousedown",".emailselector-item",function(n){n.preventDefault?n.preventDefault():n.returnValue=!1});r.obj.on("dblclick",".emailselector-item",function(){var t=n(this),i;r.editedValue=t.data("item-data").ToString();i=r.buffer.text(r.editedValue).width();t.replaceWith(r.input);r.input.val(r.editedValue).width(i).trigger("focus")});r.obj.on("input","input[type=text]",function(){var t=n(this);r.buffer.text(t.val());t.width(r.buffer.width()+5||1)});r.obj.on("keydown",".emailselector-hidden-input",function(n){var f,i,e,u;switch(n.keyCode){case t.enter:r.obj.find(".emailselector-item.selected").length===1?r.obj.find(".emailselector-item.selected").trigger("dblclick"):r.input.trigger("focus");break;case t.A:n.ctrlKey&&(r.obj.find(".emailselector-item").addClass("selected"),r.hiddenInput.val(r.getString(!0)).trigger("select"));break;case t.Z:n.ctrlKey&&(r.updateHistoryStep(!1,!1),r.showHistoryStep(),r.settings.onChangeCallback&&r.settings.onChangeCallback());break;case t.Y:n.ctrlKey&&(r.updateHistoryStep(!0,!1),r.showHistoryStep(),r.settings.onChangeCallback&&r.settings.onChangeCallback());break;case t.backspace:case t.del:r.obj.find(".emailselector-item.selected").remove();r.hiddenInput.val(r.getString(!0));r.updateHistoryStep(!0,!0);r.settings.onChangeCallback&&r.settings.onChangeCallback();r.input.trigger("focus");break;case t.left:f=r.obj.find(".emailselector-item.selected:"+(r.selectionMode==="right"?"last":"first"));f.length&&(i=f.prev(),i.length&&i.hasClass("emailselector-item")&&(n.shiftKey?(r.selectionMode||(r.selectionMode="left"),i.hasClass("selected")?(f.removeClass("selected"),r.obj.find(".emailselector-item.selected").length===1&&(r.selectionMode=null)):i.addClass("selected")):(r.obj.find(".emailselector-item").removeClass("selected"),i.addClass("selected"),r.selectionMode=null),r.hiddenInput.val(r.getString(!0)).trigger("select")));break;case t.right:e=r.obj.find(".emailselector-item.selected:"+(r.selectionMode==="left"?"first":"last"));e.length&&(u=e.next(),u.length&&u.hasClass("emailselector-item")?(n.shiftKey?(r.selectionMode||(r.selectionMode="right"),u.hasClass("selected")?(e.removeClass("selected"),r.obj.find(".emailselector-item.selected").length===1&&(r.selectionMode=null)):u.addClass("selected")):(r.obj.find(".emailselector-item").removeClass("selected"),u.addClass("selected"),r.selectionMode=null),r.hiddenInput.val(r.getString(!0)).trigger("select")):(r.obj.find(".emailselector-item").removeClass("selected"),r.input.trigger("focus")))}return n.ctrlKey&&(n.keyCode===t.X||n.keyCode===t.C)});r.obj.on("cut",".emailselector-hidden-input",function(){r.obj.find(".emailselector-item.selected").remove();r.updateHistoryStep(!0,!0);r.settings.onChangeCallback&&r.settings.onChangeCallback();setTimeout(function(){r.input.trigger("focus")},0)});r.obj.on("keydown",".emailselector-input",function(i){var f=n(this),u=f.val();if(i.keyCode===t.enter&&(r.addItem(u.trim(),!0),r.input.trigger("focus")),!u){if(i.ctrlKey&&i.keyCode===t.A&&(r.hiddenInput.trigger("focus"),r.obj.find(".emailselector-item").addClass("selected"),r.hiddenInput.val(r.getString(!0)).trigger("select")),i.ctrlKey&&i.keyCode===t.Z)return r.updateHistoryStep(!1,!1),r.showHistoryStep(),r.settings.onChangeCallback&&r.settings.onChangeCallback(),!1;if(i.ctrlKey&&i.keyCode===t.Y)return r.updateHistoryStep(!0,!1),r.showHistoryStep(),r.settings.onChangeCallback&&r.settings.onChangeCallback(),!1;i.keyCode===t.backspace&&(r.obj.find(".emailselector-item:last").remove(),r.updateHistoryStep(!0,!0),r.settings.onChangeCallback&&r.settings.onChangeCallback(),r.input.trigger("focus"));i.keyCode===t.left&&(r.hiddenInput.trigger("focus"),r.obj.find(".emailselector-item:last").addClass("selected"),r.hiddenInput.val(r.getString(!0)).trigger("select"))}});r.obj.on("keyup",".emailselector-hidden-input",function(n){n.keyCode===t.ctrl&&(r.ctrlKeyPressed=!1)});r.obj.on("blur",".emailselector-hidden-input",function(){n(this).val("");r.ctrlKeyPressed||r.obj.find(".emailselector-item").removeClass("selected")});r.obj.on("blur",".emailselector-input",function(){var t=n(this),i=t.val().trim();r.addItem(i,!0);r.selectionMode=null})};this.initAutocomplete=function(){r.input.autocomplete({minLength:2,delay:300,select:function(n,t){return t.item.name&&(t.item.name=Encoder.htmlDecode(t.item.name)),r.addItem([t.item],!0),!1},search:function(){return r.obj.is(":visible")},source:function(n,t){var i,u,f;if(r.settings.isInPopup&&(i=this.menu.element,u=r.obj.parents(".blockUI.blockPage:first"),u.length!==0&&(u.css("position")==="fixed"?i.css("position","fixed"):i.css("position","absolute"))),n.term in r.cache)return f=r.cache[n.term],t(f);if(!n.term)return r.firstFailTerm="",t([]);if(r.firstFailTerm){if(n.term.indexOf(r.firstFailTerm)===0)return t([]);r.firstFailTerm=""}Teamlab.searchEmails({},{term:n.term},{success:function(i,u){if(!u||u.length===0)return r.firstFailTerm=n.term,t([]);var f=r.parseEmails(u);return r.cache[n.term]=f,t(f)},error:function(n,t){console.log(t)}})},focus:function(){return!1},create:function(){n(window).on("resize",function(){r.closeSelector()})},open:function(){var t=n.Event("keydown",{keyCode:40});return n(r.input).trigger(t),n(this).autocomplete("widget").css("z-index",100),!1}});r.input.data("ui-autocomplete")._renderMenu=function(t,i){var f=this,u;n.each(i,function(n,i){f._renderItemData(t,i)});r.settings.isInPopup&&n.browser.mobile&&t.parents(".blockUI.blockPage:first").length===0&&(u=r.obj.parents(".blockUI.blockPage:first"),u.length!==0&&t.appendTo(u.children()))};r.input.data("ui-autocomplete")._renderItem=function(t,i){return n.tmpl("template-emailselector-autocomplete",i).appendTo(t)};r.input.data("ui-autocomplete")._resizeMenu=function(){this.menu.element.outerWidth(r.obj.width())};r.input.data("ui-autocomplete")._suggest=function(t){var i=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(i,t);this.menu.refresh();i.show();this._resizeMenu();i.position(n.extend({"of":n(this.element).parent()},this.options.position))}};this.init=function(){r.setBindings();r.initAutocomplete();r.clearItems();r.addItem(r.settings.items,!1)}}var t=[],r={init:function(i){var e=n(this),r;return u(e),r=new f(e,i),t.push(r),r.init(),this},get:function(){var r=n(this),t=i(r);return t?t.getItems():null},getString:function(){var r=n(this),t=i(r);return t?t.getString():null},addItem:function(t){var u=n(this),r=i(u);return r?r.addItem(t,!0):null},clear:function(){var r=n(this),t=i(r);return t&&(t.clearItems(),t.history=[],t.historyStep=0),this}};n.fn.AdvancedEmailSelector=function(n){return this.length&&r[n]?r[n].apply(this,Array.prototype.slice.call(arguments,1)):this}})(jQuery);
(function(n,t,i,r){function a(n){for(var t=0,i=n.offsetTop;n=n.offsetParent;)t=n.offsetTop,t?i+=t:null;return i}function f(n){var t,i;i=n.css("overflow-y","auto").height("auto").height();t=s.height()-a(n[0])-1;n.height(t+"px");i>t&&n.css("overflow-y","scroll")}function c(){for(var t=o,n=0,n=t.length;n--;)f(t[n])}function v(n){l.addClass(e);n.addClass(e).css("overflow-x","visible");f(n);o.push(n)}var u=!0,e="tl-block",o=[],s=n(window),l=n(r),h=!1;u=n.browser.msie&&n.browser.version<8?!1:u;n.fn.tlBlock=function(t){if(t&&typeof t=="string"){switch(t){case"resize":return this.each(function(){u&&f(n(this))})}return this}if(t=n.extend({title:"",classname:""},t),!h){h=!0;s.off("resize",c).on("resize",c)}return this.each(function(){var i=n(this);u&&v(i,t)})}})(jQuery,window,document,document.body);
PopupBoxManager=new function(){this.Collection=[];this.TimerCollection=[];this.RegistryPopupBox=function(n){this.Collection[n.ID]=n};this.GetPopupBoxByID=function(n){return this.Collection[n]};this.AjaxCallback=function(){}};var PopupBoxContainerElementID="container";PopupBox=function(n,t,i,r,u,f,e){if(this.Height=i,this.Width=t,this.BorderCSSClass=u,this.BackgroundCSSClass=r,this.ID=n,this.ContentID="_"+n,this.IsVisible=!1,this.TimerHandler=null,this.CurrentElementID="",this.PreviousElementID="",this.VisibleWidth=-1,this.VisibleHeight=-1,this.ServerMethodFullName=f,typeof e=="object"&&(e.hasOwnProperty("apiMethodName")&&(this.ApiMethodName=e.apiMethodName),e.hasOwnProperty("tmplName")&&(this.TmplName=e.tmplName),e.hasOwnProperty("tmplParams")&&(this.tmplParams=e.tmplParams),e.hasOwnProperty("customFactory")&&(this.CustomFactory=e.customFactory)),this.BeginBox='<div class="'+this.BorderCSSClass+" "+this.BackgroundCSSClass+'" style="z-index:9999999; position:absolute; display:none; width:'+this.Width+'px;" id='+this.ID+">",this.EndBox="<\/div>",this.Content="<div id="+this.ContentID+"><\/div>",this.Init=function(){jq("#"+PopupBoxContainerElementID).append(this.BeginBox+this.Content+this.EndBox)},PopupBoxManager.RegistryPopupBox(this),jq("#"+PopupBoxContainerElementID).length>0)this.Init();else{var o=this.ID;jq(document).ready(function(){PopupBoxManager.GetPopupBoxByID(o).Init()})}this.SetContent=function(n){jq("#"+this.ContentID).html(n);jq("#"+this.ID).css({width:this.Width+"px"})};this.CheckVisible=function(){var n=this;n.IsVisible==!1?(clearInterval(n.checkVisibleHandler),n.checkVisibleHandler=null,jq("#"+n.ID).is(":visible")&&jq("#"+n.ID).fadeOut("slow")):n.checkVisibleHandler=setTimeout(function(){n.CheckVisible()},313)};this.RegistryElement=function(n,t){var i=this.ID;jq("#"+n).on("mouseover",function(){PopupBoxManager.GetPopupBoxByID(i).ExecAndShow(n,t)}).on("mouseout",function(){PopupBoxManager.GetPopupBoxByID(i).StopTimer()}).on("click",function(){PopupBoxManager.GetPopupBoxByID(i).StopTimer()});jq(document).on("keypress",function(n){n.hasOwnProperty("ctrlKey")&&n.ctrlKey===!0&&(n.which===99||n.which===97)||PopupBoxManager.GetPopupBoxByID(i).StopTimer()})};this.RegistryElementOnLive=function(n,t){var i=this.ID;jq(document).on("mouseover","#"+n,function(){PopupBoxManager.GetPopupBoxByID(i).ExecAndShow(n,t)}).on("mouseout","#"+n,function(){PopupBoxManager.GetPopupBoxByID(i).StopTimer()}).on("click","#"+n,function(){PopupBoxManager.GetPopupBoxByID(i).StopTimer()});jq(document).on("keypress",function(n){n.hasOwnProperty("ctrlKey")&&n.ctrlKey===!0&&(n.which===99||n.which===97)||PopupBoxManager.GetPopupBoxByID(i).StopTimer()})};this.ExecAndShow=function(n,t){if(this.CurrentElementID=n,this.CurrentElementID==this.PreviousElementID&&!1){setTimeout("PopupBoxManager.GetPopupBoxByID('"+this.ID+"').Show('"+n+"')",850);return}this.TimerHandler&&clearInterval(this.TimerHandler);this.PreviousElementID=this.CurrentElementID;this.TimerHandler=typeof this.ApiMethodName!="undefined"&&this.ApiMethodName!=""?setTimeout("PopupBoxManager.GetPopupBoxByID('"+this.ID+"').ExecApiCode('"+n+"','"+t+"')",850):setTimeout("PopupBoxManager.GetPopupBoxByID('"+this.ID+"').ExecAjaxCode('"+n+"','"+t+"')",850)};this.ExecApiCode=function(n,t){var i=this.ID;eval(this.ApiMethodName+'({popupBoxID: "'+this.ID+'"},'+t+",{success:"+this.ApiCallback+",error:"+function(){PopupBoxManager.GetPopupBoxByID(i).StopTimer()}+",before:"+function(){PopupBoxManager.GetPopupBoxByID(i).SetContent('<img class="popupbox-loader" src="'+StudioManager.GetImage("loader_32.gif")+'" alt="">');PopupBoxManager.GetPopupBoxByID(i).Show(n)}+"})")};this.ExecAjaxCode=function(n,t){var i=this.ID;AjaxPro.onLoading=function(t){t&&(PopupBoxManager.GetPopupBoxByID(i).SetContent('<img class="popupbox-loader" src="'+StudioManager.GetImage("loader_32.gif")+'" alt="">'),PopupBoxManager.GetPopupBoxByID(i).Show(n))};eval(this.ServerMethodFullName+"("+t+',"'+this.ID+'",this.AjaxCallback);')};this.AjaxCallback=function(n){AjaxPro.onLoading=function(){};var t=PopupBoxManager.GetPopupBoxByID(n.value.rs1);t.SetContent(n.value.rs2);t.SetPopupPosition(t.CurrentElementID)};this.ApiCallback=function(n,t){var i=PopupBoxManager.GetPopupBoxByID(n.popupBoxID),r,u;if(typeof i.CustomFactory=="function"&&i.CustomFactory.apply(this,[t]),t.isPrivateForMe=t.isPrivate&&!ASC.CRM.Data.IsCRMAdmin,t.isPrivate&&t.accessList)for(r=0;r<t.accessList.length;r++)t.accessList[r].id==Teamlab.profile.id&&(t.isPrivateForMe=!1);i.tmplParams&&(t=jq.extend(t,i.tmplParams));u=jq.tmpl(i.TmplName,t);i.SetContent(u);i.SetPopupPosition(i.CurrentElementID)};this.SetPopupPosition=function(n){if(jq("#"+n).length!=0){var r=jq("#"+this.ID).height(),i=jq(window),o=i.scrollTop(),s=i.scrollLeft(),h=i.width(),c=i.height(),l=this.ID,t=jq("#"+n).offset(),u=jq("#"+n).height(),f="",e="";f=t.left+this.Width>s+h?t.left-this.Width+"px":t.left+"px";e=t.top+r+u>o+c?t.top-5-r+"px":t.top+3+u+"px";jq("#"+l).css({left:f,top:e})}};this.Show=function(n){this.SetPopupPosition(n);var i=this.ID,t=jq("#"+i);if(this.VisibleWidth=-1,this.VisibleHeight=-1,t.is(":visible")==!1){this.IsVisible=!0;t.fadeIn("slow");t.on("mouseout",function(){PopupBoxManager.GetPopupBoxByID(i).SetVisible(!1)});t.on("mouseover",function(){PopupBoxManager.GetPopupBoxByID(i).SetVisible(!0)})}this.CheckVisible()};this.SetVisible=function(n){jq("#"+this.ID).is(":visible")&&(this.IsVisible=n)};this.StopTimer=function(){try{this.IsVisible=!1;clearInterval(this.TimerHandler);this.TimerHandler=null}catch(n){}}};
function UserSelector(n){function p(n){w(n);b(n);k()}function w(n){t.userCache=n.userCache;t.groupCache=n.groupCache;t.selected=n.selected;t.accessRights=n.accessRights;t.defaultAccessRight=n.defaultAccessRight;t.onSave=n.onSave;t.onCancel=n.onCancel;t.singleChoice=n.singleChoice;t.groupSelection=n.groupSelection;t.tmpSelected=Object.assign({},t.selected);t.searchText="";t.searchResult=null;t.pagging={renderBy:100,searchItemsNumber:0,groupsItemsNumber:0,usersItemsNumber:0}}function b(n){t.userDomGenerator=n.userDomGenerator;t.dialogElement=t.userDomGenerator.createUserSelectorDialog(t.singleChoice,t.accessRights,t.defaultAccessRight);t.searchContainerElement=t.dialogElement.querySelector(".us-search");t.contentListParentElement=t.dialogElement.querySelector(".us-list-parent");t.accessRightsLinkElement=t.dialogElement.querySelector(".access-rights-container .access-rights-link");t.accessRightsDialogElement=t.dialogElement.querySelector(".access-rights-container .access-rights-dialog");t.saveBtnElement=t.dialogElement.querySelector(".small-button-container .button.blue");t.cancelBtnElement=t.dialogElement.querySelector(".small-button-container .button.gray");t.countElement=t.dialogElement.querySelector(".small-button-container .gray-text");t.openedGroupElement=null}function k(){(t.userSearcher=new UserSearcher(t.groupCache,t.userCache,t.searchContainerElement,d),t.contentListParentElement.addEventListener("click",g),t.singleChoice)||(t.accessRightsDialogHelper=new DialogHelper(t.accessRightsLinkElement,t.accessRightsDialogElement,nt),t.accessRightsDialogElement.addEventListener("click",tt),t.saveBtnElement.addEventListener("click",o),t.cancelBtnElement.addEventListener("click",it))}function d(n,i){t.searchText!=n&&(t.searchText=n,t.searchResult=i,n?rt():f(s()))}function g(n){if(n.target.classList.contains("us-show-more")){st(n.target.closest(".us-show-more-row"),n);return}var t=n.target.closest(".us-name");if(!t||t.classList.contains("disabled")){t&&t.id==r.Id&&f(t);return}t.classList.contains("us-groupname")?ft(t,n):t.classList.contains("us-checkbox")?et(t,n):ot(t,n);y()}function nt(){return t.accessRightsDialogElement.style.bottom=t.accessRightsLinkElement.offsetHeight+4+"px",t.accessRightsDialogElement.style.left=t.accessRightsLinkElement.offsetLeft+"px",!0}function tt(n){var i=n.target.closest(".dropdown-item");i&&(t.defaultAccessRight=+i.getAttribute("data-access"),t.accessRightsLinkElement.firstElementChild.textContent=i.textContent,t.accessRightsDialogHelper.hide())}function o(){if(t.singleChoice||!this.classList.contains("disable")){t.onSave(t.tmpSelected,t.defaultAccessRight);t.onCancel()}}function it(){t.onCancel()}function s(){var n=l(0,Math.max(t.pagging.groupsItemsNumber,t.pagging.renderBy)-1),u;if(t.openedGroupElement=null,t.pagging.groupsItemsNumber=n.count,!t.singleChoice){var f=t.tmpSelected[e.Id],o=f!==undefined,s=o&&!f.canRemove,h=t.userDomGenerator.createGroup({id:e.Id,name:e.Name,isGroup:!0,disabled:s,selected:o,canSelect:t.groupSelection,canOpen:!1});n.fragment.prepend(h);var i=t.tmpSelected[r.Id],c=i!==undefined,a=i&&!i.canRemove,v=t.userDomGenerator.createGroup({id:r.Id,name:r.Name,isGroup:!0,disabled:a,selected:c,canSelect:t.groupSelection});n.fragment.prepend(v)}return u=t.userDomGenerator.createContentList(),u.append(n.fragment),t.contentListParentElement.firstElementChild.replaceWith(u),t.contentListParentElement.firstElementChild.querySelector(".us-name")}function l(n,r){var u={fragment:document.createDocumentFragment(),count:-1};for(var f in t.groupCache)if(u.count++,!(u.count<n)){if(u.count>r)break;var s=t.groupCache[f],e=t.tmpSelected[f],o=e!==undefined,h=o&&!e.canRemove,c=t.userDomGenerator.createGroup({id:f,name:s.name,isGroup:!0,disabled:h,selected:o,canSelect:t.groupSelection});u.fragment.append(c)}return u.count>r?(u.fragment.append(t.userDomGenerator.createShowMoreRow({name:i.UserSelectorShowMore})),u):(u.fragment.append(t.userDomGenerator.createGroup({id:"withouthGroup",name:i.UserSelectorUsersWithouthGroup,isGroup:!0,canSelect:!1})),u.count++,u)}function h(n,u,f){var o,h,c,y,l,e,s;if(f||(t.pagging.usersItemsNumber=0),o=t.userDomGenerator.createGroupItems(),u==r.Id){if(f)return;h=!0;c=!0;for(l in t.groupCache)if(h=!1,t.tmpSelected[l]===undefined){c=!1;break}h&&(c=!1);y=!0;for(l in t.userCache)if(t.tmpSelected[l]===undefined){y=!1;break}o.append(t.userDomGenerator.createGroupItem({id:"allGroups",group:u,name:i.UserSelectorCheckAllGroups,isCheckbox:!0,checked:c,disabled:h}));o.append(t.userDomGenerator.createGroupItem({id:"allUsers",group:u,name:i.UserSelectorCheckAllUsers,isCheckbox:!0,checked:y}))}else if(u=="withouthGroup"){if(e=a(u,0,Math.max(t.pagging.usersItemsNumber,t.pagging.renderBy)-1),t.pagging.usersItemsNumber=e.count,s=t.userDomGenerator.createGroupItemsBlock(),s.append(e.fragment),f){n.lastElementChild.replaceWith(s);return}e.count>0&&(t.singleChoice||o.append(t.userDomGenerator.createGroupItem({id:"allUsersWithouthGroup",group:u,name:i.UserSelectorCheckCurrentUsers,isCheckbox:!0,checked:e.allSelected})),o.append(s))}else{if(e=v(u,0,Math.max(t.pagging.usersItemsNumber,t.pagging.renderBy)-1),t.pagging.usersItemsNumber=e.count,s=t.userDomGenerator.createGroupItemsBlock(),s.append(e.fragment),f){n.lastElementChild.replaceWith(s);return}e.count>0&&(t.singleChoice||o.append(t.userDomGenerator.createGroupItem({id:"allUsersInGroup"+u,group:u,name:i.UserSelectorCheckCurrentUsers,isCheckbox:!0,checked:e.allSelected})),o.append(s))}n.replaceWith(o)}function a(n,r,u){var f={fragment:document.createDocumentFragment(),count:-1,totalCount:-1,allSelected:!0},e,o;for(e in t.userCache)if(o=t.userCache[e],!(o.groups.length>0)){f.totalCount++;var h=t.tmpSelected[e],s=h!==undefined,c=s&&!h.canRemove;if(f.allSelected=f.allSelected&&s,f.totalCount<r){f.count++;continue}f.totalCount>u||(f.count++,f.fragment.append(t.userDomGenerator.createGroupItem({id:e,group:n,name:o.displayName,avatar:o.avatarSmall,disabled:c,selected:s})))}return f.totalCount>u&&f.fragment.append(t.userDomGenerator.createShowMoreRow({name:i.UserSelectorShowMore,group:n})),f.count++,f.totalCount++,f}function v(n,r,u){var a=t.groupCache[n].users,h=t.tmpSelected[n]!==undefined,f={fragment:document.createDocumentFragment(),count:-1,totalCount:-1,allSelected:!h},e,o;for(e of a)if(o=t.userCache[e],o){f.totalCount++;var s=t.tmpSelected[e],c=h||s&&!s.canRemove,l=c||s!==undefined;if(f.allSelected=f.allSelected&&l,f.totalCount<r){f.count++;continue}f.totalCount>u||(f.count++,f.fragment.append(t.userDomGenerator.createGroupItem({id:e,group:n,name:o.displayName,avatar:o.avatarSmall,disabled:c,selected:l})))}return f.totalCount>u&&f.fragment.append(t.userDomGenerator.createShowMoreRow({name:i.UserSelectorShowMore,group:n})),f.count++,f.totalCount++,f}function rt(){var n=c(0,t.pagging.renderBy-1);t.pagging.searchItemsNumber=n.count;var i=t.userDomGenerator.createContentList(),r=t.userDomGenerator.createGroupItemsBlock(),u=t.userDomGenerator.createGroupItemsBlock();r.append(n.groupsFragment);u.append(n.usersFragment);i.append(r);i.append(u);t.contentListParentElement.firstElementChild.replaceWith(i);t.openedGroupElement=null}function ut(){var i=c(0,t.pagging.searchItemsNumber-1),n=t.userDomGenerator.createGroupItemsBlock();n.append(i.usersFragment);t.contentListParentElement.firstElementChild.lastElementChild.replaceWith(n)}function c(n,r){var u={groupsFragment:document.createDocumentFragment(),usersFragment:document.createDocumentFragment(),count:-1},h,f,e,l,c,o,s,a;for(h in t.searchResult.groups)if(u.count++,!(u.count<n)){if(u.count>r)break;f=t.searchResult.groups[h];e=t.tmpSelected[h];f.selected=e!==undefined;f.disabled=e&&!e.canRemove;f.canSelect=t.groupSelection;l=t.userDomGenerator.createGroup(f);u.groupsFragment.append(l)}if(u.count>r)return u.groupsFragment.append(t.userDomGenerator.createShowMoreRow({name:i.UserSelectorShowMore})),u;for(c in t.searchResult.users)if(u.count++,!(u.count<n)){if(u.count>r)break;o=t.searchResult.users[c];s=t.tmpSelected[c];o.selected=s!==undefined;o.disabled=s&&!s.canRemove;a=t.userDomGenerator.createGroupItem(o);u.usersFragment.append(a)}return u.count>r?(u.usersFragment.append(t.userDomGenerator.createShowMoreRow({name:i.UserSelectorShowMore})),u):(u.count++,u.count==0&&u.usersFragment.append(t.userDomGenerator.createEmptySearchRow()),u)}function y(){if(!t.singleChoice){var n=Object.keys(t.tmpSelected).length;t.countElement.textContent=i.UserSelectorSelectedCount.format(n);t.saveBtnElement.classList.toggle("disable",n==0)}}function f(n,i){if(!n){t.openedGroupElement=null;return}if(!n.classList.contains("unopenable")){if(n==t.openedGroupElement&&!i){n.parentElement.classList.toggle("opened");return}t.openedGroupElement&&n!=t.openedGroupElement&&t.openedGroupElement.parentElement.classList.remove("opened");h(n.nextElementSibling,n.id,!1);n.parentElement.classList.add("opened");t.openedGroupElement=n}}function u(n,i,u){var f=t.tmpSelected[n],s,o;if(u){if(f!==undefined)return;i?n==r.Id?t.tmpSelected[n]={id:n,name:r.Name,isGroup:!0,canOpen:!1,canRemove:!0}:n==e.Id?t.tmpSelected[n]={id:n,name:e.Name,isGroup:!0,canOpen:!1,canRemove:!0}:(s=t.groupCache[n],t.tmpSelected[n]={id:n,name:s.name,isGroup:!0,canRemove:!0}):(o=t.userCache[n],t.tmpSelected[n]={id:n,name:o.displayName,avatar:o.avatarSmall,canRemove:!0})}else{if(f===undefined)return;if(f.canRemove===!1)return;delete t.tmpSelected[n]}}function ft(n,i){var r,e;if((i.target.classList.contains("us-avatar")||n.classList.contains("unopenable"))&&!n.classList.contains("unselectable")){if(r=n.classList.toggle("selected"),u(n.id,!0,r),t.singleChoice){o();return}n==t.openedGroupElement&&(e=n.parentElement.classList.contains("opened"),f(n,!0),n.parentElement.classList.toggle("opened",e))}else f(n)}function et(n,i){var l=n.querySelector("input[type=checkbox]"),c,e,v,a,y,o;if(i.target!=l&&(l.checked=!l.checked),c=l.checked,e=n.getAttribute("data-group"),e==r.Id){if(n.id=="allGroups"){for(e in t.groupCache)u(e,!0,c);f(s())}else if(n.id=="allUsers")for(o in t.userCache)u(o,!1,c)}else if(e=="withouthGroup"){for(o in t.userCache)(v=t.userCache[o],v.groups.length>0)||u(o,!1,c);h(n.parentElement,e,!0)}else{t.tmpSelected[e]!==undefined&&(u(e,!0,!1),n.parentElement.previousElementSibling.classList.remove("selected"));a=!1;y=t.groupCache[e].users;for(o of y)t.userCache[o]&&(u(o,!1,c),t.searchText&&t.searchResult.users[o]&&(a=!0));h(n.parentElement,e,!0);a&&ut()}}function ot(n){var s=n.classList.toggle("selected"),r,h,i,c,f,l,e;if(u(n.id,!1,s),t.singleChoice){o();return}if(r=n.getAttribute("data-group"),t.searchText&&(r?t.searchResult.users[n.id]!==undefined&&(i=t.contentListParentElement.firstElementChild.lastElementChild.children[n.id],i&&i.classList.contains("us-name")&&i.classList.toggle("selected",s)):t.openedGroupElement&&t.tmpSelected[t.openedGroupElement.id]===undefined&&(h=t.groupCache[t.openedGroupElement.id].users.indexOf(n.id),h!=-1&&(i=t.openedGroupElement.nextElementSibling.lastElementChild.children[n.id],i&&i.classList.contains("us-name")&&i.classList.toggle("selected",s),r=t.openedGroupElement.id))),r=="withouthGroup"){f=!0;for(e in t.userCache)if((c=t.userCache[e],!(c.groups.length>0))&&t.tmpSelected[e]===undefined){f=!1;break}n.parentElement.previousElementSibling.querySelector("input").checked=f}else if(r){f=!0;l=t.groupCache[r].users;for(e of l)if(t.userCache[e]&&t.tmpSelected[e]===undefined){f=!1;break}n.parentElement.previousElementSibling.querySelector("input").checked=f}}function st(n){var r=n.getAttribute("data-group"),i;r==null?t.searchText?(i=c(t.pagging.searchItemsNumber,t.pagging.searchItemsNumber+t.pagging.renderBy-1),t.pagging.searchItemsNumber=i.count,t.contentListParentElement.firstElementChild.firstElementChild.append(i.groupsFragment),t.contentListParentElement.firstElementChild.lastElementChild.append(i.usersFragment)):(i=l(t.pagging.groupsItemsNumber,t.pagging.groupsItemsNumber+t.pagging.renderBy-1),t.pagging.groupsItemsNumber=i.count,t.contentListParentElement.firstElementChild.append(i.fragment)):(i=r=="withouthGroup"?a(r,t.pagging.usersItemsNumber,t.pagging.usersItemsNumber+t.pagging.renderBy-1):v(r,t.pagging.usersItemsNumber,t.pagging.usersItemsNumber+t.pagging.renderBy-1),t.pagging.usersItemsNumber=i.count,n.parentElement.append(i.fragment));n.remove()}var i=ASC.Resources.Master.ResourceJS,r=ASC.Resources.Master.GroupSelector_WithGroupEveryone,e=ASC.Resources.Master.GroupSelector_WithGroupAdmin,t=this;p(n);t.changeData=function(n,i,r){t.selected=n;!t.singleChoice&&i&&(t.accessRights=i,t.defaultAccessRight=r,t.accessRightsDialogElement.firstElementChild.replaceWith(t.userDomGenerator.createAccessRightsDialogContent(i)),t.accessRightsLinkElement.firstElementChild.replaceWith(t.userDomGenerator.createAccessRightsLinkText(i,r)))};t.resetTempData=function(){t.tmpSelected=Object.assign({},t.selected);t.searchText="";t.searchResult=null;t.userSearcher.clear();t.pagging.searchItemsNumber=0;t.pagging.groupsItemsNumber=0;t.pagging.usersItemsNumber=0};t.render=function(){f(s());y()}}function UserSearcher(n,t,i,r){var u=this,f=i.querySelector(".textEdit"),o=i.querySelector(".clear-search"),e=null;u.debounceSearch=function(){clearTimeout(e);e=setTimeout(u.search,500)};u.search=function(){var n=f.value,t;n?(t=u.findItems(n),i.classList.add("active"),r(n,t)):(u.clear(),r("",null))};u.findItems=function(i){var u,f,o,e,r;i=i.toLowerCase();u={groups:{},users:{}};for(f in n)(o=n[f],o.name.toLowerCase().indexOf(i)!==-1)&&(u.groups[f]={id:f,name:o.name,isGroup:!0});for(e in t)(r=t[e],r.displayName.toLowerCase().indexOf(i)!==-1||r.email.toLowerCase().indexOf(i)!==-1)&&(u.users[e]={id:e,name:r.displayName,avatar:r.avatarSmall});return u};u.clear=function(){i.classList.remove("active");f.value=""};f.addEventListener("keyup",function(n){var t=this.value;if(n.key==="Escape"&&t){n.stopPropagation();u.clear();r("",null);return}n.key==="Enter"&&(clearTimeout(e),u.search())});f.addEventListener("input",u.debounceSearch);o.addEventListener("click",function(){u.clear();r("",null)})}function UserDomGenerator(){var n=ASC.Resources.Master.ResourceJS;this.createCbx=function(n){var t=document.createElement("input");return t.setAttribute("type","checkbox"),t.checked=n.checked,t.disabled=n.disabled,t};this.createAvatar=function(n){var t=document.createElement("span");return t.setAttribute("class","us-avatar"),n.avatar&&!n.avatar.endsWith("default_user_photo_size_32-32.png")&&t.setAttribute("style","background-image: url("+n.avatar+")"),t};this.createAccess=function(n){var t=document.createElement("span");return t.setAttribute("class","us-access"+(n.canEdit===!1?" uneditable":"")+(n.isOwner?" owner":" access-"+n.access)),t.setAttribute("title",n.accessName||""),t};this.createName=function(n){var i=document.createElement("div"),t,r,u;return i.setAttribute("id",n.id),i.setAttribute("class","us-name"+(n.isGroup?" us-groupname":"")+(n.isLink?" us-linkname":"")+(n.isCheckbox?" us-checkbox":"")+(n.selected?" selected":"")+(n.disabled?" disabled":"")+(n.shortened?" shortened":"")+(n.individual?" individual":"")+(n.canSelect===!1?" unselectable":"")+(n.canOpen===!1?" unopenable":"")+(n.canEdit===!1?" uneditable":"")+(n.canChange===!0?" changeable":"")),n.group&&i.setAttribute("data-group",n.group),t=document.createElement("span"),t.setAttribute("class","us-name-text"),r=document.createElement("span"),u=Encoder.htmlDecode(n.name),n.withoutTitle||r.setAttribute("title",u),r.append(document.createTextNode(u)),t.append(r),n.isLink&&t.append(this.createNameInfoText(n.shortenedText)),n.individual&&t.append(this.createNameInfoText(n.individualText)),i.append(t),i};this.createNameInfoText=function(n){var t=document.createElement("i");return t.setAttribute("class","gray-text"),t.append(document.createTextNode(n)),t};this.createGroupItems=function(){var n=document.createElement("div");return n.setAttribute("class","us-group-items"),n};this.createGroupItemsBlock=function(){var n=document.createElement("div");return n.setAttribute("class","us-group-items-block"),n};this.createGroup=function(n){var f=this.createAvatar(n),i=this.createName(n),r,u,t;return i.prepend(f),n.access!=undefined&&(r=this.createAccess(n),i.append(r)),u=this.createGroupItems(),t=document.createElement("div"),t.setAttribute("class","us-group"),t.append(i),t.append(u),t};this.createGroupItem=function(n){var t=this.createName(n),i,r,u;return n.isCheckbox?(i=this.createCbx(n),t.prepend(i)):(r=this.createAvatar(n),t.prepend(r)),n.access!=undefined&&(u=this.createAccess(n),t.append(u)),t};this.createShowMoreRow=function(n){var t=document.createElement("div"),i;return t.setAttribute("class","us-show-more-row"),n.group&&t.setAttribute("data-group",n.group),i=document.createElement("span"),i.setAttribute("class","link dotline us-show-more"),i.textContent=n.name,t.append(i),t};this.createEmptySearchRow=function(){var n=document.createElement("div");return n.setAttribute("class","us-empty-row gray-text"),n.textContent=ASC.Resources.Master.ResourceJS.UserSelectorNoResults,n};this.createLink=function(n){var r=this.createAvatar(n),t=this.createName(n),i;return t.prepend(r),n.access!=undefined&&(i=this.createAccess(n),t.append(i)),t};this.createAccessRightsDialogContent=function(n){var r=document.createElement("ul"),i,u,t;r.setAttribute("class","dropdown-content");for(i of n)i.disabled||(u=document.createElement("li"),t=document.createElement("a"),t.setAttribute("class","dropdown-item"),t.setAttribute("data-access",i.id),t.append(document.createTextNode(i.name)),u.append(t),r.append(u));return r};this.createAccessRightsImgDialogContent=function(n){var u=document.createDocumentFragment(),t,i,r;for(t of n)t.disabled||(i=document.createElement("div"),i.setAttribute("class","access-rights-item"),i.setAttribute("data-id",t.id),r=document.createElement("div"),r.setAttribute("class","us-access access-"+t.id),r.append(document.createTextNode(t.name)),i.append(r),u.append(i));return u};this.createAccessRightsLinkText=function(n,t){var i=document.createElement("span"),r;i.setAttribute("class","access-rights-linktext");for(r of n)if(r.id==t){i.append(document.createTextNode(r.name));break}return i};this.createAccessRightsContainer=function(t,i){var r=document.createElement("div"),u,f;return r.setAttribute("class","access-rights-container"),r.append(document.createTextNode(n.UserSelectorAddWithAccessRights+":")),u=document.createElement("span"),u.setAttribute("class","access-rights-link"),u.append(this.createAccessRightsLinkText(t,i)),f=document.createElement("div"),f.setAttribute("class","access-rights-dialog studio-action-panel"),f.append(this.createAccessRightsDialogContent(t)),r.append(u),r.append(f),r};this.createContentList=function(){var n=document.createElement("div");return n.setAttribute("class","us-list"),n};this.createUserSelectorDialog=function(t,i,r){var u=document.createElement("div"),e,o,l,y,s,p,f,h,a,c,v;return(u.setAttribute("class","us-dialog us-popup-dialog"),e=document.createElement("div"),e.setAttribute("class","us-search"),o=document.createElement("input"),o.setAttribute("class","textEdit"),o.setAttribute("placeholder",n.UserSelectorSearchPlaceholder),l=document.createElement("span"),l.setAttribute("class","clear-search"),e.append(o),e.append(l),u.append(e),y=this.createContentList(),s=document.createElement("div"),s.setAttribute("class","us-list-parent"),s.append(y),u.append(s),t||!i)?u:(p=this.createAccessRightsContainer(i,r),u.append(p),f=document.createElement("div"),f.setAttribute("class","small-button-container"),h=document.createElement("a"),h.setAttribute("class","button blue"),h.append(document.createTextNode(n.SaveButton)),a=document.createElement("span"),a.setAttribute("class","splitter-buttons"),c=document.createElement("a"),c.setAttribute("class","button gray"),c.append(document.createTextNode(n.CancelButton)),v=document.createElement("span"),v.setAttribute("class","gray-text"),f.append(h),f.append(a),f.append(c),f.append(v),u.append(f),u)};this.clearElement=function(n){while(n.lastChild)n.removeChild(n.lastChild)}}function DialogHelper(n,t,i,r,u,f){var e=this;e.show=function(){if(!i||i()){if(!u&&t.style.display=="block"){e.hide();return}t.style.display="block";setTimeout(function(){document.addEventListener("click",e.autoHide)},0)}};e.hide=function(){(!r||r())&&(t.style.display="none",document.removeEventListener("click",e.autoHide))};e.autoHide=function(n){var i=n.target;if(!f||i.isConnected){while(i!=null){if(i==t)return;i=i.parentNode}e.hide()}};n&&n.addEventListener("click",e.show)};
typeof ASC=="undefined"&&(ASC={});typeof ASC.Files=="undefined"&&(ASC.Files=function(){return{}}());typeof ASC.Files.Utility=="undefined"&&(ASC.Files.Utility={});ASC.Files.Utility.FileExtensionLibrary={ArchiveExts:[".zip",".rar",".ace",".arc",".arj",".bh",".cab",".enc",".gz",".ha",".jar",".lha",".lzh",".pak",".pk3",".tar",".tgz",".uu",".uue",".xxe",".z",".zoo"],AviExts:[".avi"],CalendarExts:[".ical",".ifb",".icalendar"],CsvExts:[".csv"],DjvuExts:[".djvu"],DocExts:[".doc"],DocmExts:[".docm"],DoctExts:[".doct"],DocxExts:[".docx"],DocxfExts:[".docxf"],DotExts:[".dot"],DotmExts:[".dotm"],DotxExts:[".dotx"],DvdExts:[".dvd"],EpubExts:[".epub"],Fb2Exts:[".fb2"],FlvExts:[".flv"],FodpExts:[".fodp"],FodsExts:[".fods"],FodtExts:[".fodt"],GdocExts:[".gdoc"],GsheetExts:[".gsheet"],GslidesExts:[".gslides"],HtmExts:[".htm"],HtmlExts:[".html"],IafExts:[".iaf"],IcsExts:[".ics"],ImgExts:[".bmp",".cod",".gif",".ief",".jpe",".jpeg",".jpg",".jfif",".tiff",".tif",".cmx",".ico",".png",".pnm",".pbm",".ppm",".rgb",".xbm",".xpm",".xwd",".webp"],M2tsExts:[".m2ts"],MhtExts:[".mht"],MkvExts:[".mkv"],MovExts:[".mov"],Mp4Exts:[".mp4"],MpgExts:[".mpg"],OdpExts:[".odp"],OdsExts:[".ods"],OdtExts:[".odt"],OformExts:[".oform"],OtpExts:[".otp"],OtsExts:[".ots"],OttExts:[".ott"],PdfExts:[".pdf"],PotExts:[".pot"],PotmExts:[".potm"],PotxExts:[".potx"],PpsExts:[".pps"],PpsmExts:[".ppsm"],PpsxExts:[".ppsx"],PptExts:[".ppt"],PptmExts:[".pptm"],PpttExts:[".pptt"],PptxExts:[".pptx"],RtfExts:[".rtf"],SoundExts:[".aac",".flac",".m4a",".mp3",".oga",".ogg",".wav"],SoundUnkExts:[".ac3",".aiff",".amr",".ape",".cda",".mid",".mka",".mpc",".pcm",".ra",".raw",".wma"],SvgExts:[".svg"],TxtExts:[".txt"],VideoExts:[".f4v",".m4v",".mpeg",".ogv",".webm",".wmv"],VideoUnkExts:[".3gp",".asf",".fla",".mts",".svi",".vob"],XlsExts:[".xls",".xlsb"],XlsmExts:[".xlsm"],XlstExts:[".xlst"],XlsxExts:[".xlsx"],XltExts:[".xlt"],XltmExts:[".xltm"],XltxExts:[".xltx"],XmlExts:[".xml"],XpsExts:[".xps",".oxps"]};ASC.Files.Utility.getCssClassByFileTitle=function(n,t){var f=ASC.Files.Utility,r=f.FileExtensionLibrary,e=f.GetFileExtension(n),i="file",u=function(n){return jq.inArray(e,n)!=-1};return u(r.ArchiveExts)?i="Archive":u(r.AviExts)?i="Avi":u(r.CalendarExts)?i="Cal":u(r.CsvExts)?i="Csv":u(r.DjvuExts)?i="Djvu":u(r.DocExts)?i="Doc":u(r.DocmExts)?i="Docm":u(r.DoctExts)?i="Doct":u(r.DocxExts)?i="Docx":u(r.DocxfExts)?i="Docxf":u(r.DotExts)?i="Dot":u(r.DotmExts)?i="Dotm":u(r.DotxExts)?i="Dotx":u(r.DvdExts)?i="Dvd":u(r.EpubExts)?i="Epub":u(r.Fb2Exts)?i="Fb2":u(r.FlvExts)?i="Flv":u(r.FodpExts)?i="Fodp":u(r.FodsExts)?i="Fods":u(r.FodtExts)?i="Fodt":u(r.GdocExts)?i="Gdoc":u(r.GsheetExts)?i="Gsheet":u(r.GslidesExts)?i="Gslides":u(r.HtmExts)?i="Htm":u(r.HtmlExts)?i="Html":u(r.IafExts)?i="Iaf":u(r.IcsExts)?i="Ics":u(r.ImgExts)?i="Image":u(r.M2tsExts)?i="M2ts":u(r.MhtExts)?i="Mht":u(r.MkvExts)?i="Mkv":u(r.MovExts)?i="Mov":u(r.Mp4Exts)?i="Mp4":u(r.MpgExts)?i="Mpg":u(r.OdpExts)?i="Odp":u(r.OdsExts)?i="Ods":u(r.OdtExts)?i="Odt":u(r.OformExts)?i="Oform":u(r.OtpExts)?i="Otp":u(r.OtsExts)?i="Ots":u(r.OttExts)?i="Ott":u(r.PdfExts)?i="Pdf":u(r.PotExts)?i="Pot":u(r.PotmExts)?i="Potm":u(r.PotxExts)?i="Potx":u(r.PpsExts)?i="Pps":u(r.PpsmExts)?i="Ppsm":u(r.PpsxExts)?i="Ppsx":u(r.PptExts)?i="Ppt":u(r.PptmExts)?i="Pptm":u(r.PpttExts)?i="Pptt":u(r.PptxExts)?i="Pptx":u(r.RtfExts)?i="Rtf":u(r.SoundExts)?i="Sound":u(r.SoundUnkExts)?i="SoundUnk":u(r.SvgExts)?i="Svg":u(r.TxtExts)?i="Txt":u(r.VideoExts)?i="Video":u(r.VideoUnkExts)?i="VideoUnk":u(r.XlsExts)?i="Xls":u(r.XlsmExts)?i="Xlsm":u(r.XlstExts)?i="Xlst":u(r.XlsxExts)?i="Xlsx":u(r.XltExts)?i="Xlt":u(r.XltmExts)?i="Xltm":u(r.XltxExts)?i="Xltx":u(r.XmlExts)?i="Xml":u(r.XpsExts)&&(i="Xps"),"ftFile_"+(t===!0?21:32)+" ft_"+i};ASC.Files.Utility.getFolderCssClass=function(n){return"ftFolder_"+(n===!0?21:32)};ASC.Files.Utility.GetFileExtension=function(n){if(typeof n=="undefined"||n==null)return"";n=n.trim();var t=n.lastIndexOf(".");return 0<=t?n.substring(t).trim().toLowerCase():""};ASC.Files.Utility.FileInAnInternalFormat=function(n){var t=ASC.Files.Utility.GetFileExtension(n);for(var i in ASC.Files.Utility.Resource.InternalFormats)if(ASC.Files.Utility.Resource.InternalFormats[i]===t)return!0;return!1};ASC.Files.Utility.CanImageView=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsImagePreviewed)!=-1};ASC.Files.Utility.CanWebView=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebPreviewed)!=-1};ASC.Files.Utility.CanWebEdit=function(n){return Teamlab.profile.isVisitor!==!0?jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebEdited)!=-1:!1};ASC.Files.Utility.CanWebEncrypt=function(n){return Teamlab.profile.isVisitor!==!0?jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebEncrypt)!=-1:!1};ASC.Files.Utility.CanWebReview=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebReviewed)!=-1};ASC.Files.Utility.CanWebCustomFilterEditing=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebCustomFilterEditing)!=-1};ASC.Files.Utility.CanWebRestrictedEditing=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebRestrictedEditing)!=-1};ASC.Files.Utility.CanWebComment=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebCommented)!=-1};ASC.Files.Utility.CanBeTemplate=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsWebTemplate)!=-1};ASC.Files.Utility.CanCoAuhtoring=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsCoAuthoring)!=-1};ASC.Files.Utility.MustConvert=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsMustConvert)!=-1};ASC.Files.Utility.GetConvertFormats=function(n){var t=ASC.Files.Utility.GetFileExtension(n);return ASC.Files.Utility.Resource.ExtsConvertible[t]||[]};ASC.Files.Utility.FileIsArchive=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsArchive)!=-1};ASC.Files.Utility.FileIsVideo=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsVideo)!=-1};ASC.Files.Utility.FileIsAudio=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsAudio)!=-1};ASC.Files.Utility.FileIsImage=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsImage)!=-1};ASC.Files.Utility.FileIsSpreadsheet=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsSpreadsheet)!=-1};ASC.Files.Utility.FileIsPresentation=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsPresentation)!=-1};ASC.Files.Utility.FileIsDocument=function(n){return jq.inArray(ASC.Files.Utility.GetFileExtension(n),ASC.Files.Utility.Resource.ExtsDocument)!=-1};ASC.Files.Utility.FileIsMasterForm=function(n){return ASC.Files.Utility.GetFileExtension(n)===ASC.Files.Utility.Resource.MasterFormExtension};ASC.Files.Utility.GetFileDownloadUrl=function(n,t,i){var r=ASC.Files.Utility.Resource.FileDownloadUrlString.format(encodeURIComponent(n));return t?r+"&"+ASC.Files.Utility.Resource.ParamVersion+"="+t:i?r+"&"+ASC.Files.Utility.Resource.ParamOutType+"="+i:r};ASC.Files.Utility.GetFileViewUrl=function(n,t,i){var r=ASC.Files.Utility.Resource.FileViewUrlString.format(encodeURIComponent(n));return t?r+"&"+ASC.Files.Utility.Resource.ParamVersion+"="+t:i?r+"&"+ASC.Files.Utility.Resource.ParamOutType+"="+i:r};ASC.Files.Utility.GetFileRedirectPreviewUrl=function(n,t){return ASC.Files.Utility.Resource.FileRedirectPreviewUrlString+(!t?"&fileid="+encodeURIComponent(n):"&folderid="+encodeURIComponent(t))};ASC.Files.Utility.GetFileWebViewerUrl=function(n,t){var i=ASC.Files.Utility.Resource.FileWebViewerUrlString.format(encodeURIComponent(n));return t?i+"&"+ASC.Files.Utility.Resource.ParamVersion+"="+t:i};ASC.Files.Utility.GetFileWebViewerExternalUrl=function(n,t,i){return ASC.Files.Utility.Resource.FileWebViewerExternalUrlString.format(encodeURIComponent(n),encodeURIComponent(t||""),encodeURIComponent(i||""))};ASC.Files.Utility.GetFileWebEditorUrl=function(n){return ASC.Files.Utility.Resource.FileWebEditorUrlString.format(encodeURIComponent(n))};ASC.Files.Utility.GetFileCustomProtocolEditorUrl=function(n){return ASC.Files.Utility.Resource.FileCustomProtocolEditorUrlString.format(encodeURIComponent(n))};ASC.Files.Utility.GetOpenPrivate=function(n){return ASC.Files.Utility.Resource.OpenPrivateString.format(encodeURIComponent(n))};ASC.Files.Utility.GetFileWebEditorExternalUrl=function(n,t,i){return ASC.Files.Utility.Resource.FileWebEditorExternalUrlString.format(encodeURIComponent(n),encodeURIComponent(t||""))+(i?"&folderid="+i:"")};ASC.Files.Utility.GetFileThumbnailUrl=function(n,t){var i=ASC.Files.Utility.Resource.FileThumbnailUrlString.format(encodeURIComponent(n));return t?i+"&"+ASC.Files.Utility.Resource.ParamVersion+"="+t:i};
var defineBodyMediaClass=function(){var i=jq("body"),t=[{min:0,max:1024,classname:"media-width-0-1024"},{min:0,max:1030,classname:"media-width-0-1030"},{min:0,max:1048,classname:"media-width-0-1048"},{min:0,max:1072,classname:"media-width-0-1072"},{min:0,max:1080,classname:"media-width-0-1080"},{min:0,max:1096,classname:"media-width-0-1096"},{min:0,max:1100,classname:"media-width-0-1100"},{min:0,max:1120,classname:"media-width-0-1120"},{min:0,max:1140,classname:"media-width-0-1140"},{min:0,max:1144,classname:"media-width-0-1144"},{min:0,max:1150,classname:"media-width-0-1150"},{min:0,max:1160,classname:"media-width-0-1160"},{min:0,max:1180,classname:"media-width-0-1180"},{min:0,max:1200,classname:"media-width-0-1200"},{min:0,max:1210,classname:"media-width-0-1210"},{min:1145,max:0,classname:"media-width-1145-0"},{min:0,max:1250,classname:"media-width-0-1250"},{min:0,max:1260,classname:"media-width-0-1260"},{min:0,max:1270,classname:"media-width-0-1270"},{min:0,max:1300,classname:"media-width-0-1300"},{min:0,max:1340,classname:"media-width-0-1340"},{min:0,max:1350,classname:"media-width-0-1350"},{min:0,max:1390,classname:"media-width-0-1390"},{min:0,max:1400,classname:"media-width-0-1400"},{min:0,max:1410,classname:"media-width-0-1410"},{min:0,max:1420,classname:"media-width-0-1420"},{min:0,max:1450,classname:"media-width-0-1450"},{min:0,max:1470,classname:"media-width-0-1470"},{min:0,max:1500,classname:"media-width-0-1500"},{min:0,max:1575,classname:"media-width-0-1575"},{min:0,max:1620,classname:"media-width-0-1620"},{min:0,max:1650,classname:"media-width-0-1650"},{min:1620,max:0,classname:"media-width-1620-0"},],r=jq("#studioPageContent").width()-jq(".mainPageTableSidePanel").width()+240,n,u;if(!i.hasClass("sailfish")){for(n=0,u=t.length;n<u;n++)r>=t[n].min&&(t[n].max==0||r<t[n].max)?i.hasClass(t[n].classname)||i.addClass(t[n].classname):i.hasClass(t[n].classname)&&i.removeClass(t[n].classname);i.removeClass("media-width-min")}},uvOptions;(function(){var i,r,f,e;if(jQuery&&jQuery.datepicker&&jQuery.datepicker.setDefaults({prevText:"",nextText:"",firstDay:ASC.Resources.Master.FirstDay,dateFormat:ASC.Resources.Master.DatepickerDatePattern,dayNamesMin:ASC.Resources.Master.DayNames,dayNamesShort:ASC.Resources.Master.DayNames,dayNames:ASC.Resources.Master.DayNamesFull,monthNamesShort:ASC.Resources.Master.MonthNames,monthNames:ASC.Resources.Master.MonthNamesFull}),ServiceHelper.init(ASC.Resources.Master.ApiPath),ServiceFactory.init({responses:{isme:ASC.Resources.Master.ApiResponsesMyProfile},portaldatetime:{utcoffsettotalminutes:ASC.Resources.Master.CurrentTenantTimeZone.UtcOffset,displayname:ASC.Resources.Master.CurrentTenantTimeZone.DisplayName},names:{months:ASC.Resources.Master.MonthNamesFull,shortmonths:ASC.Resources.Master.MonthNames,days:ASC.Resources.Master.DayNamesFull,shortdays:ASC.Resources.Master.DayNames},formats:{datetime:ASC.Resources.Master.DateTimePattern,time:ASC.Resources.Master.TimePattern,date:ASC.Resources.Master.DatePattern},avatars:{small:ASC.Resources.Master.AvatarSmall,medium:ASC.Resources.Master.AvatarMedium,large:ASC.Resources.Master.AvatarLarge},supportedfiles:{imgs:ASC.Files.Utility.Resource.ExtsImagePreviewed,docs:ASC.Files.Utility.Resource.ExtsWebPreviewed}}),Teamlab.init(),LoadingBanner.strLoading=ASC.Resources.Master.ResourceJS.LoadingProcessing,LoadingBanner.strDescription=ASC.Resources.Master.ResourceJS.LoadingDescription,StudioManager.initImageZoom(),jq.browser.msie&&jq.browser.version==10&&jq("body").addClass("ie10"),jq.blockUI.defaults.css={},jq.blockUI.defaults.overlayCSS={},jq.blockUI.defaults.fadeOut=0,jq.blockUI.defaults.fadeIn=0,jq.blockUI.defaults.message='<div class="loader-text-block">'+ASC.Resources.Master.ResourceJS.LoadingPleaseWait+"<\/div>",jq("#studio_sidePanel").length){LeftMenuManager.init(StudioManager.getBasePathToModule(),jq(".menu-list .menu-item.sub-list, .menu-list>.menu-item.sub-list>.menu-sub-list>.menu-sub-item"));LeftMenuManager.restoreLeftMenu();jq(".support-link").on("click",function(){jq(".support .expander").trigger("click")})}LeftMenuManager.bindEvents();i=jq("body").hasClass("desktop");ASC.Resources.Master.SetupInfoNotifyAddress&&ASC.Resources.Master.IsAuthenticated==!0&&ASC.Resources.Master.ApiResponsesMyProfile.response&&ASC.Resources.Master.ShowPromotions&&Teamlab.getBarPromotions({},i,{success:function(n,t){try{t&&eval(t)}catch(i){console.error(i)}}});r=!1;window.sessionStorage&&(r=!!window.sessionStorage.getItem("tipsWasClosed"));!r&&ASC.Resources.Master.SetupInfoTipsAddress&&ASC.Resources.Master.IsAuthenticated==!0&&ASC.Resources.Master.ApiResponsesMyProfile.response&&!ASC.Resources.Master.ApiResponsesMyProfile.response.isOutsider&&ASC.Resources.Master.ShowTips&&Teamlab.getBarTips({},i,{success:function(n,t){try{t&&eval(t)}catch(i){console.error(i)}}});f=new PopupBox("pb_StudioUserProfileInfo",320,140,"tintLight","borderBaseShadow","",{apiMethodName:"Teamlab.getProfile",tmplName:"userProfileCardTmpl"});jq(".userLink").each(function(){var n=jq(this).attr("id");n!=null&&n!=""&&f.RegistryElement(n,'"'+jq(this).attr("data-uid")+'"')});jq("#commonLogout").on("click",function(){return typeof SmallChat!="undefined"&&SmallChat.logoutEvent&&SmallChat.logoutEvent(),!0});e=function(){if(window.devicePixelRatio>1)return!0;return window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),            (min--moz-device-pixel-ratio: 1.5),            (-o-min-device-pixel-ratio: 3/2),            (min-resolution: 1.5dppx),            (min-device-pixel-ratio: 1.5)").matches?!0:!1};e()&&jq.cookies.get("is_retina")==null&&jq.cookies.set("is_retina",!0,{path:"/"});defineBodyMediaClass();var n=240,o=951-n,s=function(){var n=jq("#studioPageContent").width()-48-o-25;jq(".mainPageTableSidePanel").resizable("option","maxWidth",n)};jq(".mainPageTableSidePanel").length==1&&(jq(".mainPageTableSidePanel").resizable({maxWidth:n,minWidth:n,handles:"e",start:function(){jq("body:not(.media-width-min)").addClass("media-width-min");jq(".popup_helper").hide()},resize:function(n,t){if(jq("#studio_sidePanel").css("width",t.size.width),jq("body").hasClass("desktop")){var i=jq("#studio_sidePanel").outerWidth();jq("#studioPageContent").css("grid-template-columns",i+"px 1px 1fr")}jq(window).trigger("resizeSidePanel",[n,t])},create:function(){},stop:function(){}}),s());jq(window).on("resize",function(){jq(".studio-action-panel:not(.freeze-display)").hide();jq("body:not(.media-width-min)").addClass("media-width-min");clearTimeout(jq.data(this,"resizeWinTimer"));jq.data(this,"resizeWinTimer",setTimeout(function(){defineBodyMediaClass();jq(".mainPageTableSidePanel").length==1&&(s(),(jq("#studioPageContent").width()<jq(".mainPageTable.with-mainPageTableSidePanel").width()||jq(".mainPageTable.with-mainPageTableSidePanel .mainPageContent").outerWidth()<o)&&(jq("#studio_sidePanel").width(n),jq(".mainPageTableSidePanel").width(n)));jq(window).trigger("resizeWinTimer",null);jq("table.mainPageTable").tlBlock("resize");jq("div.advansed-filter").each(function(){jq(this).advansedFilter("resize")})},51));clearTimeout(jq.data(this,"resizeWinTimerWithMaxDelay"));jq.data(this,"resizeWinTimerWithMaxDelay",setTimeout(function(){defineBodyMediaClass();jq(window).trigger("resizeWinTimerWithMaxDelay",null);jq("table.mainPageTable").tlBlock("resize")},91))});var u=jq("#studioPageContent nav > .nav-content"),h=u.scrollTop(),t=jq("#studioPageContent main > .page-content"),c=t.scrollTop(),l=function(){t.find(".studio-action-panel, .popup_helper, .advanced-selector-container").hide();jq("#studioPageContent main .menu-small.active").removeClass("active");jq("#studioPageContent main .entity-menu.active").removeClass("active");jq("#ui-datepicker-div, .asc-popupmenu").hide()};u.on("scroll",function(){var n=u.scrollTop();h!=n&&(h=n,l())});t.on("scroll",function(){var n=t.scrollTop();c!=n&&(c=n,l())})})();jq("table.mainPageTable").tlBlock();setTimeout("jq(window).trigger('resize')",500);jq(window).one("resize",function(){clearTimeout(jq.data(this,"resizeWinTimer"));jq.data(this,"resizeWinTimer",setTimeout(function(){defineBodyMediaClass()},51))});uvOptions={custom_fields:{premium:ASC.Resources.Master.TenantIsPremium}};
var showHelpPage=function(n){var t,i;jq("#studioPageContent .mainPageContent").scrollTo(0);t=jq("link[rel*=icon][type^='image']:last");t.attr("href").indexOf("logo_favicon_general.ico")!==-1&&t.attr("href",t.attr("href"));i=!!jq("#contentHelp-"+n).length;jq(".help-center").addClass("currentCategory open").toggleClass("active",!i);jq(".help-center .menu-sub-item").removeClass("active");jq("[id^='contentHelp-']").toggleClass("display-none",i);i&&(jq("#contentHelp-"+n).removeClass("display-none"),jq(jq(".help-center .menu-sub-item")[n]).addClass("active"))};jq(function(){ASC.Controls.AnchorController.bind(/^help(?:=(\d+))?/,showHelpPage)});
typeof ASC=="undefined"&&(ASC={});typeof ASC.Controls=="undefined"&&(ASC.Controls={});ASC.Controls.GroupSelector=function(n,t,i,r){this.ID=n;this.SelectedGroup=null;this.Groups=[];this._groups=[];this.DisabledGroupIds=[];this.MobileVersion=t===!0;var u=this;this.AdditionalFunction=null;this.Open=function(){if(this.ClearFilter(),!this.MobileVersion){var n=jq("#groupSelectorBtn_"+this.ID).position();jq("#groupSelectorContainer_"+this.ID).css({display:"block"});jq("#grpselector_filter_"+this.ID).trigger("focus")}};this.Close=function(){this.MobileVersion||jq("#groupSelectorContainer_"+this.ID).hide();this.SelectedGroup!=null&&this.AdditionalFunction!=null&&this.AdditionalFunction(this.SelectedGroup)};this.SuggestGroups=function(){var t,i,n;if(!this.MobileVersion){for(t=jq("#grpselector_filter_"+this.ID).val().trim().toLowerCase(),t==""&&this.ClearFilter(),i=[],n=0;n<this._groups.length;n++)this._groups[n].Name.toLowerCase().indexOf(t)>=0&&i.push(this._groups[n]);jq("#grpselector_groupList_"+this.ID).html(jq.tmpl("groupSelectorListTemplate",{Groups:i}))}};this.HideGroup=function(n,t){var r,i;if(t==undefined&&(t=!0),t)this.DisabledGroupIds.push(n);else{for(r=[],i=0;i<this.DisabledGroupIds.length;i++)this.DisabledGroupIds[i]!=n&&r.push(this.DisabledGroupIds[i]);this.DisabledGroupIds=r}this.ClearFilter()};this.DisplayAll=function(){this.DisabledGroupIds=[];this.ClearFilter()};this.ClearFilter=function(){var n,r,i,t,f;for(this._groups=[],n=0,r=u.Groups.length;n<r;n++){for(i=!1,t=0,f=u.DisabledGroupIds.length;t<f;t++)if(this.DisabledGroupIds[t]==u.Groups[n].Id){i=!0;break}i||this._groups.push(u.Groups[n])}if(this.MobileVersion){jq("#grpselector_mgroupList_"+this.ID).html(jq.tmpl("groupSelectorListTemplate",{Groups:this._groups}));jq("#grpselector_mgroupList_"+this.ID+" option[value='"+this.SelectedGroup+"']").prop("selected",!0);return}jq("#grpselector_filter_"+this.ID).val("");jq("#grpselector_groupList_"+this.ID).html(jq.tmpl("groupSelectorListTemplate",{Groups:this._groups}))};this.MobileVersion===!0&&this.Groups.push(ASC.Resources.Master.GroupSelector_MobileVersionGroup);i&&this.Groups.push(ASC.Resources.Master.GroupSelector_WithGroupEveryone);r&&this.Groups.push(ASC.Resources.Master.GroupSelector_WithGroupAdmin);Array.prototype.push.apply(this.Groups,window.GroupManager.getGroupsArray(function(n){return{Id:n.id,Name:n.name}}));jq("#grpselector_filter_"+this.ID).on("keyup",function(){u.SuggestGroups()});jq("#grpselector_clearFilterBtn_"+this.ID).on("click",function(){u.ClearFilter()});jq(document).on("click",function(t){jq(t.target?t.target:t.srcElement).parents().addBack().is("#groupSelectorBtn_"+n+", #groupSelectorContainer_"+n)||jq("#groupSelectorContainer_"+n).hide()});if(t)jq("#grpselector_mgroupList_"+n).on("change",function(){var n=jq(this).val();n!=""&&n!="-1"&&(jq(u.Groups).each(function(t,i){if(i.Id==n)return u.SelectedGroup=i,!1}),u.Close())});else{jq("#groupSelectorBtn_"+n).on("click",function(){u.Open()});jq("#grpselector_clearFilterBtn_"+n).on("click",function(){u.ClearFilter()});jq("#grpselector_groupList_"+n).on("click",function(n){if(jq(n.target).is("div.group")){var t=jq(n.target).attr("data");t!=""&&(jq(u.Groups).each(function(n,i){if(i.Id==t)return u.SelectedGroup=i,!1}),u.Close())}})}};
typeof ASC=="undefined"&&(ASC={});typeof ASC.Mail=="undefined"&&(ASC.Mail=function(){return{}}());typeof ASC.Mail.Utility=="undefined"&&(ASC.Mail.Utility=function(){function i(){if(!window.ICAL)throw"Required ICAL module (~/js/third-party/ical.min.js)";if(!window.moment)throw"Required moment.js module (~/js/third-party/moment.min.js, ~/js/third-party/moment-timezone.min.js)";if(!window.RRule)throw"Required moment.js module (~/js/third-party/rrule.js, ~/js/third-party/nlp.js)";}function s(n){var t=jq.Deferred();return n.skipAccountsCheck?t.resolve(n,[]):window.Teamlab.getAccounts(n,{success:t.resolve,error:t.reject}),t.promise()}function h(n,t){function f(n){var t=jq.grep(n,function(n){return n.is_default===!0}),i=t.length>0?t[0]:n[0];return new ASC.Mail.Address(i.name,i.email,!0)}var i=jq.Deferred(),r,u;try{if(n.skipAccountsCheck)return i.resolve(n),i.promise();if(r=n.message,t.length===0)throw"No accounts.";if(r.from){if(u=jq.grep(t,function(n){return r.from.EqualsByEmail(n.email)}),u.length===0){if(!n.origCalendarEvent.canNotify)throw"From not found in your accounts.";r.from=f(t)}else if(u.length>1)throw"Found more then one account by From.";else if(!u[0].enabled)throw"Account is disabled.";}else r.from=f(t);i.resolve(n)}catch(e){i.reject(n,e)}return i.promise()}function y(n){var t=jq.Deferred(),i;return n.skipSave?(t.resolve(n,{messageUrl:null,saveSkipped:!0}),t.promise()):(i=n.message,window.Teamlab.saveMailMessage(n,i,{success:t.resolve,error:t.reject}),t.promise())}function p(n){var t=jq.Deferred(),i;return n.skipSave?(t.resolve(n,{messageUrl:null,saveSkipped:!0}),t.promise()):(i=n.message,window.Teamlab.saveMailTemplate(n,i,{success:t.resolve,error:t.reject}),t.promise())}function w(n,t){var i=jq.Deferred(),r;return n.skipSave?(i.resolve(n,{messageUrl:null,saveSkipped:!0}),i.promise()):(r=n.message,r.id=t.id,i.resolve(n,{messageUrl:"/addons/mail/#templateitem/"+r.id}),i.promise())}function b(n,t){var i=jq.Deferred(),r;return n.skipSave?(i.resolve(n,{messageUrl:null,saveSkipped:!0}),i.promise()):(r=n.message,r.id=t.id,i.resolve(n,{messageUrl:"/addons/mail/#draftitem/"+r.id}),i.promise())}function c(n,t){function h(r){var u=jq.Deferred(),f={fileId:r,version:""};return window.Teamlab.addMailDocument({message:i,documentId:r,sendImmediately:n.sendImmediately},i.id,f,{success:function(n,r){i.attachments.push(r);i.RemoveDocumentAfterSave(n.documentId);u.resolve(n,t)},error:u.reject}),u.promise()}var r=jq.Deferred(),i,f,e,u,o,s;if(n.skipSave)return r.resolve(n,t),r.promise();if(i=n.message,i.HasDocumentsForSave()){for(f=i.GetDocumentsForSave(),e=[],u=0,o=f.length;u<o;u++)s=f[u],e.push(h(s));jq.when.apply(jq,e).done(function(){i.HasDocumentsForSave()?r.reject(n,"Something goes wrong."):r.resolve(n,t)}).fail(r.reject)}else r.resolve(n,t);return r.promise()}function k(n){var t=jq.Deferred(),i;return n.skipSend?(t.resolve(n,-1),t.promise()):(i=n.message,window.Teamlab.sendMailMessage(n,i,{success:t.resolve,error:t.reject}),t.promise())}function d(n,t){var u=jq.Deferred(),f=n.skipSend?{messageUrl:null,sendSkipped:!0}:{messageUrl:"/addons/mail/#conversation/"+t},e=ASC.SocketIO&&!ASC.SocketIO.disabled()?ASC.SocketIO.Factory.counters:null,i;return n.skipSend||e&&e.connected()||(i=0,n.method==="REQUEST"?i=1:n.method==="REPLY"?i=2:n.method==="CANCEL"&&(i=3),r=t,setTimeout(function(){ASC.Mail.Utility._showSignalRMailNotification(i)},3e3)),n.method!=="REPLY"||n.skipCalendarImport?u.resolve(n,f):Teamlab.importCalendarEventIcs({},n.calendarId,n.message.calendarIcs,{success:function(){u.resolve(n,f)},error:u.reject,max_request_attempts:1}),u.promise()}function e(n){var t=jq.Deferred();return Teamlab.getCalendarEventByUid(n,n.calendarEventUid,{success:t.resolve,error:t.reject,max_request_attempts:1}),t.promise()}function u(n,t){var o=jq.Deferred(),c,u,f,r,i,s,e,h;try{if(n.origCalendarEvent=t,!t||!t.mergedIcs)throw"Empty ical";if(c=window.ICAL.parse(t.mergedIcs),u=new window.ICAL.Component(c),u.name!=="vcalendar")throw"Unsupported ical type (only vcalendar)";if(f=u.getFirstSubcomponent("vevent"),!f)throw"VEVENT not found";if(r=new window.ICAL.Event(f),r.uid!==n.calendarEventUid)throw'No found event by calendarEventUid="{0}"'.format(n.calendarEventUid);if(i={comp:u,vevent:f,event:r,organizerAddress:new ASC.Mail.Address(Encoder.htmlDecode(f.getFirstProperty("organizer").getParameter("cn")||""),r.organizer.toLowerCase().replace("mailto:","")),calendarTimeZone:t.timeZone},s=f.getFirstPropertyValue("rrule"),s!==null&&(i.recurrence=ASC.Mail.Utility.ToRRuleRfc2445String(s)),!ASC.Mail.Utility.IsValidEmail(i.organizerAddress.email))throw'Organizer email "{0}" is invalid'.format(i.organizerAddress.email,r.organizer);if(i.organizerAddress.isValid=!0,!r.attendees||r.attendees.length===0)throw"Unable to find attendees";switch(n.method){case"REQUEST":case"REPLY":if(u.getFirstPropertyValue("method")!=="REQUEST"&&u.getFirstPropertyValue("method")!=="REPLY"&&u.getFirstPropertyValue("method")!=="PUBLISH")throw"Allow only REQUEST";break;case"CANCEL":break;default:throw'Unsupported send method "{0}"'.format(n.method);}if(n.method==="REPLY"){if(e=jq.grep(r.attendees,function(t){return ASC.Mail.Utility.IsEqualEmail(t.getFirstValue().toLowerCase().replace("mailto:",""),n.attendeeEmail)})[0],!e)throw'Attendee with email "{0}" not found'.format(n.attendeeEmail);if(e.getParameter("partstat")===n.replyDecision)throw'Attendee with email "{0}" already answered "{1}"'.format(n.attendeeEmail,n.replyDecision);if(i.currentAttendee=e,i.currentAttendeeAddress=new ASC.Mail.Address(Encoder.htmlDecode(e.getParameter("cn")||""),e.getFirstValue().toLowerCase().replace("mailto:","")),!ASC.Mail.Utility.IsValidEmail(i.currentAttendeeAddress.email))throw'Attendee email "{0}" is invalid'.format(i.currentAttendeeAddress.email,i.currentAttendee);i.currentAttendeeAddress.isValid=!0;n.skipSend=i.currentAttendeeAddress.EqualsByEmail(i.organizerAddress);n.skipSend&&(n.skipSave=!0)}else if(n.method==="CANCEL"&&n.attendeesEmails){if(h=jq.grep(r.attendees,function(t){for(var r=!1,i=0,u=n.attendeesEmails.length;i<u;i++)if(ASC.Mail.Utility.IsEqualEmail(t.getFirstValue().toLowerCase().replace("mailto:",""),n.attendeesEmails[i].toLowerCase())){r=!0;break}return r}),!h)throw"Attendees for cancel not found in event.";i.cancelAttendees=h}o.resolve(n,i)}catch(l){o.reject(n,l)}return o.promise()}function o(t,i){function y(n){return n?"https://maps.google.com/maps?q={0}".format(n.split(/[,\s]/).join("+")):""}var r,f,l,v;window.moment.locale(ASC.Resources.Master.TwoLetterISOLanguageName);var e=window.moment(i.event.startDate.toJSDate()),u=window.moment(i.event.endDate.toJSDate()),o=i.event.startDate.isDate,s=i.event.endDate.isDate,h=i.calendarTimeZone&&!o?e.utcOffset(i.calendarTimeZone.offset):e,c=i.calendarTimeZone&&!s?u.utcOffset(i.calendarTimeZone.offset):u;o&&s&&e.isBefore(u,"day")&&(u=u.clone().startOf("day").add(-1,"day"),c=u);r={summary:i.event.summary,location:i.event.location,allDay:!1,orgName:i.organizerAddress.name,orgEmail:i.organizerAddress.email,mailToHref:"mailto:"+i.organizerAddress.email,mapUrl:i.event.location?y(i.event.location):null,description:i.event.description};r.dateEvent=ASC.Mail.Utility.ToCalendarDateString(h,c,o,s);i.recurrence&&(r.rruleText=ASC.Mail.Utility.ToCalendarRRuleString(i.recurrence,h));switch(t.method){case"REQUEST":r.action=t.isUpdate?n.MailIcsUpdateDescription:n.MailIcsRequestDescription.format(i.organizerAddress.name||i.organizerAddress.email||i.currentAttendeeAddress.name||i.currentAttendeeAddress.email);break;case"REPLY":switch(t.replyDecision){case"ACCEPTED":f=n.MailIcsReplyYesDescription;break;case"TENTATIVE":f=n.MailIcsReplyMaybeDescription;break;case"DECLINED":f=n.MailIcsReplyNoDescription;break;default:throw"Unsupported attendee partstart";}r.action=f.format(i.currentAttendeeAddress.name||i.currentAttendeeAddress.email);break;case"CANCEL":r.action=n.MailIcsCancelDescription}return l=jq("<div/>").html(jq.tmpl("template-mailCalendar",r)).prop("outerHTML"),v=a(l),v}function g(t,i){var u=jq.Deferred(),r=new ASC.Mail.Message,f=[],e,s;return jq.each(i.event.attendees,function(n,r){var u=r.getFirstValue().toLowerCase().replace("mailto:",""),s=r.getParameter("cn")||"",e,o;if(ASC.Mail.Utility.IsValidEmail(u)){if(i.organizerAddress.EqualsByEmail(u)||(e=new ASC.Mail.Address(s,u,!0),t.attendeesEmails&&(o=jq.grep(t.attendeesEmails,function(n){return e.EqualsByEmail(n)}),o.length===0)))return!0;f.push(e)}return!0}),f.length>0?(e=i.organizerAddress,s=t.isUpdate?n.MailIcsUpdateSubject.format(i.event.summary):n.MailIcsRequestSubject.format(i.event.summary),r.from=e,r.to=f,r.subject=s,r.body=o(t,i),r.calendarIcs=i.comp.toString(),u.resolve(r,t)):u.reject(t,"Empty recipients list (toAddresses)"),u.promise()}function l(t,i){var e=jq.Deferred(),r=new ASC.Mail.Message,f,s,u,h;try{i.comp.updatePropertyWithValue("prodid","-//Ascensio System//OnlyOffice Calendar//EN");i.comp.updatePropertyWithValue("method",t.method);i.currentAttendee.removeParameter("rsvp");i.currentAttendee.setParameter("partstat",t.replyDecision);f=window.ICAL.Time.now();i.vevent.updatePropertyWithValue("dtstamp",f);i.vevent.updatePropertyWithValue("created",f);i.vevent.updatePropertyWithValue("last-modified",f);i.vevent.removeAllProperties("attendee");i.vevent.addProperty(i.currentAttendee);s=i.organizerAddress;switch(t.replyDecision){case"ACCEPTED":u=n.MailIcsReplyYesDescription;break;case"TENTATIVE":u=n.MailIcsReplyMaybeDescription;break;case"DECLINED":u=n.MailIcsReplyNoDescription;break;default:throw"Unsupported attendee partstart";}u='{0} "{1}"'.format(u.format(i.currentAttendeeAddress.name||i.currentAttendeeAddress.email),i.event.summary);h=new ASC.Mail.Address("",t.attendeeEmail,!0);r.from=h;r.to=[s];r.subject=n.MailIcsReplySubject.format(u);r.body=o(t,i);r.calendarIcs=i.comp.toString();e.resolve(r,t)}catch(c){e.reject(t,c)}return e.promise()}function nt(t,i){var s=jq.Deferred(),u=new ASC.Mail.Message,f,r,h,e,c;if(i.comp.updatePropertyWithValue("prodid","-//Ascensio System//OnlyOffice Calendar//EN"),i.comp.updatePropertyWithValue("method",t.method),i.comp.updatePropertyWithValue("status","CANCELLED"),f=[],i.cancelAttendees)for(i.vevent.removeAllProperties("attendee"),r=0,h=i.cancelAttendees.length;r<h;r++)i.cancelAttendees[r].removeParameter("rsvp"),i.cancelAttendees[r].setParameter("partstat","DECLINED"),i.vevent.addProperty(i.cancelAttendees[r]),f.push(new ASC.Mail.Address(i.cancelAttendees[r].getParameter("cn"),i.cancelAttendees[r].getFirstValue().toLowerCase().replace("mailto:",""),!0));else jq.each(i.event.attendees,function(n,t){var i=t.getFirstValue().toLowerCase().replace("mailto:",""),r=t.getParameter("cn")||"";ASC.Mail.Utility.IsValidEmail(i)&&f.push(new ASC.Mail.Address(r,i,!0))});return e=window.ICAL.Time.now(),i.vevent.updatePropertyWithValue("dtstamp",e),i.vevent.updatePropertyWithValue("created",e),i.vevent.updatePropertyWithValue("last-modified",e),c=i.organizerAddress,u.from=c,u.to=f,u.subject=n.MailIcsCancelSubject.format(i.event.summary),u.body=o(t,i),u.calendarIcs=i.comp.toString(),s.resolve(u,t),s.promise()}function tt(t){var e=jq.Deferred(),r,u,i,o,f;for(receiptMessage=new ASC.Mail.Message,receiptMessage.isReceipt=!0,receiptMessage.subject=t.subject!==""?n.ReceiptSubjectLabel.format(t.subject):n.ReceiptSubjectLabel.format(window.MailScriptResource.NoSubject),receiptMessage.from=t.from,receiptMessage.to=t.to,window.moment.locale(ASC.Resources.Master.TwoLetterISOLanguageName),r="",u=ASC.Mail.Utility.ParseAddresses(t.toAddresses).addresses,i=0,o=u.length;i<o;i++)if(f=u[i],f.email===t.from){r=f.name;break}var s={user:r,receiptLabel:receiptMessage.subject,mailTo:t.from,receiptUserLabel:n.ReceiptUserLabel.format(t.subject),dateNow:window.moment().format("LLLL"),sentRequestInfoLabel:n.SentRequestInfoLabel,dateSent:window.moment(t.receivedDate).format("LLLL")},h=jq("<div/>").html(jq.tmpl("template-mailReceipt",s)).prop("outerHTML"),c=a(h);return receiptMessage.body=c,e.resolve(receiptMessage,t),e.promise()}function a(n){return'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">                    <html xmlns="http://www.w3.org/1999/xhtml">                        <head>                            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />                            <link href="https://fonts.googleapis.com/css?family=Open+Sans:900,800,700,600,500,400,300&subset=latin,cyrillic-ext,cyrillic,latin-ext" rel="stylesheet" type="text/css" />                            <meta name="viewport" content="width=device-width" />                        <\/head>                        <body style="margin: 0; padding: 0; text-align: center; width: 100%; font-family: \'Open Sans\', Tahoma, Arial; font-size: 14px; color: #333;">'+n+"<\/body>                    <\/html>"}function v(n){var t=jq.Deferred();try{if(i(),!n.calendarEventUid)throw"Param 'calendarEventUid' value is empty";e(n).then(u,t.reject).then(g,t.reject).then(ASC.Mail.Utility.SendMessage,t.reject).then(t.resolve,t.reject)}catch(r){t.reject(n,r)}return t.promise()}function it(n){var t=jq.Deferred();try{if(i(),!n.calendarEventUid)throw"Param 'calendarEventUid' value is empty";e(n).then(u,t.reject).then(nt,t.reject).then(ASC.Mail.Utility.SendMessage,t.reject).then(t.resolve,t.reject)}catch(r){t.reject(n,r)}return t.promise()}function f(n){var t={addresses:[],hasBad:!1},r,i,f,u;if(!n||!n.length)return t;if(!Array.isArray(n)&&"string"==typeof n)return r=ASC.Mail.Utility.ParseAddresses(n),t.addresses=r.addresses,t.hasBad=r.errors.length>0,t;for(i=0,f=n.length;i<f;i++)u=(n[i]instanceof ASC.Mail.Address)?n[i]:ASC.Mail.Utility.ParseAddress(n[i]),t.addresses.push(u),u.isValid||(t.hasBad=!0);return t}var n=ASC.Resources.Master.ResourceJS,t={None:0,EmptyRecipients:1,IncorrectEmail:2},r=0;return{ParseErrorTypes:t,ParseAddresses:function(n){function h(n){var t=n.match(/^"(.*)"\s*<([^>]+)>$/)||n.match(/^(.*)<([^>]+)>$/);return t?{name:t[1].replace(/\\"/g,'"').replace(/\\\\/g,"\\").trim(),email:t[2].trim()}:{email:n}}function c(n){var t=undefined;return n.email&&(t=n.email,n.name&&(t='"'+n.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'" <'+t+">")),t}function o(n){var r,u,f;(n=c(h(n)),n)&&(r=emailAddresses.parseOneAddress(n),r?(u=!0,r.domain.indexOf(".")!==-1&&/(^((?!-)[a-zA-Z0-9-]{1,63}\.)+[a-zA-Z]{2,63}\.?$)/.test(r.domain)||(u=!1,i.errors.push({message:"Incorrect domain",type:t.IncorrectEmail,errorItem:n})),r.domain.indexOf("[")===0&&r.domain.indexOf("]")===r.domain.length-1&&i.errors.push({message:"Domains as ip adress are not suppoted",type:t.IncorrectEmail,errorItem:n}),/^[\x00-\x7F]+$/.test(punycode.toUnicode(r.domain))||(u=!1,i.errors.push({message:"Punycode domains are not suppoted",type:t.IncorrectEmail,errorItem:n})),/^[\x00-\x7F]+$/.test(r.local)&&/^([a-zA-Z0-9]+)([_\-\.\+][a-zA-Z0-9]+)*$/.test(r.local)||(u=!1,i.errors.push({message:"Incorrect localpart",type:t.IncorrectEmail,errorItem:n})),(/\s+/.test(r.local)||r.local!==r.parts.local.tokens)&&(u=!1,i.errors.push({message:"Incorrect, localpart contains spaces",type:t.IncorrectEmail,errorItem:n})),(/\s+/.test(r.domain)||r.domain!==r.parts.domain.tokens)&&(u=!1,i.errors.push({message:"Incorrect, domain contains spaces",type:t.IncorrectEmail,errorItem:n})),i.addresses.push(new ASC.Mail.Address(r.name||"",r.address,u))):(f=n.trim(),f&&(i.addresses.push(new ASC.Mail.Address("",f,!1)),i.errors.push({message:"Incorrect email",type:t.IncorrectEmail,errorItem:n}))))}var i={addresses:[],errors:[]},r;if("string"!=typeof n||n.length===0)return i.errors.push({message:"Empty recipients",type:t.EmptyRecipients,errorItem:null}),i;r=n.replace(/[\s,;]*$/,",");for(var f,e=!1,s=0,u=0,l=r.length;l>u;u+=1)switch(r.charAt(u)){case",":case";":e||(f=r.substring(s,u),f=f.trim(),f&&o(f),s=u+1);break;case'"':"\\"!==r.charAt(u-1)&&'"'!==r.charAt(u+1)&&(e=!e)}return i.addresses.length||o(r.replace(/,\s*$/,"")),i},ParseAddress:function(n){var t=ASC.Mail.Utility.ParseAddresses(n);return t.errors.length>0||t.addresses.length!==1?new ASC.Mail.Address("",n,!1):t.addresses[0]},IsValidEmail:function(n,t){t=t||{nameExistance:!1};t.hasOwnProperty("nameExistance")||(t.nameExistance=!1);var i=ASC.Mail.Utility.ParseAddress(n);return!t.nameExistance&&i.name?!1:i.isValid},IsValidDomainName:function(n){var t=emailAddresses.parseOneAddress("test@"+n);return!!t&&t.domain===n&&n.indexOf(".")!==-1},IsEqualEmail:function(n,t){var i=ASC.Mail.Utility.ParseAddress(n),r=ASC.Mail.Utility.ParseAddress(t);return!i.isValid||!r.isValid?!1:i.email===r.email},SaveMessageInDrafts:function(n,t){var i=jq.Deferred();t=t||{skipAccountsCheck:!0};try{if(!(n instanceof ASC.Mail.Message))throw"Unsupported message format";if(n.body.length>ASC.Resources.Master.MailMaximumMessageBodySize)throw"Message body exceeded limit";t.hasOwnProperty("skipAccountsCheck")&&n.from||(t.skipAccountsCheck=!1);t.message=n;s(t).then(h,i.reject).then(y,i.reject).then(b,i.reject).then(c,i.reject).then(i.resolve,i.reject)}catch(r){i.reject(t,r)}return i.promise()},SaveMessageInTemplates:function(n,t){var i=jq.Deferred();t=t||{skipAccountsCheck:!0};try{if(!(n instanceof ASC.Mail.Message))throw"Unsupported message format";if(n.body.length>ASC.Resources.Master.MailMaximumMessageBodySize)throw"Message body exceeded limit";t.hasOwnProperty("skipAccountsCheck")&&n.from||(t.skipAccountsCheck=!1);t.message=n;s(t).then(h,i.reject).then(p,i.reject).then(w,i.reject).then(c,i.reject).then(i.resolve,i.reject)}catch(r){i.reject(t,r)}return i.promise()},SendMessage:function(n,t){var r=jq.Deferred(),i;t=t||{skipAccountsCheck:!0};try{if(!(n instanceof ASC.Mail.Message))throw"Unsupported message format";if(t.hasOwnProperty("skipAccountsCheck")&&n.from||(t.skipAccountsCheck=!1),i=f(n.to),n.to=i.addresses,n.to.length||n.cc.length||n.bcc.length){if(i.hasBad)throw"To field contains invalid recipients.";}else throw"To field is empty";if(i=f(n.cc),n.cc=i.addresses,i.hasBad)throw"Cc field contains invalid recipients.";if(i=f(n.bcc),n.bcc=i.addresses,i.hasBad)throw"Bcc field contains invalid recipients.";ASC.Mail.Utility.SaveMessageInDrafts(n,t).then(k,r.reject).then(d,r.reject).then(r.resolve,r.reject)}catch(u){r.reject(t,u)}return r.promise()},SendReceipt:function(n){var t=jq.Deferred();try{tt(n).then(ASC.Mail.Utility.Send).then(function(){var n=ASC.SocketIO&&!ASC.SocketIO.disabled()?ASC.SocketIO.Factory.counters:null;n&&n.connected()||setTimeout(function(){ASC.Mail.Utility._showSignalRMailNotification(4)},3e3)}).then(t.resolve,t.reject)}catch(i){t.reject(n,i)}return t.promise()},Send:function(n,t){var i=jq.Deferred(),r;t=t||{skipAccountsCheck:!0};try{if(!(n instanceof ASC.Mail.Message))throw"Unsupported message format";if(t.hasOwnProperty("skipAccountsCheck")&&n.from||(t.skipAccountsCheck=!1),r=f(n.to),n.to=r.addresses,n.to.length){if(r.hasBad)throw"To field contains invalid recipients.";}else throw"To field is empty";window.Teamlab.simpleMailSend(t,n,{success:i.resolve,error:i.reject})}catch(u){i.reject(t,u)}return i.promise()},SendCalendarRequest:function(n,t,i,r){return r=r||{skipAccountsCheck:!0},r.calendarId=n||-1,r.calendarEventUid=t,r.method="REQUEST",r.skipSave=r.skipSave||!0,i&&(r.attendeesEmails=i),v(r)},SendCalendarUpdate:function(n,t,i,r){return r=r||{skipAccountsCheck:!1},r.calendarId=n||-1,r.calendarEventUid=t,r.method="REQUEST",r.isUpdate=!0,r.skipSave=r.skipSave||!0,i&&(r.attendeesEmails=i),v(r)},SendCalendarReply:function(n,t,r,f,o){var s=jq.Deferred();o=o||{skipAccountsCheck:!0};o.calendarId=n||-1;o.calendarEventUid=t;o.method="REPLY";o.attendeeEmail=r;o.replyDecision=f;o.skipSave=o.skipSave||!0;try{if(i(),!t)throw t;if(!r)throw r;if(!f)throw f;if(f!=="ACCEPTED"&&f!=="DECLINED"&&f!=="TENTATIVE")throw f;if(!ASC.Mail.Utility.IsValidEmail(r))throw r;e(o).then(u,s.reject).then(l,s.reject).then(ASC.Mail.Utility.SendMessage,s.reject).then(s.resolve,s.reject)}catch(h){s.reject(o,h)}return s.promise()},SendCalendarReplyIcs:function(n,t,r,f,e){var o=jq.Deferred();e=e||{skipAccountsCheck:!0};e.calendarId=-1;e.calendarEventUid=n;e.method="REPLY";e.attendeeEmail=r;e.replyDecision=f;e.skipSave=e.skipSave||!0;e.skipCalendarImport=e.skipCalendarImport||!0;try{if(i(),!n)throw n;if(!r)throw r;if(!f)throw f;if(f!=="ACCEPTED"&&f!=="DECLINED"&&f!=="TENTATIVE")throw f;if(!ASC.Mail.Utility.IsValidEmail(r))throw r;u(e,{mergedIcs:t}).then(l,o.reject).then(ASC.Mail.Utility.SendMessage,o.reject).then(o.resolve,o.reject)}catch(s){o.reject(e,s)}return o.promise()},SendCalendarCancel:function(n,t,i,r){return r=r||{skipAccountsCheck:!0},r.calendarId=n||-1,r.calendarEventUid=t,r.method="CANCEL",r.skipSave=r.skipSave||!0,i&&(r.attendeesEmails=i),it(r)},_showSignalRMailNotification:function(t){var i=StudioManager.getCurrentModule();if(i==="mail"||i==="calendar"){switch(t){case-2:toastr.error(n.MailSendReceiptError);break;case-1:toastr.error(n.MailSendMessageError);i==="mail"&&window.mailAlerts&&window.mailAlerts.check(r>0?{showFailureOnlyMessageId:r}:{});break;case 0:toastr.success(n.MailSentMessageText);i==="mail"&&window.mailAlerts&&(!ASC.Resources.Master.Hub.Url||jq.connection&&jq.connection.hub.state!==jq.connection.connectionState.connected)&&setTimeout(function(){window.mailAlerts.check(r>0?{showFailureOnlyMessageId:r}:{})},5e3);break;case 1:toastr.success(n.MailSentIcalRequestText);break;case 2:toastr.success(n.MailSentIcalResponseText);break;case 3:toastr.success(n.MailSentIcalCancelText);break;case 4:toastr.success(n.ReadingConfirmedLabel)}i==="mail"&&window.messagePage&&window.messagePage.refreshMailAfterSent(t)}},ToCalendarDateString:function(t,r,u,f){i();var e=t.format("ddd, DD MMM YYYY"),o=r.format("ddd, DD MMM YYYY"),h=u?"":t.format("LT"),c=f?"":r.format("LT"),s="(UTC{0})".format(t.format("Z"));return t.isSame(r,"day")?u?"{0}, {1}".format(e,n.MailIcsCalendarAllDayEventLabel):"{0}, {1} - {2} {3}".format(e,h,c,s):u&&f?"{0}, {1} - {2}, {1}".format(e,n.MailIcsCalendarAllDayEventLabel,o):u&&!f?"{0}, {1} - {2}, {3} {4}".format(e,n.MailIcsCalendarAllDayEventLabel,o,c,s):!u&&f?"{0}, {1} {2} - {3}, {4}".format(e,h,s,o,n.MailIcsCalendarAllDayEventLabel):"{0}, {1} - {2}, {3} {4}".format(e,h,o,c,s)},ToCalendarRRuleString:function(t,r,u){function s(t){switch(t.toLowerCase()){case"every":return n.MailIcsRRuleEveryLabel;case"until":return n.MailIcsRRuleUntilLabel;case"for":return n.MailIcsRRuleForLabel;case"times":return n.MailIcsRRuleTimesLabel;case"time":return n.MailIcsRRuleTimeLabel;case"(~ approximate)":return"(~ {0})".format(n.MailIcsRRuleApproximateLabel);case"hours":return n.MailIcsRRuleHoursLabel;case"hour":return n.MailIcsRRuleHourLabel;case"weekdays":return n.MailIcsRRuleWeekdaysLabel;case"weekday":return n.MailIcsRRuleWeekdayLabel;case"days":return n.MailIcsRRuleDaysLabel;case"day":return n.MailIcsRRuleDayLabel;case"weeks":return n.MailIcsRRuleWeeksLabel;case"week":return n.MailIcsRRuleWeekLabel;case"months":return n.MailIcsRRuleMonthsLabel;case"month":return n.MailIcsRRuleMonthLabel;case"years":return n.MailIcsRRuleYearsLabel;case"year":return n.MailIcsRRuleYearLabel;case"on":return n.MailIcsRRuleOnLabel;case"on the":return n.MailIcsRRuleOnTheLabel;case"in":return n.MailIcsRRuleInLabel;case"at":return n.MailIcsRRuleAtLabel;case"the":return n.MailIcsRRuleTheLabel;case"and":return n.MailIcsRRuleAndLabel;case"or":return n.MailIcsRRuleOrLabel;case"last":return n.MailIcsRRuleLastLabel;case"st":return n.MailIcsRRuleStLabel;case"nd":return n.MailIcsRRuleNdLabel;case"rd":return n.MailIcsRRuleRdLabel;case"th":return n.MailIcsRRuleThLabel;case"rrule error: unable to fully convert this rrule to text":return n.MailIcsRRuleParseErrorLabel;default:return t}}var f,e,o;i();r||(r=window.moment());try{return f=RRule.parseString(t),f.dtstart=r.toDate(),e=new RRule(f),o={dayNames:ASC.Resources.Master.DayNames,monthNames:ASC.Resources.Master.MonthNames,tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"hour(s)":/^hours?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,at:/^(at)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,"for":/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}},u?e.toText():e.toText(s,o)}catch(h){console.warn(h)}return""},ToRRuleRfc2445String:function(n){var t,i;if(typeof n!="object"&&!n.icaltype&&n.icaltype!=="recur")throw"not supported rrule param";t="FREQ="+n.freq;n.count&&(t+=";COUNT="+n.count);n.interval>1&&(t+=";INTERVAL="+n.interval);for(i in n.parts)n.parts.hasOwnProperty(i)&&(t+=";"+i+"="+n.parts[i]);return n.until&&(t+=";UNTIL="+(n.until.isDate?window.moment(n.until.toJSDate()).startOf("day"):window.moment(n.until.toJSDate()).utc()).format("YYYYMMDD[T]HHmmss[Z]")),"wkst"in n&&n.wkst!==ICAL.Time.DEFAULT_WEEK_START&&(t+=";WKST="+ICAL.Recur.numericDayToIcalDay(n.wkst)),t},GetDraftUrl:function(n){var t="/addons/mail/#compose";return n?(n instanceof Array||(n=[n]),t+"?files={0}".format(encodeURIComponent(JSON.stringify(n)))):t},ParseMailTo:function(n){var t,i,r,u,f,e;try{return t={},i=n.match(/mailto:([^\?]*)/),i=i&&i[1]?i[1]:!1,r=n.match(/cc=([^&]+)/),r=r&&r[1]?r[1]:!1,u=n.match(/bcc=([^&]+)/),u=u&&u[1]?u[1]:!1,f=n.match(/subject=([^&]+)/),f=f&&f[1]?f[1].replace(/\+/g," "):!1,e=n.match(/body=([^&]+)/),e=e&&e[1]?e[1].replace(/\+/g," "):!1,i&&(t.email=i),r&&(t.cc=r),u&&(t.bcc=u),f&&(t.subject=decodeURIComponent(f)),e&&(t.body=decodeURIComponent(e)),t}catch(o){console.log("Failed ParseMailTo",o)}return null}}}());typeof ASC.Mail.Message=="undefined"&&(ASC.Mail.Message=function(){var n=[];this.id=0;this.from="";this.to=[];this.cc=[];this.bcc=[];this.subject="";this.body="";this.attachments=[];this.mimeReplyToId="";this.importance=!1;this.tags=[];this.fileLinksShareMode=2;this.calendarIcs="";this.requestReceipt=!1;this.requestRead=!1;this.isReceipt=!1;this.HasDocumentsForSave=function(){return n.length>0};this.AddDocumentsForSave=function(t){jq.merge(n,t)};this.GetDocumentsForSave=function(){return n};this.RemoveDocumentAfterSave=function(t){for(var r=-1,f=n.length,u,i=0;i<f;i++)if(u=n[i],u===t){r=i;break}r>-1&&n.splice(r,1)};this.ToData=function(){function i(n){return typeof n=="object"&&!(n instanceof ASC.Mail.Address)&&n.hasOwnProperty("name")&&n.hasOwnProperty("email")&&n.hasOwnProperty("isValid")&&(n=new ASC.Mail.Address(n.name,n.email,n.isValid)),n instanceof ASC.Mail.Address?n.ToString():n}function t(n){return n.map(i)}var r=JSON.stringify(this),n=JSON.parse(r);return n.from=i(n.from),n.to=t(n.to),n.cc=t(n.cc),n.bcc=t(n.bcc),n}},typeof ASC.Mail.Address=="undefined"&&(ASC.Mail.Address=function(n,t,i){function r(n){var t,i,u,r;if(!n)return"";for(t='"',i=0,u=n.length;i<u;i++)r=n[i],(r==="\\"||r==='"')&&(t+="\\"),t+=r;return t+'"'}this.name=n||"";this.email=t;this.isValid=i;this.ToString=function(n){return this.name?n?this.name+" <"+this.email+">":r(this.name)+" <"+this.email+">":this.email};this.Equals=function(n){if(typeof n=="object"&&n instanceof ASC.Mail.Address)return this===n;if(typeof n=="string"){var t=ASC.Mail.Utility.ParseAddress(n);return this.email===t}return!1};this.EqualsByEmail=function(n){if(typeof n=="object"&&n instanceof ASC.Mail.Address)return this.email.toLowerCase()===n.email.toLowerCase();if(typeof n=="string"){var t=ASC.Mail.Utility.ParseAddress(n);return this.email.toLowerCase()===t.email.toLowerCase()}return!1}}));typeof ASC.Mail.Sanitizer=="undefined"&&(ASC.Mail.Sanitizer=function(){function r(n){return n=n||{urlProxyHandler:"",needProxyHttp:!1,loadImages:!0,baseHref:window.location.origin},n.hasOwnProperty("urlProxyHandler")&&n.urlProxyHandler.length!==0||(n.urlProxyHandler="",n.needProxyHttp=!1),n.hasOwnProperty("needProxyHttp")||(n.needProxyHttp=!1),n.hasOwnProperty("loadImages")||(n.loadImages=!0),n.hasOwnProperty("baseHref")||(n.baseHref=window.location.origin),n}function t(t,i,r){for(var f,u=i.length-1;u>=0;u--)i[i[u]]&&r.needProxyHttp&&(f=i[i[u]].replace(n,"$1"+r.urlProxyHandler),i[i[u]]=f),i[i[u]]&&t.push(i[u]+":"+i[i[u]]+";")}function i(n,r,u){for(var f,s,e,o=r.length-1;o>=0;o--)if(f=r[o],f.type===1&&f.selectorText)n.push(f.selectorText+"{"),f.style&&t(n,f.style,u),n.push("}");else if(f.type===f.MEDIA_RULE)n.push("@media "+f.media.mediaText+"{"),i(n,f.cssRules,u),n.push("}");else if(f.type===f.FONT_FACE_RULE)n.push("@font-face {"),f.style&&t(n,f.style,u),n.push("}");else if(f.type===f.KEYFRAMES_RULE){for(n.push("@keyframes "+f.name+"{"),s=f.cssRules.length-1;s>=0;s--)e=f.cssRules[s],e.type===8&&e.keyText&&(n.push(e.keyText+"{"),e.style&&t(n,e.style,u),n.push("}"));n.push("}")}}function u(n,t){n=(n||"").trim().toLowerCase();t=(t||"").trim().toLowerCase();switch(n){case"position":case"left":case"top":case"right":case"bottom":return!0;case"margin-left":case"margin-top":case"margin-rigth":case"margin-bottom":return t.indexOf("-")!==-1;default:return!1}}function f(t,f){function o(n){return f.needProxyHttp?/^data:image\//.test(n)?n:(e.httpProxied=!0,f.urlProxyHandler+encodeURIComponent(n)):n}var e,s;return(r(f),e={html:t,imagesBlocked:!1,sanitized:!1,httpProxied:!1},!t)?e:(window.DOMPurify.addHook("uponSanitizeElement",function(n,t){if(t.tagName==="style"){var r=[];n&&n.sheet&&n.sheet.cssRules&&i(r,n.sheet.cssRules,f);n.textContent=r.join("\n")}else n.className==="MsoNormal"&&n.setAttribute("style","margin: 0cm; margin-bottom: .0001pt")}),window.DOMPurify.addHook("afterSanitizeAttributes",function(t){var l,h,c,i,r,a,s;if(t.hasOwnProperty("target")&&t.setAttribute("target","_blank"),t.hasAttribute("style")){for(l=t.style,h=[],c=l.length-1;c>=0;c--)(i=l[c],r=t.style[i],r&&n.test(r)&&f.needProxyHttp&&(a=r.replace(n,"$1"+f.urlProxyHandler),e.httpProxied=!0,t.style[i]=a),u(i,r))||(f.loadImages||i!=="background-image"&&i!=="background"||(i="tl_disabled_"+i,e.imagesBlocked=!0),h.push(i+":"+r+";"));h.length?t.setAttribute("style",h.join("")):t.removeAttribute("style")}t.hasAttribute("src")&&(f.loadImages||(s=o(t.getAttribute("src")),s&&(t.removeAttribute("src"),t.setAttribute("tl_disabled_src",s),e.imagesBlocked=!0)));t.hasAttribute("background")&&(f.loadImages||(s=o(t.getAttribute("background")),s&&(t.removeAttribute("background"),t.setAttribute("tl_disabled_background",s),e.imagesBlocked=!0)))}),s=window.DOMPurify.sanitize(t,{ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|blob|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,FORBID_TAGS:["style","input","form","title","iframe","meta"],FORBID_ATTR:["srcset","action"]}),e.html=s,e.sanitized=!0,window.DOMPurify.removeHook("afterSanitizeAttributes"),window.DOMPurify.removeHook("uponSanitizeElement"),e)}var n=/(url\("?)(?!data:)/gim;return{Sanitize:function(n,t){try{return f(n,t)}catch(i){var r="Failed ASC.Mail.Sanitizer.Sanitize: {0}".format(i);console.error(r,i);n=r}return{html:n,imagesBlocked:!1,sanitized:!1,httpProxied:!1}}}}());
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
!function(){function i(){}function u(n){return n}function et(n){return!!n}function c(n){return!n}function s(n){return function(){if(null===n)throw new Error("Callback was already called.");n.apply(this,arguments);n=null}}function o(n){return function(){null!==n&&(n.apply(this,arguments),n=null)}}function w(n){return e(n)||"number"==typeof n.length&&n.length>=0&&n.length%1==0}function r(n,t){for(var i=-1,r=n.length;++i<r;)t(n[i],i,n)}function h(n,t){for(var i=-1,r=n.length,u=Array(r);++i<r;)u[i]=t(n[i],i,n);return u}function ot(n){return h(Array(n),function(n,t){return t})}function wt(n,t,i){return r(n,function(n,r,u){i=t(i,n,r,u)}),i}function bt(n,t){r(ut(n),function(i){t(n[i],i)})}function st(n,t){for(var i=0;i<n.length;i++)if(n[i]===t)return i;return-1}function b(n){var i,r,t=-1;return w(n)?(i=n.length,function(){return t++,i>t?t:null}):(r=ut(n),i=r.length,function(){return t++,i>t?r[t]:null})}function t(n,t){return t=null==t?n.length-1:+t,function(){for(var u=Math.max(arguments.length-t,0),r=Array(u),i=0;u>i;i++)r[i]=arguments[i+t];switch(t){case 0:return n.call(this,r);case 1:return n.call(this,arguments[0],r)}}}function k(n){return function(t,i,r){return n(t,r)}}function l(n){return function(t,r,u){var e;if(u=o(u||i),t=t||[],e=b(t),0>=n)return u(null);var h=!1,f=0,c=!1;!function l(){if(h&&0>=f)return u(null);for(;n>f&&!c;){var i=e();if(null===i)return h=!0,void(0>=f&&u(null));f+=1;r(t[i],i,s(function(n){f-=1;n?(u(n),c=!0):l()}))}}()}}function a(t){return function(i,r,u){return t(n.eachOf,i,r,u)}}function d(n){return function(t,i,r,u){return n(l(i),t,r,u)}}function v(t){return function(i,r,u){return t(n.eachOfSeries,i,r,u)}}function g(n,t,r,u){u=o(u||i);t=t||[];var f=w(t)?[]:{};n(t,function(n,t,i){r(n,function(n,r){f[t]=r;i(n)})},function(n){u(n,f)})}function y(n,t,i,r){var u=[];n(t,function(n,t,r){i(n,function(i){i&&u.push({index:t,value:n});r()})},function(){r(h(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function nt(n,t,i,r){y(n,t,function(n,t){i(n,function(n){t(!n)})},r)}function f(n,t,i){return function(r,u,f,e){function o(){e&&e(i(!1,void 0))}function s(n,r,u){return e?void f(n,function(r){e&&t(r)&&(e(i(!0,n)),e=f=!1);u()}):u()}arguments.length>3?n(r,u,s,o):(e=f,f=u,n(r,s,o))}}function tt(n,t){return t}function it(n,r,u){u=u||i;var f=w(r)?[]:{};n(r,function(n,i,r){n(t(function(n,t){t.length<=1&&(t=t[0]);f[i]=t;r(n)}))},function(n){u(n,f)})}function ht(n,t,i,r){var u=[];n(t,function(n,t,r){i(n,function(n,t){u=u.concat(t||[]);r(n)})},function(n){r(n,u)})}function ct(t,u,f){function a(t,u,f,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");return t.started=!0,e(u)||(u=[u]),0===u.length&&t.idle()?n.setImmediate(function(){t.drain()}):(r(u,function(n){var r={data:n,callback:o||i};f?t.tasks.unshift(r):t.tasks.push(r);t.tasks.length===t.concurrency&&t.saturated()}),void n.setImmediate(t.process))}function v(n,t){return function(){c-=1;var i=!1,u=arguments;r(t,function(n){r(l,function(t,r){t!==n||i||(l.splice(r,1),i=!0)});n.callback.apply(n,u)});n.tasks.length+c===0&&n.drain();n.process()}}if(null==u)u=1;else if(0===u)throw new Error("Concurrency must not be zero");var c=0,l=[],o={tasks:[],concurrency:u,payload:f,saturated:i,empty:i,drain:i,started:!1,paused:!1,push:function(n,t){a(o,n,!1,t)},kill:function(){o.drain=i;o.tasks=[]},unshift:function(n,t){a(o,n,!0,t)},process:function(){for(var n,i,r;!o.paused&&c<o.concurrency&&o.tasks.length;)n=o.payload?o.tasks.splice(0,o.payload):o.tasks.splice(0,o.tasks.length),i=h(n,function(n){return n.data}),0===o.tasks.length&&o.empty(),c+=1,l.push(n[0]),r=s(v(o,n)),t(i,r)},length:function(){return o.tasks.length},running:function(){return c},workersList:function(){return l},idle:function(){return o.tasks.length+c===0},pause:function(){o.paused=!0},resume:function(){if(o.paused!==!1){o.paused=!1;for(var i=Math.min(o.concurrency,o.tasks.length),t=1;i>=t;t++)n.setImmediate(o.process)}}};return o}function lt(n){return t(function(i,u){i.apply(null,u.concat([t(function(t,i){"object"==typeof console&&(t?console.error&&console.error(t):console[n]&&r(i,function(t){console[n](t)}))})]))})}function at(n){return function(t,i,r){n(ot(t),i,r)}}function vt(n){return t(function(i,r){var u=t(function(t){var r=this,u=t.pop();return n(i,function(n,i,u){n.apply(r,t.concat([u]))},u)});return r.length?u.apply(this,r):u})}function rt(i){return t(function(t){var u=t.pop(),r;t.push(function(){var t=arguments;r?n.setImmediate(function(){u.apply(null,t)}):u.apply(null,t)});r=!0;i.apply(this,t);r=!1})}var yt,n={},p="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;null!=p&&(yt=p.async);n.noConflict=function(){return p.async=yt,n};var kt=Object.prototype.toString,e=Array.isArray||function(n){return"[object Array]"===kt.call(n)},dt=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},ut=Object.keys||function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t},ft="function"==typeof setImmediate&&setImmediate,pt=ft?function(n){ft(n)}:function(n){setTimeout(n,0)};n.nextTick="object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:pt;n.setImmediate=ft?pt:n.nextTick;n.forEach=n.each=function(t,i,r){return n.eachOf(t,k(i),r)};n.forEachSeries=n.eachSeries=function(t,i,r){return n.eachOfSeries(t,k(i),r)};n.forEachLimit=n.eachLimit=function(n,t,i,r){return l(t)(n,k(i),r)};n.forEachOf=n.eachOf=function(n,t,r){function e(n){f--;n?r(n):null===u&&0>=f&&r(null)}r=o(r||i);n=n||[];for(var u,h=b(n),f=0;null!=(u=h());)f+=1,t(n[u],u,s(e));0===f&&r(null)};n.forEachOfSeries=n.eachOfSeries=function(t,r,u){function e(){var i=!0;return null===f?u(null):(r(t[f],f,s(function(t){if(t)u(t);else{if(f=h(),null===f)return u(null);i?n.setImmediate(e):e()}})),void(i=!1))}u=o(u||i);t=t||[];var h=b(t),f=h();e()};n.forEachOfLimit=n.eachOfLimit=function(n,t,i,r){l(t)(n,i,r)};n.map=a(g);n.mapSeries=v(g);n.mapLimit=d(g);n.inject=n.foldl=n.reduce=function(t,i,r,u){n.eachOfSeries(t,function(n,t,u){r(i,n,function(n,t){i=t;u(n)})},function(n){u(n,i)})};n.foldr=n.reduceRight=function(t,i,r,f){var e=h(t,u).reverse();n.reduce(e,i,r,f)};n.transform=function(t,i,r,u){3===arguments.length&&(u=r,r=i,i=e(t)?[]:{});n.eachOf(t,function(n,t,u){r(i,n,t,u)},function(n){u(n,i)})};n.select=n.filter=a(y);n.selectLimit=n.filterLimit=d(y);n.selectSeries=n.filterSeries=v(y);n.reject=a(nt);n.rejectLimit=d(nt);n.rejectSeries=v(nt);n.any=n.some=f(n.eachOf,et,u);n.someLimit=f(n.eachOfLimit,et,u);n.all=n.every=f(n.eachOf,c,c);n.everyLimit=f(n.eachOfLimit,c,c);n.detect=f(n.eachOf,u,tt);n.detectSeries=f(n.eachOfSeries,u,tt);n.detectLimit=f(n.eachOfLimit,u,tt);n.sortBy=function(t,i,r){function u(n,t){var i=n.criteria,r=t.criteria;return r>i?-1:i>r?1:0}n.map(t,function(n,t){i(n,function(i,r){i?t(i):t(null,{value:n,criteria:r})})},function(n,t){return n?r(n):void r(null,h(t.sort(u),function(n){return n.value}))})};n.auto=function(u,f,s){function y(n){a.unshift(n)}function w(n){var t=st(a,n);t>=0&&a.splice(t,1)}function b(){c--;r(a.slice(0),function(n){n()})}var v,c;if("function"==typeof arguments[1]&&(s=f,f=null),s=o(s||i),v=ut(u),c=v.length,!c)return s(null);f||(f=c);var h={},l=0,p=!1,a=[];y(function(){c||s(null,h)});r(v,function(i){function a(){return f>l&&wt(o,function(n,t){return n&&h.hasOwnProperty(t)},!0)&&!h.hasOwnProperty(i)}function v(){a()&&(l++,w(v),r[r.length-1](k,h))}if(!p){for(var c,r=e(u[i])?u[i]:[u[i]],k=t(function(t,r){if(l--,r.length<=1&&(r=r[0]),t){var u={};bt(h,function(n,t){u[t]=n});u[i]=r;p=!0;s(t,u)}else h[i]=r,n.setImmediate(b)}),o=r.slice(0,r.length-1),d=o.length;d--;){if(!(c=u[o[d]]))throw new Error("Has nonexistent dependency in "+o.join(", "));if(e(c)&&st(c,i)>=0)throw new Error("Has cyclic dependencies");}a()?(l++,r[r.length-1](k,h)):y(v)}})};n.retry=function(t,i,r){function c(n,t){if("number"==typeof t)n.times=parseInt(t,10)||f;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);n.times=parseInt(t.times,10)||f;n.interval=parseInt(t.interval,10)||h}}function s(t,i){function f(n,t){return function(r){n(function(n,i){r(!n||t,{err:n,result:i})},i)}}function o(n){return function(t){setTimeout(function(){t(null)},n)}}for(;u.times;){var r=!(u.times-=1);e.push(f(u.task,r));!r&&u.interval>0&&e.push(o(u.interval))}n.series(e,function(n,i){i=i[i.length-1];(t||u.callback)(i.err,i.result)})}var f=5,h=0,e=[],u={times:f,interval:h},o=arguments.length;if(1>o||o>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=o&&"function"==typeof t&&(r=i,i=t),"function"!=typeof t&&c(u,t),u.callback=r,u.task=i,u.callback?s():s};n.waterfall=function(r,u){function f(n){return t(function(t,i){if(t)u.apply(null,[t].concat(i));else{var r=n.next();r?i.push(f(r)):i.push(u);rt(n).apply(null,i)}})}if(u=o(u||i),!e(r)){var s=new Error("First argument to waterfall must be an array of functions");return u(s)}return r.length?void f(n.iterator(r))():u()};n.parallel=function(t,i){it(n.eachOf,t,i)};n.parallelLimit=function(n,t,i){it(l(t),n,i)};n.series=function(t,i){it(n.eachOfSeries,t,i)};n.iterator=function(n){function t(i){function r(){return n.length&&n[i].apply(null,arguments),r.next()}return r.next=function(){return i<n.length-1?t(i+1):null},r}return t(0)};n.apply=t(function(n,i){return t(function(t){return n.apply(null,i.concat(t))})});n.concat=a(ht);n.concatSeries=v(ht);n.whilst=function(n,r,u){if(u=u||i,n()){var f=t(function(t,i){t?u(t):n.apply(this,i)?r(f):u.apply(null,[null].concat(i))});r(f)}else u(null)};n.doWhilst=function(t,i,r){var u=0;return n.whilst(function(){return++u<=1||i.apply(this,arguments)},t,r)};n.until=function(t,i,r){return n.whilst(function(){return!t.apply(this,arguments)},i,r)};n.doUntil=function(t,i,r){return n.doWhilst(t,function(){return!i.apply(this,arguments)},r)};n.during=function(n,r,u){u=u||i;var e=t(function(t,i){t?u(t):(i.push(f),n.apply(this,i))}),f=function(n,t){n?u(n):t?r(e):u(null)};n(f)};n.doDuring=function(t,i,r){var u=0;n.during(function(n){u++<1?n(null,!0):i.apply(this,arguments)},t,r)};n.queue=function(n,t){return ct(function(t,i){n(t[0],i)},t,1)};n.priorityQueue=function(t,u){function o(n,t){return n.priority-t.priority}function s(n,t,i){for(var f,r=-1,u=n.length-1;u>r;)f=r+(u-r+1>>>1),i(t,n[f])>=0?r=f:u=f-1;return r}function h(t,u,f,h){if(null!=h&&"function"!=typeof h)throw new Error("task callback must be a function");return t.started=!0,e(u)||(u=[u]),0===u.length?n.setImmediate(function(){t.drain()}):void r(u,function(r){var u={data:r,priority:f,callback:"function"==typeof h?h:i};t.tasks.splice(s(t.tasks,u,o)+1,0,u);t.tasks.length===t.concurrency&&t.saturated();n.setImmediate(t.process)})}var f=n.queue(t,u);return f.push=function(n,t,i){h(f,n,t,i)},delete f.unshift,f};n.cargo=function(n,t){return ct(n,1,t)};n.log=lt("log");n.dir=lt("dir");n.memoize=function(i,r){var e={},f={},s=Object.prototype.hasOwnProperty,o;return r=r||u,o=t(function(u){var h=u.pop(),o=r.apply(null,u);s.call(e,o)?n.setImmediate(function(){h.apply(null,e[o])}):s.call(f,o)?f[o].push(h):(f[o]=[h],i.apply(null,u.concat([t(function(n){var i,t,r;for(e[o]=n,i=f[o],delete f[o],t=0,r=i.length;r>t;t++)i[t].apply(null,n)})])))}),o.memo=e,o.unmemoized=i,o};n.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}};n.times=at(n.map);n.timesSeries=at(n.mapSeries);n.timesLimit=function(t,i,r,u){return n.mapLimit(ot(t),i,r,u)};n.seq=function(){var r=arguments;return t(function(u){var e=this,f=u[u.length-1];"function"==typeof f?u.pop():f=i;n.reduce(r,u,function(n,i,r){i.apply(e,n.concat([t(function(n,t){r(n,t)})]))},function(n,t){f.apply(e,[n].concat(t))})})};n.compose=function(){return n.seq.apply(null,Array.prototype.reverse.call(arguments))};n.applyEach=vt(n.eachOf);n.applyEachSeries=vt(n.eachOfSeries);n.forever=function(n,t){function r(n){return n?u(n):void f(r)}var u=s(t||i),f=rt(n);r()};n.ensureAsync=rt;n.constant=t(function(n){var t=[null].concat(n);return function(n){return n.apply(this,t)}});n.wrapSync=n.asyncify=function(n){return t(function(t){var i,r=t.pop();try{i=n.apply(this,t)}catch(u){return r(u)}dt(i)&&"function"==typeof i.then?i.then(function(n){r(null,n)})["catch"](function(n){r(n.message?n:new Error(n))}):r(null,i)})};"object"==typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define([],function(){return n}):p.async=n}();
/*!
 * clipboard.js v1.6.1
 * https://zenorocha.github.io/clipboard.js
 *
 * Licensed MIT © Zeno Rocha
 */
!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;t.Clipboard=n()}}(function(){var n;return function n(t,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!t[f]){if(h="function"==typeof require&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e="function"==typeof require&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){function r(n,t){for(;n&&n.nodeType!==u;){if(n.matches(t))return n;n=n.parentNode}}var u=9,i;"undefined"==typeof Element||Element.prototype.matches||(i=Element.prototype,i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector);t.exports=r},{}],2:[function(n,t){function i(n,t,i,u,f){var e=r.apply(this,arguments);return n.addEventListener(i,e,f),{destroy:function(){n.removeEventListener(i,e,f)}}}function r(n,t,i,r){return function(i){i.delegateTarget=u(i.target,t);i.delegateTarget&&r.call(n,i)}}var u=n("./closest");t.exports=i},{"./closest":1}],3:[function(n,t,i){i.node=function(n){return void 0!==n&&n instanceof HTMLElement&&1===n.nodeType};i.nodeList=function(n){var t=Object.prototype.toString.call(n);return void 0!==n&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in n&&(0===n.length||i.node(n[0]))};i.string=function(n){return"string"==typeof n||n instanceof String};i.fn=function(n){var t=Object.prototype.toString.call(n);return"[object Function]"===t}},{}],4:[function(n,t){function r(n,t,r){if(!n&&!t&&!r)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(r))throw new TypeError("Third argument must be a Function");if(i.node(n))return u(n,t,r);if(i.nodeList(n))return f(n,t,r);if(i.string(n))return e(n,t,r);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");}function u(n,t,i){return n.addEventListener(t,i),{destroy:function(){n.removeEventListener(t,i)}}}function f(n,t,i){return Array.prototype.forEach.call(n,function(n){n.addEventListener(t,i)}),{destroy:function(){Array.prototype.forEach.call(n,function(n){n.removeEventListener(t,i)})}}}function e(n,t,i){return o(document.body,n,t,i)}var i=n("./is"),o=n("delegate");t.exports=r},{"./is":3,delegate:2}],5:[function(n,t){function i(n){var t,r,i,u;return"SELECT"===n.nodeName?(n.focus(),t=n.value):"INPUT"===n.nodeName||"TEXTAREA"===n.nodeName?(r=n.hasAttribute("readonly"),r||n.setAttribute("readonly",""),n.select(),n.setSelectionRange(0,n.value.length),r||n.removeAttribute("readonly"),t=n.value):(n.hasAttribute("contenteditable")&&n.focus(),i=window.getSelection(),u=document.createRange(),u.selectNodeContents(n),i.removeAllRanges(),i.addRange(u),t=i.toString()),t}t.exports=i},{}],6:[function(n,t){function i(){}i.prototype={on:function(n,t,i){var r=this.e||(this.e={});return(r[n]||(r[n]=[])).push({fn:t,ctx:i}),this},once:function(n,t,i){function r(){u.off(n,r);t.apply(i,arguments)}var u=this;return r._=t,this.on(n,r,i)},emit:function(n){var r=[].slice.call(arguments,1),i=((this.e||(this.e={}))[n]||[]).slice(),t=0,u=i.length;for(t;t<u;t++)i[t].fn.apply(i[t].ctx,r);return this},off:function(n,t){var u=this.e||(this.e={}),r=u[n],f=[],i,e;if(r&&t)for(i=0,e=r.length;i<e;i++)r[i].fn!==t&&r[i].fn._!==t&&f.push(r[i]);return f.length?u[n]=f:delete u[n],this}};t.exports=i},{}],7:[function(t,i,r){!function(u,f){if("function"==typeof n&&n.amd)n(["module","select"],f);else if("undefined"!=typeof r)f(i,t("select"));else{var e={exports:{}};f(e,u.select);u.clipboardAction=e.exports}}(this,function(n,t){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var i=r(t),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=function(){function n(t){u(this,n);this.resolveOptions(t);this.initSelection()}return e(n,[{key:"resolveOptions",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=n.action;this.emitter=n.emitter;this.target=n.target;this.text=n.text;this.trigger=n.trigger;this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,r="rtl"==document.documentElement.getAttribute("dir"),n;this.removeFake();this.fakeHandlerCallback=function(){return t.removeFake()};this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[r?"right":"left"]="-9999px";n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;document.body.appendChild(this.fakeElem);this.selectedText=i.default(this.fakeElem);this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null);this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=i.default(this.target);this.copyText()}},{key:"copyText",value:function(){var n=void 0;try{n=document.execCommand(this.action)}catch(t){n=!1}this.handleResult(n)}},{key:"handleResult",value:function(n){this.emitter.emit(n?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.target&&this.target.blur();window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=n,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"');},get:function(){return this._action}},{key:"target",set:function(n){if(void 0!==n){if(!n||"object"!==("undefined"==typeof n?"undefined":f(n))||1!==n.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&n.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(n.hasAttribute("readonly")||n.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=n}},get:function(){return this._target}}]),n}();n.exports=o})},{select:5}],8:[function(t,i,r){!function(u,f){if("function"==typeof n&&n.amd)n(["module","./clipboard-action","tiny-emitter","good-listener"],f);else if("undefined"!=typeof r)f(i,t("./clipboard-action"),t("tiny-emitter"),t("good-listener"));else{var e={exports:{}};f(e,u.clipboardAction,u.tinyEmitter,u.goodListener);u.clipboard=e.exports}}(this,function(n,t,i,r){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function o(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function s(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function f(n,t){var i="data-clipboard-"+n;if(t.hasAttribute(i))return t.getAttribute(i)}var h=u(t),c=u(i),l=u(r),a=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),v=function(n){function t(n,i){e(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.resolveOptions(i),r.listenClick(n),r}return s(t,n),a(t,[{key:"resolveOptions",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof n.action?n.action:this.defaultAction;this.target="function"==typeof n.target?n.target:this.defaultTarget;this.text="function"==typeof n.text?n.text:this.defaultText}},{key:"listenClick",value:function(n){var t=this;this.listener=l.default(n,"click",function(n){return t.onClick(n)})}},{key:"onClick",value:function(n){var t=n.delegateTarget||n.currentTarget;this.clipboardAction&&(this.clipboardAction=null);this.clipboardAction=new h.default({action:this.action(t),target:this.target(t),text:this.text(t),trigger:t,emitter:this})}},{key:"defaultAction",value:function(n){return f("action",n)}},{key:"defaultTarget",value:function(n){var t=f("target",n);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(n){return f("text",n)}},{key:"destroy",value:function(){this.listener.destroy();this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],i="string"==typeof n?[n]:n,t=!!document.queryCommandSupported;return i.forEach(function(n){t=t&&!!document.queryCommandSupported(n)}),t}}]),t}(c.default);n.exports=v})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)});
window.ASC.Clipboard=function(){var n=!1,t=function(){n===!1&&(n=!0);ASC.Clipboard.enable=typeof Clipboard!="undefined"&&Clipboard.isSupported()},i=function(n,t,i){var r,f,u;if(!ASC.Clipboard.enable)return null;if(r={onComplete:null,textareaId:null},jq.extend(r,i),f=r.textareaId?{target:function(){return jq("#"+r.textareaId)[0]}}:{text:function(){return n}},u=new Clipboard("#"+t,f),r.onComplete)u.on("success",r.onComplete);return u},r=function(n,t,i){if(!ASC.Clipboard.enable)return null;var r=new Clipboard(n,t);if(i)r.on("success",i);return r},u=function(n){return n&&n.destroy(),null};return{init:t,enable:!1,create:i,createManually:r,destroy:u}}(),function(n){n(function(){ASC.Clipboard.init()})}(jQuery);
(function(n){"use strict";function t(n){function ot(){return p<hi}function ci(){return g[p]}function nt(){return p}function tt(n){p=n}function li(){p+=1}function wt(){p=0;hi=g.length}function w(n,t){return{name:n,tokens:t||"",semantic:t||"",children:[]}}function t(n,t){var i;return t===null?null:(i=w(n),i.tokens=t.tokens,i.semantic=t.semantic,i.children.push(t),i)}function st(n,t){return t!==null&&(n.tokens+=t.tokens,n.semantic+=t.semantic),n.children.push(t),n}function l(n){var t;return ot()?(t=ci(),n(t))?(li(),w("token",t)):null:null}function u(n){return function(){return t("literal",l(function(t){return t===n}))}}function r(){var n=arguments;return function(){var t,i,r,u;for(u=nt(),i=w("and"),t=0;t<n.length;t+=1){if(r=n[t](),r===null)return tt(u),null;st(i,r)}return i}}function e(){var n=arguments;return function(){for(var i,r=nt(),t=0;t<n.length;t+=1){if(i=n[t](),i!==null)return i;tt(r)}return null}}function f(n){return function(){var t,i;return i=nt(),t=n(),t!==null?t:(tt(i),w("opt"))}}function o(n){return function(){var t=n();return t!==null&&(t.semantic=""),t}}function it(n){return function(){var t=n();return t!==null&&t.semantic.length>0&&(t.semantic=" "),t}}function s(n,t){return function(){var r,u,i,f,e;for(f=nt(),r=w("star"),i=0,e=t===undefined?0:t;(u=n())!==null;)i=i+1,st(r,u);return i>=e?r:(tt(f),null)}}function ai(n){return n.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}function b(n){return n.charCodeAt(0)>=128}function bt(){return t("cr",u("\r")())}function kt(){return t("crlf",r(bt,gt)())}function dt(){return t("dquote",u('"')())}function vi(){return t("htab",u("\t")())}function gt(){return t("lf",u("\n")())}function yi(){return t("sp",u(" ")())}function pi(){return t("vchar",l(function(t){var r=t.charCodeAt(0),i=33<=r&&r<=126;return n.rfc6532&&(i=i||b(t)),i}))}function rt(){return t("wsp",e(yi,vi)())}function ht(){var n=t("quoted-pair",e(r(u("\\"),e(pi,rt)),lr)());return n===null?null:(n.semantic=n.semantic[1],n)}function c(){return t("fws",e(vr,r(f(r(s(rt),o(kt))),s(rt,1)))())}function wi(){return t("ctext",e(function(){return l(function(t){var i=t.charCodeAt(0),r=33<=i&&i<=39||42<=i&&i<=91||93<=i&&i<=126;return n.rfc6532&&(r=r||b(t)),r})},hr)())}function bi(){return t("ccontent",e(wi,ht,ni)())}function ni(){return t("comment",r(u("("),s(r(f(c),bi)),f(c),u(")"))())}function h(){return t("cfws",e(r(s(r(f(c),ni),1),f(c)),c)())}function ct(){return t("atext",l(function(t){var i="a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(t)>=0;return n.rfc6532&&(i=i||b(t)),i}))}function lt(){return t("atom",r(it(f(h)),s(ct,1),it(f(h)))())}function ki(){var n,i;return(n=t("dot-atom-text",s(ct,1)()),n===null)?n:(i=s(r(u("."),s(ct,1)))(),i!==null&&st(n,i),n)}function ti(){return t("dot-atom",r(o(f(h)),ki,o(f(h)))())}function di(){return t("qtext",e(function(){return l(function(t){var i=t.charCodeAt(0),r=33===i||35<=i&&i<=91||93<=i&&i<=126;return n.rfc6532&&(r=r||b(t)),r})},cr)())}function gi(){return t("qcontent",e(di,ht)())}function ii(){return t("quoted-string",r(o(f(h)),o(dt),s(r(f(it(c)),gi)),f(o(c)),o(dt),o(f(h)))())}function k(){return t("word",e(lt,ii)())}function nr(){return t("phrase",e(ar,s(k,1))())}function v(){return t("address",e(a,ui)())}function a(){return t("mailbox",e(tr,yt)())}function tr(){return t("name-addr",r(f(fi),ri)())}function ri(){return t("angle-addr",e(r(o(f(h)),u("<"),yt,u(">"),o(f(h))),yr)())}function ui(){return t("group",r(fi,u(":"),f(ir),u(";"),o(f(h)))())}function fi(){return t("display-name",function(){var n=nr();return n!==null&&(n.semantic=ai(n.semantic)),n}())}function at(){return t("mailbox-list",e(r(a,s(r(u(","),a))),br)())}function ut(){return t("address-list",e(r(v,s(r(u(","),v))),kr)())}function ir(){return t("group-list",e(at,o(h),dr)())}function rr(){return t("local-part",e(gr,ti,ii)())}function ur(){return t("dtext",e(function(){return l(function(t){var i=t.charCodeAt(0),r=33<=i&&i<=90||94<=i&&i<=126;return n.rfc6532&&(r=r||b(t)),r})},tu)())}function fr(){return t("domain-literal",r(o(f(h)),u("["),s(r(f(c),ur)),f(c),u("]"),o(f(h)))())}function vt(){return t("domain",function(){var t=e(nu,ti,fr)();return n.rejectTLD&&t&&t.semantic&&t.semantic.indexOf(".")<0?null:(t&&(t.semantic=t.semantic.replace(/\s+/g,"")),t)}())}function yt(){return t("addr-spec",r(rr,u("@"),vt)())}function er(){return t("from",e(at,ut)())}function or(){return t("sender",e(a,v)())}function sr(){return t("reply-to",ut())}function ft(){return n.strict?null:t("obs-NO-WS-CTL",l(function(n){var t=n.charCodeAt(0);return 1<=t&&t<=8||11===t||12===t||14<=t&&t<=31||127===t}))}function hr(){return n.strict?null:t("obs-ctext",ft())}function cr(){return n.strict?null:t("obs-qtext",ft())}function lr(){return n.strict?null:t("obs-qp",r(u("\\"),e(u('\0'),ft,gt,bt))())}function ar(){return n.strict?null:t("obs-phrase",r(k,s(e(k,u("."),it(h))))())}function vr(){return n.strict?null:t("obs-FWS",s(r(o(f(kt)),rt),1)())}function yr(){return n.strict?null:t("obs-angle-addr",r(o(f(h)),u("<"),pr,yt,u(">"),o(f(h)))())}function pr(){return n.strict?null:t("obs-route",r(wr,u(":"))())}function wr(){return n.strict?null:t("obs-domain-list",r(s(e(o(h),u(","))),u("@"),vt,s(r(u(","),o(f(h)),f(r(u("@"),vt)))))())}function br(){return n.strict?null:t("obs-mbox-list",r(s(r(o(f(h)),u(","))),a,s(r(u(","),f(r(a,o(h))))))())}function kr(){return n.strict?null:t("obs-addr-list",r(s(r(o(f(h)),u(","))),v,s(r(u(","),f(r(v,o(h))))))())}function dr(){return n.strict?null:t("obs-group-list",r(s(r(o(f(h)),u(",")),1),o(f(h)))())}function gr(){return n.strict?null:t("obs-local-part",r(k,s(r(u("."),k)))())}function nu(){return n.strict?null:t("obs-domain",r(lt,s(r(u("."),lt)))())}function tu(){return n.strict?null:t("obs-dtext",e(ft,ht)())}function d(n,t){var r,u,i;if(t===null||t===undefined)return null;for(u=[t];u.length>0;){if(i=u.pop(),i.name===n)return i;for(r=i.children.length-1;r>=0;r-=1)u.push(i.children[r])}return null}function iu(n,t){var r,u,i,f;if(t===null||t===undefined)return null;for(u=[t],f=[];u.length>0;)for(i=u.pop(),i.name===n&&f.push(i),r=i.children.length-1;r>=0;r-=1)u.push(i.children[r]);return f}function ei(n,t){var i,u,r,f,e;if(t===null||t===undefined)return null;for(u=[t],f=[],e={},i=0;i<n.length;i+=1)e[n[i]]=!0;while(u.length>0)if(r=u.pop(),r.name in e)f.push(r);else for(i=r.children.length-1;i>=0;i-=1)u.push(r.children[i]);return f}function oi(t){var u,e,f,r,i;if(t===null)return null;for(u=[],e=ei(["group","mailbox"],t),f=0;f<e.length;f+=1)r=e[f],r.name==="group"?u.push(ru(r)):r.name==="mailbox"&&u.push(si(r));return(i={ast:t,addresses:u},n.simple&&(i=uu(i)),n.oneResult)?fu(i):n.simple?i&&i.addresses:i}function ru(n){for(var i=d("display-name",n),r=[],u=ei(["mailbox"],n),t=0;t<u.length;t+=1)r.push(si(u[t]));return{node:n,parts:{name:i},type:n.name,name:y(i),addresses:r}}function si(n){var i=d("display-name",n),t=d("addr-spec",n),f=iu("cfws",n),r=d("local-part",t),u=d("domain",t);return{node:n,parts:{name:i,address:t,local:r,domain:u,comments:f},type:n.name,name:y(i),address:y(t),local:y(r),domain:y(u),groupName:y(n.groupName)}}function y(n){return n!==null&&n!==undefined?n.semantic:null}function uu(n){var t;if(n&&n.addresses)for(t=0;t<n.addresses.length;t+=1)delete n.addresses[t].node;return n}function fu(t){return t?!n.partial&&t.addresses.length>1?null:t.addresses&&t.addresses[0]:null}var g,p,hi,et,pt;if(n=i(n,{}),n===null)return null;if(g=n.input,pt={address:v,"address-list":ut,"angle-addr":ri,from:er,group:ui,mailbox:a,"mailbox-list":at,"reply-to":sr,sender:or}[n.startAt]||ut,!n.strict){if(wt(),n.strict=!0,et=pt(g),n.partial||!ot())return oi(et);n.strict=!1}return(wt(),et=pt(g),!n.partial&&ot())?null:oi(et)}function r(n){return t(i(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))}function u(n){return t(i(n,{rfc6532:!0,simple:!0,startAt:"address-list"}))}function f(n){return t(i(n,{rfc6532:!0,simple:!0,startAt:"from"}))}function e(n){return t(i(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))}function o(n){return t(i(n,{rfc6532:!0,simple:!0,startAt:"reply-to"}))}function i(n,t){function u(n){return Object.prototype.toString.call(n)==="[object String]"}function e(n){return n===Object(n)}function f(n){return n===null||n===undefined}var r,i;if(u(n))n={input:n};else if(!e(n))return null;if(!u(n.input)||!t)return null;r={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1};for(i in r)f(n[i])&&(n[i]=f(t[i])?r[i]:t[i]);return n}t.parseOneAddress=r;t.parseAddressList=u;t.parseFrom=f;t.parseSender=e;t.parseReplyTo=o;typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=t:n.emailAddresses=t})(this);
/*! https://mths.be/punycode v1.4.1 by @mathias */
!function(n){function r(n){throw new RangeError(at[n]);}function v(n,t){for(var i=n.length,r=[];i--;)r[i]=t(n[i]);return r}function y(n,t){var i=n.split("@"),r="",u,f;return i.length>1&&(r=i[0]+"@",n=i[1]),n=n.replace(lt,"."),u=n.split("."),f=v(u,t).join("."),r+f}function p(n){for(var t,u,r=[],i=0,f=n.length;f>i;)t=n.charCodeAt(i++),t>=55296&&56319>=t&&f>i?(u=n.charCodeAt(i++),56320==(64512&u)?r.push(((1023&t)<<10)+(1023&u)+65536):(r.push(t),i--)):r.push(t);return r}function w(n){return v(n,function(n){var t="";return n>65535&&(n-=65536,t+=s(n>>>10&1023|55296),n=56320|1023&n),t+s(n)}).join("")}function ut(n){return 10>n-48?n-22:26>n-65?n-65:26>n-97?n-97:t}function b(n,t){return n+22+75*(26>n)-((0!=t)<<5)}function k(n,r,u){var f=0;for(n=u?i(n/st):n>>1,n+=i(n/r);n>a*o>>1;f+=t)n=i(n/a);return i(f+(a+1)*n/(n+ot))}function d(n){var s,f,h,y,d,c,a,v,g,nt,p=[],et=n.length,u=0,ft=it,b=tt;for(f=n.lastIndexOf(rt),0>f&&(f=0),h=0;f>h;++h)n.charCodeAt(h)>=128&&r("not-basic"),p.push(n.charCodeAt(h));for(y=f>0?f+1:0;et>y;){for(d=u,c=1,a=t;y>=et&&r("invalid-input"),v=ut(n.charCodeAt(y++)),(v>=t||v>i((e-u)/c))&&r("overflow"),u+=v*c,g=b>=a?l:a>=b+o?o:a-b,!(g>v);a+=t)nt=t-g,c>i(e/nt)&&r("overflow"),c*=nt;s=p.length+1;b=k(u-d,s,0==d);i(u/s)>e-ft&&r("overflow");ft+=i(u/s);u%=s;p.splice(u++,0,ft)}return w(p)}function g(n){var h,c,y,et,w,u,a,d,g,nt,f,ut,ft,ot,st,v=[];for(n=p(n),ut=n.length,h=it,c=0,w=tt,u=0;ut>u;++u)f=n[u],128>f&&v.push(s(f));for(y=et=v.length,et&&v.push(rt);ut>y;){for(a=e,u=0;ut>u;++u)f=n[u],f>=h&&a>f&&(a=f);for(ft=y+1,a-h>i((e-c)/ft)&&r("overflow"),c+=(a-h)*ft,h=a,u=0;ut>u;++u)if(f=n[u],h>f&&++c>e&&r("overflow"),f==h){for(d=c,g=t;nt=w>=g?l:g>=w+o?o:g-w,!(nt>d);g+=t)st=d-nt,ot=t-nt,v.push(s(b(nt+st%ot,0))),d=i(st/ot);v.push(s(b(d,0)));w=k(c,ft,y==et);c=0;++y}++c;++h}return v.join("")}function ft(n){return y(n,function(n){return ht.test(n)?d(n.slice(4).toLowerCase()):n})}function et(n){return y(n,function(n){return ct.test(n)?"xn--"+g(n):n})}var c="object"==typeof exports&&exports&&!exports.nodeType&&exports,nt="object"==typeof module&&module&&!module.nodeType&&module,u="object"==typeof global&&global;(u.global===u||u.window===u||u.self===u)&&(n=u);var f,h,e=2147483647,t=36,l=1,o=26,ot=38,st=700,tt=72,it=128,rt="-",ht=/^xn--/,ct=/[^\x20-\x7E]/,lt=/[\x2E\u3002\uFF0E\uFF61]/g,at={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},a=t-l,i=Math.floor,s=String.fromCharCode;if(f={version:"1.4.1",ucs2:{decode:p,encode:w},decode:d,encode:g,toASCII:et,toUnicode:ft},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return f});else if(c&&nt)if(module.exports==c)nt.exports=f;else for(h in f)f.hasOwnProperty(h)&&(c[h]=f[h]);else n.punycode=f}(this);
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.DOMPurify=t()}(this,function(){"use strict";function n(n,t){var r,i,u;for(d&&d(n,null),r=t.length;r--;)i=t[r],"string"==typeof i&&(u=i.toLowerCase(),u!==i&&(Object.isFrozen(t)||(t[r]=u),i=u)),n[i]=!0;return n}function c(n){var i={};for(var t in n)s(tt,n,[t])&&(i[t]=n[t]);return i}function t(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function l(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct(),i=function(n){return l(n)},ni;if(i.version="1.0.10",i.removed=[],!r||!r.document||9!==r.document.nodeType)return i.isSupported=!1,i;var ui=r.document,ki=!1,di=!1,at=r.document,gi=r.DocumentFragment,wr=r.HTMLTemplateElement,dt=r.Node,gt=r.NodeFilter,nr=r.NamedNodeMap,br=void 0===nr?r.NamedNodeMap||r.MozNamedAttrMap:nr,kr=r.Text,dr=r.Comment,gr=r.DOMParser,nu=r.TrustedTypes;"function"==typeof wr&&(ni=at.createElement("template"),ni.content&&ni.content.ownerDocument&&(at=ni.content.ownerDocument));var d=nt(nu,ui),tr=d?d.createHTML(""):"",ti=at,fi=ti.implementation,tu=ti.createNodeIterator,iu=ti.getElementsByTagName,ru=ti.createDocumentFragment,uu=ui.importNode,tt={};i.isSupported=fi&&void 0!==fi.createHTMLDocument&&9!==at.documentMode;var ei=it,oi=rt,fu=ut,eu=ft,ou=ot,ir=st,si=et,f=null,rr=n({},[].concat(t(a),t(v),t(y),t(p),t(w))),s=null,ur=n({},[].concat(t(b),t(o),t(k),t(e))),hi=null,ci=null,fr=!0,li=!0,er=!1,or=!1,vt=!1,wt=!1,ai=!1,vi=!1,bt=!1,yi=!1,sr=!1,hr=!0,pi=!0,ii=!1,yt={},su=n({},["audio","head","math","script","style","template","svg","video"]),hu=n({},["audio","video","img","source","image"]),cr=n({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),pt=null,cu=at.createElement("form"),wi=function(i){pt&&pt===i||(i&&"object"===(void 0===i?"undefined":u(i))||(i={}),f="ALLOWED_TAGS"in i?n({},i.ALLOWED_TAGS):rr,s="ALLOWED_ATTR"in i?n({},i.ALLOWED_ATTR):ur,hi="FORBID_TAGS"in i?n({},i.FORBID_TAGS):{},ci="FORBID_ATTR"in i?n({},i.FORBID_ATTR):{},yt="USE_PROFILES"in i&&i.USE_PROFILES,fr=!1!==i.ALLOW_ARIA_ATTR,li=!1!==i.ALLOW_DATA_ATTR,er=i.ALLOW_UNKNOWN_PROTOCOLS||!1,or=i.SAFE_FOR_JQUERY||!1,vt=i.SAFE_FOR_TEMPLATES||!1,wt=i.WHOLE_DOCUMENT||!1,bt=i.RETURN_DOM||!1,yi=i.RETURN_DOM_FRAGMENT||!1,sr=i.RETURN_DOM_IMPORT||!1,vi=i.FORCE_BODY||!1,hr=!1!==i.SANITIZE_DOM,pi=!1!==i.KEEP_CONTENT,ii=i.IN_PLACE||!1,si=i.ALLOWED_URI_REGEXP||si,vt&&(li=!1),yi&&(bt=!0),yt&&(f=n({},[].concat(t(w))),s=[],!0===yt.html&&(n(f,a),n(s,b)),!0===yt.svg&&(n(f,v),n(s,o),n(s,e)),!0===yt.svgFilters&&(n(f,y),n(s,o),n(s,e)),!0===yt.mathMl&&(n(f,p),n(s,k),n(s,e))),i.ADD_TAGS&&(f===rr&&(f=c(f)),n(f,i.ADD_TAGS)),i.ADD_ATTR&&(s===ur&&(s=c(s)),n(s,i.ADD_ATTR)),i.ADD_URI_SAFE_ATTR&&n(cr,i.ADD_URI_SAFE_ATTR),pi&&(f["#text"]=!0),wt&&n(f,["html","head","body"]),f.table&&n(f,["tbody"]),g&&g(i),pt=i)},kt=function(n){i.removed.push({element:n});try{n.parentNode.removeChild(n)}catch(t){n.outerHTML=tr}},bi=function(n,t){try{i.removed.push({attribute:t.getAttributeNode(n),from:t})}catch(n){i.removed.push({attribute:null,from:t})}t.removeAttribute(n)},ri=function(t){var i=void 0,r=void 0,f,u;if(vi?t="<remove><\/remove>"+t:(f=t.match(/^[\s]+/),(r=f&&f[0])&&(t=t.slice(r.length))),ki)try{i=(new gr).parseFromString(t,"text/html")}catch(n){}return(di&&n(hi,["title"]),i&&i.documentElement)||(u=(i=fi.createHTMLDocument("")).body,u.parentNode.removeChild(u.parentNode.firstElementChild),u.outerHTML=d?d.createHTML(t):t),r&&i.body.insertBefore(at.createTextNode(r),i.body.childNodes[0]||null),iu.call(i,wt?"html":"body")[0]};i.isSupported&&(function(){try{ri('<svg><p><style><img src="<\/style><img src=x onerror=1//">').querySelector("svg img")&&(ki=!0)}catch(n){}}(),function(){try{ri("<x/><title>&lt;/title&gt;&lt;img&gt;").querySelector("title").innerHTML.match(/<\/title/)&&(di=!0)}catch(n){}}());var lr=function(n){return tu.call(n.ownerDocument||n,n,gt.SHOW_ELEMENT|gt.SHOW_COMMENT|gt.SHOW_TEXT,function(){return gt.FILTER_ACCEPT},!1)},lu=function(n){return!(n instanceof kr||n instanceof dr)&&!("string"==typeof n.nodeName&&"string"==typeof n.textContent&&"function"==typeof n.removeChild&&n.attributes instanceof br&&"function"==typeof n.removeAttribute&&"function"==typeof n.setAttribute)},ar=function(n){return"object"===(void 0===dt?"undefined":u(dt))?n instanceof dt:n&&"object"===(void 0===n?"undefined":u(n))&&"number"==typeof n.nodeType&&"string"==typeof n.nodeName},lt=function(n,t,r){tt[n]&&tt[n].forEach(function(n){n.call(i,t,r,pt)})},vr=function(n){var r=void 0,t,u;if(lt("beforeSanitizeElements",n,null),lu(n))return kt(n),!0;if(t=n.nodeName.toLowerCase(),lt("uponSanitizeElement",n,{tagName:t,allowedTags:f}),!f[t]||hi[t]){if(pi&&!su[t]&&"function"==typeof n.insertAdjacentHTML)try{u=n.innerHTML;n.insertAdjacentHTML("AfterEnd",d?d.createHTML(u):u)}catch(n){}return kt(n),!0}return"noscript"===t&&n.innerHTML.match(/<\/noscript/i)?(kt(n),!0):"noembed"===t&&n.innerHTML.match(/<\/noembed/i)?(kt(n),!0):(!or||n.firstElementChild||n.content&&n.content.firstElementChild||!/</g.test(n.textContent)||(i.removed.push({element:n.cloneNode()}),n.innerHTML=n.innerHTML?n.innerHTML.replace(/</g,"&lt;"):n.textContent.replace(/</g,"&lt;")),vt&&3===n.nodeType&&(r=(r=(r=n.textContent).replace(ei," ")).replace(oi," "),n.textContent!==r&&(i.removed.push({element:n.cloneNode()}),n.textContent=r)),lt("afterSanitizeElements",n,null),!1)},yr=function(n,t,i){return hr&&("id"===t||"name"===t)&&(i in at||i in cu)?!1:(!li||!fu.test(t))&&(!fr||!eu.test(t))&&(!s[t]||ci[t]||!cr[t]&&!si.test(i.replace(ir,""))&&("src"!==t&&"xlink:href"!==t||"script"===n||0!==i.indexOf("data:")||!hu[n])&&(!er||ou.test(i.replace(ir,"")))&&i)?!1:!0},pr=function(n){var l=void 0,t=void 0,u=void 0,c=void 0,o=void 0,r,f,y;if(lt("beforeSanitizeAttributes",n,null),r=n.attributes,r){for(f={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:s},o=r.length;o--;){var a=l=r[o],e=a.name,v=a.namespaceURI;if(t=l.value.trim(),u=e.toLowerCase(),f.attrName=u,f.attrValue=t,f.keepAttr=!0,lt("uponSanitizeAttribute",n,f),t=f.attrValue,"name"===u&&"IMG"===n.nodeName&&r.id)c=r.id,r=h(ht,r,[]),bi("id",n),bi(e,n),r.indexOf(c)>o&&n.setAttribute("id",c.value);else{if("INPUT"===n.nodeName&&"type"===u&&"file"===t&&(s[u]||!ci[u]))continue;"id"===e&&n.setAttribute(e,"");bi(e,n)}if(f.keepAttr&&(vt&&(t=(t=t.replace(ei," ")).replace(oi," ")),y=n.nodeName.toLowerCase(),yr(y,u,t)))try{v?n.setAttributeNS(v,e,t):n.setAttribute(e,t);i.removed.pop()}catch(n){}}lt("afterSanitizeAttributes",n,null)}},au=function n(t){var i=void 0,r=lr(t);for(lt("beforeSanitizeShadowDOM",t,null);i=r.nextNode();)lt("uponSanitizeShadowNode",i,null),vr(i)||(i.content instanceof gi&&n(i.content),pr(i));lt("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(n,t){var f=void 0,h=void 0,e=void 0,c=void 0,o=void 0,l,s;if(n||(n="<!-->"),"string"!=typeof n&&!ar(n)){if("function"!=typeof n.toString)throw new TypeError("toString is not a function");if("string"!=typeof(n=n.toString()))throw new TypeError("dirty is not a string, aborting");}if(!i.isSupported){if("object"===u(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof n)return r.toStaticHTML(n);if(ar(n))return r.toStaticHTML(n.outerHTML)}return n}if(ai||wi(t),i.removed=[],!ii)if(n instanceof dt)1===(h=(f=ri("<!-->")).ownerDocument.importNode(n,!0)).nodeType&&"BODY"===h.nodeName?f=h:f.appendChild(h);else{if(!bt&&!vt&&!wt&&-1===n.indexOf("<"))return d?d.createHTML(n):n;if(!(f=ri(n)))return bt?null:tr}for(f&&vi&&kt(f.firstChild),l=lr(ii?n:f);e=l.nextNode();)3===e.nodeType&&e===c||vr(e)||(e.content instanceof gi&&au(e.content),pr(e),c=e);if(c=null,ii)return n;if(bt){if(yi)for(o=ru.call(f.ownerDocument);f.firstChild;)o.appendChild(f.firstChild);else o=f;return sr&&(o=uu.call(ui,o,!0)),o}return s=wt?f.outerHTML:f.innerHTML,vt&&(s=(s=s.replace(ei," ")).replace(oi," ")),d?d.createHTML(s):s},i.setConfig=function(n){wi(n);ai=!0},i.clearConfig=function(){pt=null;ai=!1},i.isValidAttribute=function(n,t,i){pt||wi({});var r=n.toLowerCase(),u=t.toLowerCase();return yr(r,u,i)},i.addHook=function(n,t){"function"==typeof t&&(tt[n]=tt[n]||[],tt[n].push(t))},i.removeHook=function(n){tt[n]&&tt[n].pop()},i.removeHooks=function(n){tt[n]&&(tt[n]=[])},i.removeAllHooks=function(){tt={}},i}var r=Object.freeze||function(n){return n},a=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),v=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),y=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),p=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),w=r(["#text"]),f=Object.freeze||function(n){return n},b=f(["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"]),o=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),k=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),e=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),tt=Object.hasOwnProperty,d=Object.setPrototypeOf,s=("undefined"!=typeof Reflect&&Reflect).apply,nt;s||(s=function(n,t,i){return n.apply(t,i)});var i=Object.seal||function(n){return n},it=i(/\{\{[\s\S]*|[\s\S]*\}\}/gm),rt=i(/<%[\s\S]*|[\s\S]*%>/gm),ut=i(/^data-[\-\w.\u00B7-\uFFFF]/),ft=i(/^aria-[\-\w]+$/),et=i(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ot=i(/^(?:\w+script|data):/i),st=i(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},h=("undefined"!=typeof Reflect&&Reflect).apply,ht=Array.prototype.slice,g=Object.freeze,ct=function(){return"undefined"==typeof window?null:window};return h||(h=function(n,t,i){return n.apply(t,i)}),nt=function(n,t){var i,r;if("object"!==(void 0===n?"undefined":u(n))||"function"!=typeof n.createPolicy)return null;i=null;t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")&&(i=t.currentScript.getAttribute("data-tt-policy-suffix"));r="dompurify"+(i?"#"+i:"");try{return n.createPolicy(r,{createHTML:function(n){return n}})}catch(n){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},l()});
ASC.Controls.MailReader=function(){function n(n){n&&n.skipIO||r(!1)}function t(){r(!0)}function r(n){try{i&&i.emit("updateFolders",n)}catch(t){console.error(t.message)}}function u(n){var t,i;n=parseInt(n);StudioManager.getCurrentModule()!=="mail"&&(t=jq("#TPUnreadMessagesCount"),t&&(t.text(n>100?">100":n),t.parent().toggleClass("has-led",n!==0)));i=localStorageManager.getItem("MailUreadMessagesCount");i!==n&&localStorageManager.setItem("MailUreadMessagesCount",n)}function e(n,t){t.length&&u(t[0].unread_messages)}function o(n){n&&n.key&&n.key==="MailUreadMessagesCount"&&u(n.newValue)}function s(){ASC.SocketIO&&!ASC.SocketIO.disabled()?(i=ASC.SocketIO.Factory.counters,i.connect(function(){h()}).reconnect_failed(function(){f()})):f()}function h(){Teamlab.bind(Teamlab.events.getMailConversation,n);Teamlab.bind(Teamlab.events.getNextMailConversationId,n);Teamlab.bind(Teamlab.events.getPrevMailConversationId,n);Teamlab.bind(Teamlab.events.getMailMessage,n);Teamlab.bind(Teamlab.events.getNextMailMessageId,n);Teamlab.bind(Teamlab.events.getPrevMailMessageId,n);Teamlab.bind(Teamlab.events.removeMailFolderMessages,n);Teamlab.bind(Teamlab.events.restoreMailMessages,n);Teamlab.bind(Teamlab.events.moveMailMessages,n);Teamlab.bind(Teamlab.events.removeMailMessages,n);Teamlab.bind(Teamlab.events.markMailMessages,n);Teamlab.bind(Teamlab.events.setMailTag,n);Teamlab.bind(Teamlab.events.setMailConversationsTag,n);Teamlab.bind(Teamlab.events.unsetMailTag,n);Teamlab.bind(Teamlab.events.unsetMailConversationsTag,n);Teamlab.bind(Teamlab.events.createMailMailboxSimple,t);Teamlab.bind(Teamlab.events.createMailMailboxOAuth,t);Teamlab.bind(Teamlab.events.updateMailMailboxOAuth,t);Teamlab.bind(Teamlab.events.createMailMailbox,t);Teamlab.bind(Teamlab.events.removeMailMailbox,t);Teamlab.bind(Teamlab.events.addMailbox,t);Teamlab.bind(Teamlab.events.removeMailbox,t);Teamlab.bind(Teamlab.events.updateMailbox,t);Teamlab.bind(Teamlab.events.addMailBoxAlias,t);Teamlab.bind(Teamlab.events.removeMailBoxAlias,t);Teamlab.bind(Teamlab.events.addMailGroup,t);Teamlab.bind(Teamlab.events.removeMailGroup,t);Teamlab.bind(Teamlab.events.removeMailDomain,t);Teamlab.bind(Teamlab.events.setDefaultAccount,t);Teamlab.bind(Teamlab.events.sendMailMessage,n);Teamlab.bind(Teamlab.events.saveMailMessage,n);Teamlab.bind(Teamlab.events.saveMailTemplate,n);Teamlab.bind(Teamlab.events.moveMailConversations,n);Teamlab.bind(Teamlab.events.restoreMailConversations,n);Teamlab.bind(Teamlab.events.removeMailConversations,n);Teamlab.bind(Teamlab.events.markMailConversations,n)}function f(){StudioManager.getCurrentModule()!=="mail"&&(Teamlab.bind(Teamlab.events.getMailFolders,e),localStorageManager.isAvailable&&window.addEvent(window,"storage",o))}var i;return{updateFoldersOnOtherTabs:r,setUnreadMailMessagesCount:u,mailStart:s}}();jq(document).ready(function(){jq("#studioPageContent li.mail a.mailActiveBox").length>0&&ASC.Controls.MailReader.mailStart()});
var VideoSaver=new function(){this.Init=function(){if(jq("#dropVideoList li a").length!=0){jq(".menu-list .video-guides").find(".new-label-menu").text(jq("#dropVideoList li a").length).show();jq("#studio_videoPopupPanel").appendTo("main");jq.dropdownToggle({switcherSelector:".menu-list .video-guides .new-label-menu",dropdownID:"studio_videoPopupPanel",addTop:5,addLeft:0});jq("#dropVideoList li a").on("click",function(){AjaxPro.timeoutPeriod=18e5;UserVideoGuideUsage.SaveWatchVideo([jq(this).attr("id")])});jq("#markVideoRead").on("click",function(){var n=[];jq("#dropVideoList li a").each(function(){n.push(jq(this).attr("id"))});AjaxPro.timeoutPeriod=18e5;UserVideoGuideUsage.SaveWatchVideo(n);jq("#studio_videoPopupPanel").hide();jq(".menu-list .video-guides").find(".new-label-menu").hide()})}}};jq(document).ready(function(){VideoSaver.Init()});
typeof ASC=="undefined"&&(ASC={});typeof ASC.Feed=="undefined"&&(ASC.Feed={});ASC.Feed=function(){function t(n,t,i){var r={createdText:n,location:t};return typeof i!="undefined"&&(r.commentedText=i),r}var n=ASC.Resources.Master.FeedResource;return jq.extend({Products:{community:n.CommunityProduct,people:n.PeopleProduct,projects:n.ProjectsProduct,crm:n.CrmProduct,documents:n.DocumentsProduct},Texts:{birthday:t(null,n.Birthdays),newEmployee:t(null,n.NewEmployee),blog:t(n.BlogCreatedText,n.BlogsModule,n.BlogCommentedText),bookmark:t(n.BookmarkCreatedText,n.BookmarksModule,n.BookmarkCommentedText),news:t(n.NewsCreatedText,n.EventsModule,n.NewsCommentedText),order:t(n.OrderCreatedText,n.EventsModule,n.OrderCommentedText),advert:t(n.AdvertCreatedText,n.EventsModule,n.AdvertCommentedText),poll:t(n.PollCreatedText,n.EventsModule,n.PollCommentedText),forumPost:t(n.ForumPostCreatedText,n.ForumsModule),forumTopic:t(n.ForumTopicCreatedText,n.ForumsModule),forumPoll:t(n.ForumPollCreatedText,n.ForumsModule),company:t(n.CompanyCreatedText,n.ContactsModule),person:t(n.PersonCreatedText,n.ContactsModule),crmTask:{createdText:n.CrmTaskCreatedText,extraText:n.Responsible,extraText2:n.Contact,location:n.CrmTaskModule},deal:{createdText:n.DealCreatedText,extraText2:n.Contact,location:n.OpportunitiesModule},cases:t(n.CaseCreatedText,n.CasesModule),project:{createdText:n.ProjectCreatedText,extraText:n.ProjectManager},participant:{createdText:n.ParticipantCreatedText},milestone:{createdText:n.MilestoneCreatedText,extraText:n.Project,location:n.MilestonesModule},task:{createdText:n.TaskCreatedText,commentedText:n.TaskCommentedText,extraText:n.Project,extraText2:n.Responsibles,location:n.TasksModule},discussion:{createdText:n.DiscussionCreatedText,commentedText:n.DiscussionCommentedText,location:n.DiscussionsModule},file:{createdText:n.FileCreatedText,createdExtraText:n.FileCreatedInFolderText,updatedText:n.FileUpdatedText,updatedExtraText:n.FileUpdatedInFolderText,extraText:n.Size,location:n.FilesModule},sharedFile:{createdText:n.SharedFileCreatedText,createdExtraText:n.SharedFileCreatedInFolderText,extraText:n.Size,location:n.FilesModule},folder:{createdText:n.FolderCreatedText,createdExtraText:n.FolderCreatedInFolderText,location:n.FoldersModule},sharedFolder:t(n.SharedFolderCreatedText,n.FoldersModule)}},ASC.Feed)}();ASC.Feed.Reader=function(){function n(n){return n!==undefined?i=n:i}function e(n){return n!==undefined?t=n:t}function u(n){return n!==undefined?o=n:o}function s(){Teamlab.getNewFeedsCount({},{filter:{},success:f,"async":!0})}function f(n,t){var r=jq(".top-item-box.feed");t==0?(r.removeClass("has-led"),r.find(".inner-label").text(t)):(t>100&&(t=">100"),r.addClass("has-led"),r.find(".inner-label").text(t),i=!0)}function c(){Teamlab.getFeeds({},{filter:{onlyNew:!0},success:l})}function l(n,t){var f=t.feeds,r=jq("#drop-feeds-box"),e=r.find(".loader-text-block"),o=r.find(".feeds-readed-msg"),s=r.find(".see-all-btn"),i=r.find(".list"),u,h;if(!f.length){i.addClass("display-none");e.hide();o.show();s.css("display","inline-block");return}for(o.hide(),i.empty(),u=0;u<f.length;u++)try{h=a(f[u]);jq.tmpl("dropFeedTmpl",h).appendTo(i)}catch(c){console.log(c)}e.hide();jq(i).removeClass("display-none");s.css("display","inline-block");i.prop("scrollHeight")>i.prop("clientHeight")&&(r.addClass("scrollbar-popup"),i.addClass("scrollbar-popup-list"))}function a(n){var t=n,i=v(n);return t.author=window.UserManager.getUser(i),t.isGuest=t.author==null||t.authorId==h,t.productText=y(t),t.location||(t.location=p(t)),b(t),t.actionText=w(t),t.isGuest||(t.userName=new URL(window.location.protocol+"//"+window.location.hostname+t.author.profileUrl).searchParams.get("user")),t.isAllDayEvent?(t.title="",t.today=ASC.Resources.Master.ResourceJS.Today,t.yesterday=ASC.Resources.Master.ResourceJS.Yesterday,t.tomorrow=ASC.Resources.Master.FeedResource.Tomorrow,t.displayCreatedTime=null):(t.today=ASC.Resources.Master.FeedResource.TodayAt,t.yesterday=ASC.Resources.Master.FeedResource.YesterdayAt,t.tomorrow=ASC.Resources.Master.FeedResource.TomorrowAt,t.actionText=t.actionText+"."),t}function v(n){return n.comments&&n.comments.length?n.comments[n.comments.length-1].authorId:n.authorId}function y(n){var t=ASC.Feed.Products;return t?t[n.product]:null}function p(n){var i=ASC.Feed.Texts,t;return i?(t=i[n.item],!t)?null:t.location:null}function w(n){var i=ASC.Feed.Texts,t;if(!i||(t=i[n.item],!t))return null;switch(n.action){case 0:return t.createdText;case 1:return t.updatedText;case 2:return t.commentedText;default:return t.createdText}}function b(n){switch(n.item){case"birthday":n.itemClass=n.isToday?"birthdaysToday":"birthdays";n.linkOnClickAttr="ASC.Controls.JabberClient.open('"+n.userName+"')";n.linkInnerText=n.author.displayName;break;case"newEmployee":n.itemClass="people";n.linkOnClickAttr="window.location.href='"+n.author.profileUrl+"'";n.linkInnerText=n.author.displayName;break;case"people":n.itemClass="people";break;case"blog":n.itemClass="blogs";break;case"news":case"order":case"advert":case"poll":n.itemClass="events";break;case"forum":case"forumTopic":case"forumPoll":case"forumPost":n.itemClass="forum";break;case"bookmark":n.itemClass="bookmarks";break;case"company":case"person":n.itemClass="group";break;case"crmTask":n.itemClass="tasks";break;case"deal":n.itemClass="opportunities";break;case"cases":n.itemClass="cases";break;case"project":n.itemClass="projects";break;case"participant":n.itemClass="projects";break;case"milestone":n.itemClass="milestones";break;case"task":n.itemClass="tasks";break;case"discussion":n.itemClass="discussions";break;case"file":case"sharedFile":n.itemClass="documents";break;case"folder":case"sharedFolder":n.itemClass="documents"}}function k(){if(jq("#studioPageContent li.feed a.feedActiveBox").length!=0){ASC.SocketIO&&!ASC.SocketIO.disabled()&&(r=ASC.SocketIO.Factory.counters.reconnect_failed(function(){s()}).on("sendFeedsCount",function(n){var i=Number(jq(".top-item-box.feed").find(".inner-label").text());!t&&i&&(n=i+n);t=!1;f(null,n)}).on("getNewMessagesCount",function(n){f(null,n.f)}));jq.dropdownToggle({switcherSelector:".studio-top-panel .feedActiveBox",dropdownID:"studio_dropFeedsPopupPanel",addTop:5,addLeft:-392});jq(".studio-top-panel .feedActiveBox").on("mouseup",function(t){t.which==2&&n()&&(n(!1),jq(".top-item-box.feed").removeClass("has-led"))});jq(".studio-top-panel .feedActiveBox").on("click",function(t){return u()?!1:t.which==2&&n()?(n(!1),jq(".top-item-box.feed").removeClass("has-led"),!0):t.which!=1?!0:(n()&&!e()?(u(!0),c(),Teamlab.readFeeds({},{filter:{},success:function(n,t){try{r&&r.emit("sendFeedsCount")}catch(i){console.error(i.message)}t&&(u(!1),e(!0),jq(".top-item-box.feed").removeClass("has-led"))}}),t.preventDefault()):t.stopPropagation(),!0)});ASC.Resources.Master.Hub.Url||StudioManager.addPendingRequest(s)}}var h="712d9ec3-5d2b-4b13-824f-71f00191dcca",i,r,t=!1,o=!1;return{init:k}}();jq(document).ready(function(){jq("#studioPageContent li.feed a.feedActiveBox").length!=0&&ASC.Feed.Reader.init()});
ASC.Controls.TalkNavigationItem||(ASC.Controls.TalkNavigationItem={checkMessagesTimeout:1e3,currentValue:-1,init:function(n){jq("#studioPageContent li.talk").length!=0&&(isFinite(+n)&&(this.checkMessagesTimeout=+n*1e3,StudioManager.addPendingRequest(function(){ASC.Controls.TalkNavigationItem.checkNewMessages();+n>0&&setInterval(ASC.Controls.TalkNavigationItem.checkNewMessages,ASC.Controls.TalkNavigationItem.checkMessagesTimeout)})),Teamlab.bind(Teamlab.events.getTalkUnreadMessages,ASC.Controls.TalkNavigationItem.getResponce))},updateValue:function(n){if(this.currentValue===n)return undefined;this.currentValue=n;var t=document.getElementById("talkMsgCount");t&&(t.innerHTML=n>100?">100":n,jQuery("#talkMsgLabel")[n>0?"addClass":"removeClass"]("has-led"))},getResponce:function(n,t){t>0&&ASC.Controls.TalkNavigationItem.updateValue(t)},checkNewMessages:function(){jQuery("#talkMsgLabel").length>0&&Teamlab.getTalkUnreadMessages()}});jq(document).ready(function(){if(ASC.SocketIO&&!ASC.SocketIO.disabled())ASC.SocketIO.Factory.counters.on("getNewMessagesCount",function(n){ASC.Controls.TalkNavigationItem.updateValue(n.me)}).on("sendMessagesCount",function(n){ASC.Controls.TalkNavigationItem.updateValue(n)})});ASC.Controls.JabberClient||(ASC.Controls.JabberClient={username:null,jid:null,winName:"ASCJabberClient"+location.hostname,helperId:"JabberClientHelper-"+Math.floor(Math.random()*1e6),params:"",pathCmdHandler:"",pathWebTalk:"",init:function(n,t,i){if(jq("#studioPageContent li.talk").length!=0){typeof n=="string"&&n.length>0&&(this.username=n.toLowerCase());typeof t=="string"&&t.length>0&&(this.pathWebTalk=t);typeof i=="string"&&i.length>0&&(this.pathCmdHandler=i);var r=this.winName.match(/\w+/g);this.winName=r?r.join(""):this.winName}},extendChat:function(){ASC.Controls.JabberClient.open()},redirectMain:function(){try{window.open("/")}catch(n){}},open:function(n){var t=null,i=!1,r=n?n.substring(0,n.indexOf("@")):"";r=r||n||"";this.username===r.toLowerCase()&&(n=null);typeof n=="string"&&(n=n.toLowerCase());try{t=window.open("",this.winName,this.params)}catch(f){}try{i=!t||typeof t.ASC=="undefined"?!1:!0}catch(f){i=!0}if(!i&&typeof this.pathWebTalk&&(t=window.open(this.pathWebTalk+(n&&typeof n=="string"&&n.length>0?"#"+n:""),this.winName,this.params),i=!0),!i)return undefined;try{t&&t.focus()}catch(f){}try{ASC.Controls.TalkNavigationItem.updateValue(0);ASC.SocketIO&&!ASC.SocketIO.disabled()&&ASC.SocketIO.Factory.counters.emit("sendMessagesCount",0)}catch(u){console.error(u.message)}return typeof n=="string"&&n.length>0&&this.openContact(n),t},openContact:function(n){if(typeof this.username=="string"&&this.username.length>0){var t=n.substring(0,n.indexOf("@"));t=t||n||"";this.jid=n;this.username===t.toLowerCase()&&(t=null);t&&typeof t=="string"&&jQuery.ajax({"async":!0,type:"get",contentType:"text/xml",cache:!1,url:this.pathCmdHandler,data:{from:t.toLowerCase(),to:this.username},complete:null})}},openTenant:function(n){n&&typeof n=="string"&&jQuery.ajax({"async":!0,type:"get",contentType:"text/xml",cache:!1,url:this.pathCmdHandler,data:{from:n.toLowerCase(),to:this.username,fromtenant:!0},complete:null})},terminate:function(n,t){jQuery.ajax({"async":!0,type:"post",contentType:"text/xml",cache:!1,url:t,data:n,complete:null})}});ASC.Controls.SoundManager||(ASC.Controls.SoundManager={isEnabled:null,soundContainer:null,soundPath:null,installPath:null,init:function(n,t){typeof n=="string"&&(this.soundPath=n);typeof t=="string"&&(this.installPath=t)},onLoad:function(n){if(typeof n=="string"&&(n=document.getElementById(n)),!n||typeof n=="undefined")return null;this.soundContainer=n;this.isEnabled===null&&(this.isEnabled=!0);this.play("incmsg")},alarm:function(){if(this.soundContainer===null&&this.swfPath!==null){if(this.soundPath!==null)try{var n="talkSoundContainer-"+Math.floor(Math.random()*1e6),t=document.createElement("div");t.setAttribute("id",n);document.body.appendChild(t);swfobject.embedSWF(this.soundPath,n,1,1,"9.0.0",this.installPath,{apiInit:function(n){ASC.Controls.SoundManager.onLoad(n)},apiId:n},{allowScriptAccess:"always",wmode:"transparent"},{styleclass:"sound-container",wmode:"transparent"})}catch(i){}return this.soundContainer=undefined,undefined}this.play("incmsg")},play:function(n){if(this.soundContainer!==null&&this.isEnabled===!0&&typeof n=="string")try{this.soundContainer.playSound(n)}catch(t){}}});
jq(document).ready(function(){var t,n,i,r,u;try{if(t=!0,Teamlab.profile.isPortalOwner===!0&&!ASC.Desktop){n=window.UserManager.getAllUsers(!0);for(i in n)if(n.hasOwnProperty(i)&&(r=n[i],r.isActivated===!0&&r.isOwner===!1)){t=!1;break}if(t)if(jq("#menuInviteUsers").show(),ASC.Clipboard.enable)window.menuInviteUsersClip=ASC.Clipboard.destroy(window.menuInviteUsersClip),u=jq("#shareInviteUserLink").val(),window.menuInviteUsersClip=ASC.Clipboard.create(u,"menuInviteUsersBtn",{onComplete:function(){PopupKeyUpActionProvider.ClearActions();StudioBlockUIManager.blockUI("#inviteLinkContainer",550);ASC.InvitePanel.bindClipboardEvent();typeof toastr!="undefined"?toastr.success(ASC.Resources.Master.ResourceJS.LinkCopySuccess):jq("#shareInviteUserLink, #shareInviteUserLinkCopy").yellowFade()}});else jq("#menuInviteUsersBtn").on("click",function(){PopupKeyUpActionProvider.ClearActions();StudioBlockUIManager.blockUI("#inviteLinkContainer",550);ASC.InvitePanel.bindClipboardEvent()})}}catch(f){}});
typeof ASC=="undefined"&&(ASC={});ASC.InvitePanel=function(){function o(n){var i=jq(n).is(":checked")?jq("#hiddenVisitorLink").val():jq("#hiddenUserLink").val();r?u(i):(jq("#shareInviteUserLink").val(i),ASC.InvitePanel.bindClipboardEvent(),t(i))}function u(n){Teamlab.getShortenLink({},n,{before:function(){LoadingBanner.showLoaderBtn("#inviteLinkContainer")},after:function(){LoadingBanner.hideLoaderBtn("#inviteLinkContainer")},error:function(n,t){toastr.error(t[0]);jq("#getShortenInviteLink").remove()},success:function(n,i){jq("#getShortenInviteLink").hide();jq("#shareInviteUserLink").val(i);ASC.InvitePanel.bindClipboardEvent();t(jq("#shareInviteUserLink").val());r=!0}})}function t(n){var t=jq("#shareInviteLinkViaSocPanel"),i=encodeURIComponent(n),r=encodeURIComponent(jq.format(ASC.Resources.Master.ResourceJS.ShareInviteLinkDscr,n));ASC.Resources.Master.UrlShareFacebook?t.find(".facebook").attr("href",ASC.Resources.Master.UrlShareFacebook.format(i,"","","")):t.find(".facebook").remove();ASC.Resources.Master.UrlShareTwitter?t.find(".twitter").attr("href",ASC.Resources.Master.UrlShareTwitter.format(r)):t.find(".twitter").remove()}var i=!1,r=!1,n=null,f=function(){if(!i){i=!0;jq("#invitePanelContainer").replaceWith(jq.tmpl("template-blockUIPanel",{id:"inviteLinkContainer",headerTest:jq("#invitePanelContainer").attr("data-header"),innerHtmlText:jq("#invitePanelContainer").html(),OKBtn:jq("#invitePanelContainer").attr("data-ok")}));jq("#inviteLinkContainer").on("click",".button.blue.middle, .cancelButton",function(){var u=jq(this),i="";return n=ASC.Clipboard.destroy(n),u.is(".button.blue")&&PopupKeyUpActionProvider.CloseDialog(),jq("#getShortenInviteLink").show(),r=!1,jq("#hiddenUserLink").length!=0?(jq("#chkVisitor").prop("checked",!1),i=jq("#hiddenUserLink").val()):(jq("#chkVisitor").prop("checked",!0),i=jq("#hiddenVisitorLink").val()),jq("#shareInviteUserLink").val(i),ASC.InvitePanel.bindClipboardEvent(),t(i),u.is(".button.blue")?!1:void 0});if(jq("#hiddenUserLink").length!=0&&jq("#hiddenVisitorLink").length!=0)jq("#chkVisitor").on("click",function(){o(this)});if(jq("#getShortenInviteLink").length!=0)jq("#getShortenInviteLink").on("click",function(){u(jq("#shareInviteUserLink").val())});t(jq("#shareInviteUserLink").val());jq("#shareInviteLinkViaSocPanel").on("click","a",function(){return window.open(jq(this).attr("href"),"new","height=600,width=1020,fullscreen=0,resizable=0,status=0,toolbar=0,menubar=0,location=1"),!1})}},e=function(){if(i)if(ASC.Clipboard.enable){n=ASC.Clipboard.destroy(n);var t=jq("#shareInviteUserLink").val();n=ASC.Clipboard.create(t,"shareInviteUserLinkCopy",{onComplete:function(){typeof toastr!="undefined"?toastr.success(ASC.Resources.Master.ResourceJS.LinkCopySuccess):jq("#shareInviteUserLink, #shareInviteUserLinkCopy").yellowFade()}})}else jq("#shareInviteUserLinkCopy").remove()};return{init:f,bindClipboardEvent:e}}();jq(document).ready(function(){try{ASC.InvitePanel.init()}catch(n){}});

