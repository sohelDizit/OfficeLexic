/*! head.load - v1.0.3 */
(function(n,t){"use strict";function w(){}function u(n,t){if(n){typeof n=="object"&&(n=[].slice.call(n));for(var i=0,r=n.length;i<r;i++)t.call(n,n[i],i)}}function d(n,i){var r=Object.prototype.toString.call(i).slice(8,-1);return i!==t&&i!==null&&r===n}function o(n){return d("Function",n)}function h(n){return d("Array",n)}function ut(n){var i=n.split("/"),t=i[i.length-1],r=t.indexOf("?");return r!==-1?t.substring(0,r):t}function f(n){(n=n||w,n._done)||(n(),n._done=1)}function ft(n,t,r,u){var f=typeof n=="object"?n:{test:n,success:t?h(t)?t:[t]:!1,failure:r?h(r)?r:[r]:!1,callback:u||w},e=!!f.test;return e&&!!f.success?(f.success.push(f.callback),i.load.apply(null,f.success)):e||!f.failure?u():(f.failure.push(f.callback),i.load.apply(null,f.failure)),i}function c(n){var t={},i,r;if(typeof n=="object")for(i in n)n[i]&&(t={name:i,url:n[i]});else t={name:ut(n),url:n};return(r=v[t.name],r&&r.url===t.url)?r:(v[t.name]=t,t)}function l(n){n=n||v;for(var t in n)if(n.hasOwnProperty(t)&&n[t].state!==y)return!1;return!0}function et(n){n.state=yt;u(n.onpreload,function(n){n.call()})}function ot(n){n.state===t&&(n.state=it,n.onpreload=[],g({url:n.url,type:"cache"},function(){et(n)}))}function st(){var n=arguments,t=n[n.length-1],r=[].slice.call(n,1),f=r[0];return(o(t)||(t=null),h(n[0]))?(n[0].push(t),i.load.apply(null,n[0]),i):(f?(u(r,function(n){o(n)||!n||ot(c(n))}),b(c(n[0]),o(f)?f:function(){i.load.apply(null,r)})):b(c(n[0])),i)}function ht(){var n=arguments,t=n[n.length-1],r={};return(o(t)||(t=null),h(n[0]))?(n[0].push(t),i.load.apply(null,n[0]),i):(u(n,function(n){n!==t&&(n=c(n),r[n.name]=n)}),u(n,function(n){n!==t&&(n=c(n),b(n,function(){l(r)&&f(t)}))}),i)}function b(n,t){if(t=t||w,n.state===y){t();return}if(n.state===rt){i.ready(n.name,t);return}if(n.state===it){n.onpreload.push(function(){b(n,t)});return}n.state=rt;g(n,function(){n.state=y;t();u(a[n.name],function(n){f(n)});s&&l()&&u(a.ALL,function(n){f(n)})})}function ct(n){n=n||"";var t=n.split("?")[0].split(".");return t[t.length-1].toLowerCase()}function g(t,i){function e(t){t=t||n.event;u.onload=u.onreadystatechange=u.onerror=null;i()}function o(f){f=f||n.event;(f.type==="load"||/loaded|complete/.test(u.readyState)&&(!r.documentMode||r.documentMode<9))&&(n.clearTimeout(t.errorTimeout),n.clearTimeout(t.cssTimeout),u.onload=u.onreadystatechange=u.onerror=null,i())}function s(){if(t.state!==y&&t.cssRetries<=20){for(var i=0,f=r.styleSheets.length;i<f;i++)if(r.styleSheets[i].href===u.href){o({type:"load"});return}t.cssRetries++;t.cssTimeout=n.setTimeout(s,250)}}var u,h,f;i=i||w;h=ct(t.url);h==="css"?(u=r.createElement("link"),u.type="text/"+(t.type||"css"),u.rel="stylesheet",u.href=t.url,t.cssRetries=0,t.cssTimeout=n.setTimeout(s,500)):(u=r.createElement("script"),u.type="text/"+(t.type||"javascript"),u.src=t.url);u.onload=u.onreadystatechange=o;u.onerror=e;u.async=!1;u.defer=!1;t.errorTimeout=n.setTimeout(function(){e({type:"timeout"})},7e3);f=r.head||r.getElementsByTagName("head")[0];f.insertBefore(u,f.lastChild)}function lt(){for(var n,u=r.getElementsByTagName("script"),t=0,f=u.length;t<f;t++)if(n=u[t].getAttribute("data-headjs-load"),!!n){i.load(n);return}}function at(n,t){var c,p,e;return n===r?(s?f(t):nt.push(t),i):(o(n)&&(t=n,n="ALL"),h(n))?(c={},u(n,function(n){c[n]=v[n];i.ready(n,function(){l(c)&&f(t)})}),i):typeof n!="string"||!o(t)?i:(p=v[n],p&&p.state===y||n==="ALL"&&l()&&s)?(f(t),i):(e=a[n],e?e.push(t):e=a[n]=[t],i)}function e(){if(!r.body){n.clearTimeout(i.readyTimeout);i.readyTimeout=n.setTimeout(e,50);return}s||(s=!0,lt(),u(nt,function(n){f(n)}))}function k(){r.addEventListener?(r.removeEventListener("DOMContentLoaded",k,!1),e()):r.readyState==="complete"&&(r.detachEvent("onreadystatechange",k),e())}var r=n.document,nt=[],a={},v={},vt="async"in r.createElement("script")||"MozAppearance"in r.documentElement.style||n.opera,s,tt=n.head_conf&&n.head_conf.head||"head",i=n[tt]=n[tt]||function(){i.ready.apply(null,arguments)},it=1,yt=2,rt=3,y=4,p;if(r.readyState==="complete")e();else if(r.addEventListener)r.addEventListener("DOMContentLoaded",k,!1),n.addEventListener("load",e,!1);else{r.attachEvent("onreadystatechange",k);n.attachEvent("onload",e);p=!1;try{p=!n.frameElement&&r.documentElement}catch(wt){}p&&p.doScroll&&function pt(){if(!s){try{p.doScroll("left")}catch(t){n.clearTimeout(i.readyTimeout);i.readyTimeout=n.setTimeout(pt,50);return}e()}}()}i.load=i.js=vt?ht:st;i.test=ft;i.ready=at;i.ready(r,function(){l()&&u(a.ALL,function(n){f(n)});i.feature&&i.feature("domloaded",!0)})})(window);
var ListScript=new function(){this.list=["3rdparty/extjs/ext-all.js","3rdparty/jquery/jscrollpane/jquery.jscrollpane.js","3rdparty/jquery/jquery-1.7.1.min.js","3rdparty/jquery/jscrollpane/jquery.jscrollpane.min.js","3rdparty/jquery/mousewheel/jquery.mousewheel.js","3rdparty/sockjs/sockjs-0.3.min.js","3rdparty/underscore/underscore-min.js","3rdparty/xregexp/xregexp-all-min.js","apps/api/documents/api.js","apps/documenteditor/embed/app-all.js","apps/documenteditor/main/app-all.js","apps/documenteditor/main/locale/de.js","apps/documenteditor/main/locale/en.js","apps/documenteditor/main/locale/es.js","apps/documenteditor/main/locale/fr.js","apps/documenteditor/main/locale/it.js","apps/documenteditor/main/locale/lv.js","apps/documenteditor/main/locale/ru.js","apps/spreadsheeteditor/embed/app-all.js","apps/spreadsheeteditor/main/app-all.js","apps/spreadsheeteditor/main/locale/de.js","apps/spreadsheeteditor/main/locale/en.js","apps/spreadsheeteditor/main/locale/es.js","apps/spreadsheeteditor/main/locale/fr.js","apps/spreadsheeteditor/main/locale/it.js","apps/spreadsheeteditor/main/locale/lv.js","apps/spreadsheeteditor/main/locale/ru.js","sdk/OfficeWebCommon/docscoapisettings.js","sdk/OfficeWebCommon/MobileDownloader/downloaderfiles.js","sdk/OfficeWebExcel/sdk-all.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/arial.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/arialbd.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/arialbi.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/ariali.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CALIBRI.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CALIBRIB.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CALIBRII.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CALIBRIZ.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CAMBRIA.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CAMBRIAB.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CAMBRIAI.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/CAMBRIAZ.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/cour.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/courbd.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/courbi.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/couri.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/symbol.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/times.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/timesbd.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/timesbi.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/timesi.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/wingding.js","sdk/OfficeWebWord/FontsFreeType/FontFiles/WINGDNG3.js","sdk/OfficeWebWord/WebWord/sdk-all.js"]};
typeof ASC=="undefined"&&(ASC={});typeof ASC.Controls=="undefined"&&(ASC.Controls={});ASC.Controls.FirstTimeView=new function(){this.Finish=function(){window.onbeforeunload=null;var n="Default.aspx";jq("body").is(".desktop")&&(n+="?desktop=true&first=true");location.href=n};this.SaveRequiredStep=function(){AjaxPro.onLoading=function(n){n?LoadingBanner.showLoaderBtn(".wizardContent"):LoadingBanner.hideLoaderBtn(".wizardContent")};var n=new ASC.Controls.FirstTimeManager;n.SaveRequiredData(this.SaveRequiredStepCallback)};this.SaveRequiredStepCallback=function(n){if(n.Status==1){var t=new TimeAndLanguageContentManager;t.SaveTimeLangSettings(ASC.Controls.FirstTimeView.SaveTimeLangSettingsCallback)}else ASC.Controls.FirstTimeView.ShowOperationInfo(n)};this.SaveTimeLangSettingsCallback=function(n){n.Status==1?ASC.Controls.FirstTimeView.Finish():(ASC.Controls.FirstTimeView.ShowOperationInfo(n),window.onbeforeunload=function(){return ASC.Resources.Master.ResourceJS.WizardCancelConfirmMessage})};this.ShowOperationInfo=function(n){n.Status==1?toastr.success(n.Message):toastr.error(n.Message)}};jq(document).ready(function(){jq(document).on("keyup",function(n){n.which==13&&ASC.Controls.FirstTimeView.SaveRequiredStep()});window.onbeforeunload=function(){return ASC.Resources.Master.ResourceJS.WizardCancelConfirmMessage}});
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","jquery-ui/ui/widget"],n):typeof exports=="object"?n(require("jquery"),require("./vendor/jquery.ui.widget")):n(window.jQuery)})(function(n){"use strict";function t(t){var i=t==="dragover";return function(r){r.dataTransfer=r.originalEvent&&r.originalEvent.dataTransfer;var u=r.dataTransfer;u&&n.inArray("Files",u.types)!==-1&&this._trigger(t,n.Event(t,{delegatedEvent:r}))!==!1&&(r.preventDefault(),i&&(u.dropEffect="copy"))}}n.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||n('<input type="file"/>').prop("disabled"));n.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);n.support.xhrFormDataFileUpload=!!window.FormData;n.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);n.widget("blueimp.fileupload",{options:{dropZone:n(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&n.each(i,function(n,i){t=t.replace("{"+n+"}",i)}),t},formData:function(n){return n.serializeArray()},add:function(t,i){if(t.isDefaultPrevented())return!1;(i.autoUpload||i.autoUpload!==!1&&n(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:n.support.blobSlice&&function(){var n=this.slice||this.webkitSlice||this.mozSlice;return n.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(n,t,i){var r=n-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=n),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&n.support.xhrFileUpload||n.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return n.type(t.formData)==="function"?t.formData(t.form):n.isArray(t.formData)?t.formData:n.type(t.formData)==="object"?(i=[],n.each(t.formData,function(n,t){i.push({name:n,value:t})}),i):[]},_getTotal:function(t){var i=0;return n.each(t,function(n,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?n.extend(t._progress,i):t._progress=i},_initResponseObject:function(n){var t;if(n._response)for(t in n._response)n._response.hasOwnProperty(t)&&delete n._response[t];else n._response={}},_onProgress:function(t,i){if(t.lengthComputable){var r=Date.now?Date.now():(new Date).getTime(),u;if(i._time&&i.progressInterval&&r-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=r;u=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0);this._progress.loaded+=u-i._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,i.bitrateInterval);i._progress.loaded=i.loaded=u;i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(r,u,i.bitrateInterval);this._trigger("progress",n.Event("progress",{delegatedEvent:t}),i);this._trigger("progressall",n.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():n.ajaxSettings.xhr();i.upload&&(n(i.upload).bind("progress",function(n){var i=n.originalEvent;n.lengthComputable=i.lengthComputable;n.loaded=i.loaded;n.total=i.total;r._onProgress(n,t)}),t.xhr=function(){return i})},_isInstanceOf:function(n,t){return Object.prototype.toString.call(t)==="[object "+n+"]"},_initXHRData:function(t){var f=this,i,r=t.files[0],e=t.multipart||!n.support.xhrFileUpload,u=n.type(t.paramName)==="array"?t.paramName[0]:t.paramName;t.headers=n.extend({},t.headers);t.contentRange&&(t.headers["Content-Range"]=t.contentRange);e&&!t.blob&&this._isInstanceOf("File",r)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.uploadName||r.name)+'"');e?n.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:u,value:t.blob}):n.each(t.files,function(r,f){i.push({name:n.type(t.paramName)==="array"&&t.paramName[r]||u,value:f})})):(f._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,n.each(this._getFormData(t),function(n,t){i.append(t.name,t.value)})),t.blob?i.append(u,t.blob,r.uploadName||r.name):n.each(t.files,function(r,e){(f._isInstanceOf("File",e)||f._isInstanceOf("Blob",e))&&i.append(n.type(t.paramName)==="array"&&t.paramName[r]||u,e,e.uploadName||e.name)})),t.data=i):(t.contentType=r.type||"application/octet-stream",t.data=t.blob||r);t.blob=null},_initIframeSettings:function(t){var i=n("<a><\/a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(n){this._isXHRUpload(n)?(this._chunkedUpload(n,!0)||(n.data||this._initXHRData(n),this._initProgressListener(n)),n.postMessage&&(n.dataType="postmessage "+(n.dataType||""))):this._initIframeSettings(n)},_getParamName:function(t){var r=n(t.fileInput),i=t.paramName;return i?n.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=n(this),u=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(u),r-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=n(t.fileInput.prop("form")),t.form.length||(t.form=n(this.options.fileInput.prop("form"))));t.paramName=this._getParamName(t);t.url||(t.url=t.form.prop("action")||location.href);t.type=(t.type||n.type(t.form.prop("method"))==="string"&&t.form.prop("method")||"").toUpperCase();t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST");t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=n.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(n){return n.state?n.state():n.isResolved()?"resolved":n.isRejected()?"rejected":"pending"},_enhancePromise:function(n){return n.success=n.done,n.error=n.fail,n.complete=n.always,n},_getXHRPromise:function(t,i,r){var u=n.Deferred(),f=u.promise();return i=i||this.options.context||f,t===!0?u.resolveWith(i,r):t===!1&&u.rejectWith(i,r),f.abort=u.promise,this._enhancePromise(f)},_addConvenienceMethods:function(t,i){var r=this,u=function(t){return n.Deferred().resolveWith(r,t).promise()};i.process=function(t,f){return(t||f)&&(i._processQueue=this._processQueue=(this._processQueue||u([this])).then(function(){return i.errorThrown?n.Deferred().rejectWith(r,[i]).promise():u(arguments)}).then(t,f)),this._processQueue||u([this])};i.submit=function(){return this.state()!=="pending"&&(i.jqXHR=this.jqXHR=r._trigger("submit",n.Event("submit",{delegatedEvent:t}),this)!==!1&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()};i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))};i.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0};i.processing=function(){return!this.jqXHR&&this._processQueue&&r._getDeferredState(this._processQueue)==="pending"};i.progress=function(){return this._progress};i.response=function(){return this._response}},_getUploadedBytes:function(n){var i=n.getResponseHeader("Range"),t=i&&i.split("-"),r=t&&t.length>1&&parseInt(t[1],10);return r&&r+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var u=this,e=t.files[0],o=e.size,r=t.uploadedBytes,f=t.maxChunkSize||o,l=this._blobSlice,s=n.Deferred(),h=s.promise(),a,c;return!(this._isXHRUpload(t)&&l&&(r||(n.type(f)==="function"?f(t):f)<o))||t.data?!1:i?!0:r>=o?(e.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",e.error])):(c=function(){var i=n.extend({},t),h=i._progress.loaded;i.blob=l.call(e,r,r+(n.type(f)==="function"?f(i):f),e.type);i.chunkSize=i.blob.size;i.contentRange="bytes "+r+"-"+(r+i.chunkSize-1)+"/"+o;u._initXHRData(i);u._initProgressListener(i);a=(u._trigger("chunksend",null,i)!==!1&&n.ajax(i)||u._getXHRPromise(!1,i.context)).done(function(f,e,l){r=u._getUploadedBytes(l)||r+i.chunkSize;h+i.chunkSize-i._progress.loaded&&u._onProgress(n.Event("progress",{lengthComputable:!0,loaded:r-i.uploadedBytes,total:r-i.uploadedBytes}),i);t.uploadedBytes=i.uploadedBytes=r;i.result=f;i.textStatus=e;i.jqXHR=l;u._trigger("chunkdone",null,i);u._trigger("chunkalways",null,i);r<o?c():s.resolveWith(i.context,[f,e,l])}).fail(function(n,t,r){i.jqXHR=n;i.textStatus=t;i.errorThrown=r;u._trigger("chunkfail",null,i);u._trigger("chunkalways",null,i);s.rejectWith(i.context,[n,t,r])})},this._enhancePromise(h),h.abort=function(){return a.abort()},c(),h)},_beforeSend:function(n,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(t);this._initProgressObject(t);t._progress.loaded=t.loaded=t.uploadedBytes||0;t._progress.total=t.total=this._getTotal(t.files)||1;t._progress.bitrate=t.bitrate=0;this._active+=1;this._progress.loaded+=t.loaded;this._progress.total+=t.total},_onDone:function(t,i,r,u){var f=u._progress.total,e=u._response;u._progress.loaded<f&&this._onProgress(n.Event("progress",{lengthComputable:!0,loaded:f,total:f}),u);e.result=u.result=t;e.textStatus=u.textStatus=i;e.jqXHR=u.jqXHR=r;this._trigger("done",null,u)},_onFail:function(n,t,i,r){var u=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total);u.jqXHR=r.jqXHR=n;u.textStatus=r.textStatus=t;u.errorThrown=r.errorThrown=i;this._trigger("fail",null,r)},_onAlways:function(n,t,i,r){this._trigger("always",null,r)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var r=this,f,s,e,h,u=r._getAJAXSettings(i),o=function(){return r._sending+=1,u._bitrateTimer=new r._BitrateTimer,f=f||((s||r._trigger("send",n.Event("send",{delegatedEvent:t}),u)===!1)&&r._getXHRPromise(!1,u.context,s)||r._chunkedUpload(u)||n.ajax(u)).done(function(n,t,i){r._onDone(n,t,i,u)}).fail(function(n,t,i){r._onFail(n,t,i,u)}).always(function(n,t,i){if(r._onAlways(n,t,i,u),r._sending-=1,r._active-=1,u.limitConcurrentUploads&&u.limitConcurrentUploads>r._sending)for(var f=r._slots.shift();f;){if(r._getDeferredState(f)==="pending"){f.resolve();break}f=r._slots.shift()}r._active===0&&r._trigger("stop")})};return(this._beforeSend(t,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)?(this.options.limitConcurrentUploads>1?(e=n.Deferred(),this._slots.push(e),h=e.then(o)):(this._sequence=this._sequence.then(o,o),h=this._sequence),h.abort=function(){return(s=[undefined,"abort","abort"],!f)?(e&&e.rejectWith(u.context,s),o()):f.abort()},this._enhancePromise(h)):o()},_onAdd:function(t,i){var a=this,p=!0,f=n.extend({},this.options,i),u=i.files,v=u.length,o=f.limitMultiFileUploads,c=f.limitMultiFileUploadSize,b=f.limitMultiFileUploadSizeOverhead,w=0,l=this._getParamName(f),s,e,h,r,y=0;if(!v)return!1;if(c&&u[0].size===undefined&&(c=undefined),(f.singleFileUploads||o||c)&&this._isXHRUpload(f))if(f.singleFileUploads||c||!o)if(!f.singleFileUploads&&c)for(h=[],s=[],r=0;r<v;r=r+1)w+=u[r].size+b,(r+1===v||w+u[r+1].size+b>c||o&&r+1-y>=o)&&(h.push(u.slice(y,r+1)),e=l.slice(y,r+1),e.length||(e=l),s.push(e),y=r+1,w=0);else s=l;else for(h=[],s=[],r=0;r<v;r+=o)h.push(u.slice(r,r+o)),e=l.slice(r,r+o),e.length||(e=l),s.push(e);else h=[u],s=[l];return i.originalFiles=u,n.each(h||u,function(r,u){var f=n.extend({},i);return f.files=h?u:[u],f.paramName=s[r],a._initResponseObject(f),a._initProgressObject(f),a._addConvenienceMethods(t,f),p=a._trigger("add",n.Event("add",{delegatedEvent:t}),f)}),p},_replaceFileInput:function(t){var i=t.fileInput,r=i.clone(!0),u=i.is(document.activeElement);t.fileInputClone=r;n("<form><\/form>").append(r)[0].reset();i.after(r).detach();u&&r.focus();n.cleanData(i.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(n,t){return t===i[0]?r[0]:t});i[0]===this.element[0]&&(this.element=r)},_handleFileTreeEntry:function(t,i){var s=this,r=n.Deferred(),u=[],e,f=function(n){n&&!n.entry&&(n.entry=t);r.resolve([n])},h=function(n){s._handleFileTreeEntries(n,i+t.name+"/").done(function(n){r.resolve(n)}).fail(f)},o=function(){e.readEntries(function(n){n.length?(u=u.concat(n),o()):h(u)},f)};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(n){n.relativePath=i;r.resolve(n)},f):t.isDirectory?(e=t.createReader(),o()):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,i){var r=this;return n.when.apply(n,n.map(t,function(n){return r._handleFileTreeEntry(n,i)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(n.map(i,function(n){var t;return n.webkitGetAsEntry?(t=n.webkitGetAsEntry(),t&&(t._file=n.getAsFile()),t):n.getAsEntry()})):n.Deferred().resolve(n.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=n(t);var r=t.prop("webkitEntries")||t.prop("entries"),i,u;if(r&&r.length)return this._handleFileTreeEntries(r);if(i=n.makeArray(t.prop("files")),i.length)i[0].name===undefined&&i[0].fileName&&n.each(i,function(n,t){t.name=t.fileName;t.size=t.fileSize});else{if(u=t.prop("value"),!u)return n.Deferred().resolve([]).promise();i=[{name:u.replace(/^.*\\/,"")}]}return n.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return!(t instanceof n)||t.length===1?this._getSingleFileInputFiles(t):n.when.apply(n,n.map(t,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var r=this,i={fileInput:n(t.target),form:n(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(u){i.files=u;r.options.replaceFileInput&&r._replaceFileInput(i);r._trigger("change",n.Event("change",{delegatedEvent:t}),i)!==!1&&r._onAdd(t,i)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};i&&i.length&&(n.each(i,function(n,t){var i=t.getAsFile&&t.getAsFile();i&&r.files.push(i)}),this._trigger("paste",n.Event("paste",{delegatedEvent:t}),r)!==!1&&this._onAdd(t,r))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var u=this,i=t.dataTransfer,r={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){r.files=i;u._trigger("drop",n.Event("drop",{delegatedEvent:t}),r)!==!1&&u._onAdd(t,r)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));n.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(t,i){var r=n.inArray(t,this._specialOptions)!==-1;r&&this._destroyEventHandlers();this._super(t,i);r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof n||(t.fileInput=n(t.fileInput));t.dropZone instanceof n||(t.dropZone=n(t.dropZone));t.pasteZone instanceof n||(t.pasteZone=n(t.pasteZone))},_getRegExp:function(n){var t=n.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return t!=="url"&&n.type(i)==="string"&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,r=this.element.data();n.each(this.element[0].attributes,function(n,u){var f=u.name.toLowerCase(),e;/^data-/.test(f)&&(f=f.slice(5).replace(/-[a-z]/g,function(n){return n.charAt(1).toUpperCase()}),e=r[f],t._isRegExpOption(f,e)&&(e=t._getRegExp(e)),i[f]=e)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(n){t.files=n;i._onAdd(null,t)}):(t.files=n.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var e=this,i=n.Deferred(),u=i.promise(),r,f;return u.abort=function(){return(f=!0,r)?r.abort():(i.reject(null,"abort","abort"),u)},this._getFileInputFiles(t.fileInput).always(function(n){if(!f){if(!n.length){i.reject();return}t.files=n;r=e._onSend(null,t);r.then(function(n,t,r){i.resolve(n,t,r)},function(n,t,r){i.reject(n,t,r)})}}),this._enhancePromise(u)}if(t.files=n.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});
typeof ASC=="undefined"&&(ASC={});typeof ASC.Controls=="undefined"&&(ASC.Controls={});ASC.Controls.FirstTimeManager=function(){this.OnAfterSaveRequiredData=null;this.OnAfterSaveData=null;this.SaveRequiredData=function(n){ASC.Controls.EmailAndPasswordManager.SaveRequiredData(n)}};ASC.Controls.EmailAndPasswordManager=new function(){this.PassText="";this.changeIt="";this.ok="";this.wrongPass="";this.emptyPass="";this.wrongEmail="";this.init=function(t,i,r,u,f){ASC.Controls.EmailAndPasswordManager.changeIt=t;ASC.Controls.EmailAndPasswordManager.ok=i;ASC.Controls.EmailAndPasswordManager.wrongPass=r;ASC.Controls.EmailAndPasswordManager.emptyPass=u;ASC.Controls.EmailAndPasswordManager.wrongEmail=f;n()};var n=function(){jq("#licenseKey").on("click",function(n){n.preventDefault();jq("#uploadButton").trigger("click")});var n=jq("#uploadButton").fileupload({url:"ajaxupload.ashx?type=ASC.Web.Studio.HttpHandlers.LicenseUploader,ASC.Web.Studio"}).bind("fileuploadstart",function(){jq("#licenseKeyText").removeClass("error");LoadingBanner.showLoaderBtn(".step")}).bind("fileuploaddone",function(n,t){LoadingBanner.hideLoaderBtn(".step");try{var i=JSON.parse(t.result)}catch(n){i={Success:!1}}jq("#licenseKeyText").html(i.Message);i.Success||jq("#licenseKeyText").addClass("error")})};this.ShowChangeEmailAddress=function(){var n=jq(".emailAddress").html().trim();jq(".emailAddress").html("");jq(".emailAddress").append('<input type="textbox" id="newEmailAddress" maxlength="64" class="textEdit newEmail">');jq(".emailAddress #newEmailAddress").val(n);jq(".changeEmail").html("")};this.AcceptNewEmailAddress=function(){var n=jq(".changeEmail #dvChangeMail #newEmailAddress").val();n!=""&&(jq("#requiredStep .emailBlock .email .emailAddress").html(n),jq(".changeEmail #dvChangeMail").html(""),jq(".changeEmail #dvChangeMail").append('<a class="info baseLinkAction" onclick="ASC.Controls.EmailAndPasswordManager.ShowChangeEmailAddress();">'+ASC.Controls.EmailAndPasswordManager.changeIt+"<\/a>"))};this.SaveRequiredData=function(n){var t,f;if(!jq("#saveSettingsBtn").hasClass("disable")){var u=jq("#requiredStep .emailBlock .email .emailAddress #newEmailAddress"),r=u.length?u.val().trim():jq("#requiredStep .emailBlock .email .emailAddress").html().trim(),i=jq(".passwordBlock .pwd #newPwd").val(),e=jq(".passwordBlock .pwd #confPwd").val(),o=jq(".passwordBlock .promocode #promocode_input").val(),s=jq("#amiid").val();if(r==""||!jq.isValidEmail(r)){t={Status:0,Message:ASC.Controls.EmailAndPasswordManager.wrongEmail};n!=null&&n(t);return}if(i==""){jq(".passwordBlock .pwd #newPwd").css("border-color","#DF1B1B");t={Status:0,Message:ASC.Controls.EmailAndPasswordManager.emptyPass};n!=null&&n(t);return}if(!new RegExp(jq(".passwordBlock .pwd #newPwd").data("regex"),"g").test(i)){jq(".passwordBlock .pwd #newPwd").css("border-color","#DF1B1B");t={Status:0,Message:jq(".passwordBlock .pwd #newPwd").data("help")};n!=null&&n(t);return}if(i!=e){jq(".passwordBlock .pwd #newPwd ,.passwordBlock .pwd #confPwd").css("border-color","#DF1B1B");t={Status:0,Message:ASC.Controls.EmailAndPasswordManager.wrongPass};n!=null&&n(t);return}if(jq("#licenseKeyText").length&&jq("#licenseKeyText").hasClass("error")){t={Status:0,Message:ASC.Resources.Master.ResourceJS.LicenseKeyError};n!=null&&n(t);return}if(jq(".license-accept").length&&!jq(".license-accept input[type=checkbox]").is(":checked")){toastr.error(ASC.Resources.Master.ResourceJS.LicenseAgreementsError);return}f=jq("#subscribeFromSite").is(":checked");window.hashPassword(i,function(t){window.onbeforeunload=null;AjaxPro.timeoutPeriod=18e5;EmailAndPasswordController.SaveData(r,t,jq("#studio_lng").val()||jq("#studio_lng").data("default"),o,s,f,function(t){n!=null&&n(t.value)})})}}};jq(function(){jq(".emailAddress").html().trim()==""&&ASC.Controls.EmailAndPasswordManager.ShowChangeEmailAddress()});
var TimeAndLanguage=new function(){this.SaveLanguageTimeSettings=function(){AjaxPro.onLoading=function(n){n?LoadingBanner.showLoaderBtn("#studio_lngTimeSettings"):LoadingBanner.hideLoaderBtn("#studio_lngTimeSettings")};var n=new TimeAndLanguageContentManager;n.SaveTimeLangSettings(function(n){n.Status=="1"?(LoadingBanner.showMesInfoBtn("#studio_lngTimeSettings",n.Message,"success"),window.location.reload(!0)):LoadingBanner.showMesInfoBtn("#studio_lngTimeSettings",n.Message,"error")})}};TimeAndLanguageContentManager=function(){this.SaveTimeLangSettings=function(n){Teamlab.setTimaAndLanguage(jq("#studio_lng").val()||jq("#studio_lng").data("default"),jq("#studio_timezone").val(),{success:function(t,i){n!=null&&n({Status:1,Message:i})},error:function(t,i){n!=null&&n({Status:0,Message:i[0]})}})}};jq(function(){var n;if(jq("#NotFoundLanguage").length)jq("#studio_lng").on("focus",function(){n=this.value}).on("change",function(){if(this.value)n=this.value;else return setTimeout(function(){jq(".langTimeZoneBlock .HelpCenterSwitcher").helper({BlockHelperID:"NotFoundLanguage"})},0),this.value=n,!1})});
typeof ASC=="undefined"&&(ASC={});typeof ASC.ZopimLiveChat=="undefined"&&(ASC.ZopimLiveChat={});ASC.ZopimLiveChat=function(){var t,i=null,r=0,o=100,n=jq("#liveChatSwitch .switch-btn"),s=function(i){if(n.length){t=i;jq("#liveChatSwitch").on("click",function(){if(!jq(this).hasClass("disabled")){if(window.$zopim===undefined||window.$zopim.livechat===undefined){jq(this).addClass("disabled");u();return}e(localStorage.getItem("livechat")==="off")}});localStorage.getItem("livechat")==="on"&&(jq("#liveChatSwitch").addClass("disabled"),u())}},u=function(){window.$zopim||function(n,i){var r=$zopim=function(n){r._.push(n)},u=r.s=n.createElement(i),e=n.getElementsByTagName(i)[0];r.set=function(n){r.set._.push(n)};r._=[];r.set._=[];u.async=!0;u.setAttribute("charset","utf-8");u.src="https://v2.zopim.com/?"+t;r.t=+new Date;u.type="text/javascript";u.onload=f;e.parentNode.insertBefore(u,e)}(document,"script")},f=function(){if(clearTimeout(i),r<o){if(window.$zopim.livechat===undefined){console.log("livechat undefined");i=setTimeout(f,200);r+=1;return}e(!0)}},e=function(t){jq("#liveChatSwitch").removeClass("disabled");t?(n.addClass("switch-on"),$zopim.livechat.setDisableSound(!1),$zopim.livechat.window.hide(),localStorage.setItem("livechat","on")):(n.removeClass("switch-on"),$zopim.livechat.setDisableSound(!0),$zopim.livechat.hideAll(),localStorage.setItem("livechat","off"))};return{init:s}}();

